
=== FILE: ./.env ===

# Environment variables declared in this file are automatically made available to Prisma.
# See the documentation for more detail: https://pris.ly/d/prisma-schema#accessing-environment-variables-from-the-schema

# Prisma supports the native connection string format for PostgreSQL, MySQL, SQLite, SQL Server, MongoDB and CockroachDB.
# See the documentation for all the connection string options: https://pris.ly/d/connection-strings

# DATABASE_URL="postgresql://postgres:1617@localhost:5432/olipopper"
# Connect to Supabase via connection pooling
DATABASE_URL="postgresql://postgres.xjlmoqotbfttqfeowbhs:indy1617@aws-1-us-east-2.pooler.supabase.com:6543/postgres?pgbouncer=true"

# Direct connection to the database. Used for migrations
DIRECT_URL="postgresql://postgres.xjlmoqotbfttqfeowbhs:indy1617@aws-1-us-east-2.pooler.supabase.com:5432/postgres"
NEXTAUTH_URL=http://localhost:3000
NEXTAUTH_SECRET=GqQLF9A1zy9Oa2k00OM2fql6ZiHQC1TiC6XtLtpXfsY=
STRIPE_SECRET_KEY=sk_test_51RcDwtP51nCBPp4lEPBZDg9RiBhLN1npQLjlIB3zm7zjyRpZdAp9g83Nq8mByOqxbhlnB02exuTE4NEdn1IsANG600wQ8TQdVI
STRIPE_PUBLISHABLE_KEY=pk_test_51RcDwtP51nCBPp4lapfcNZzuji74k01kR4CYUTTcYRdG7KwWgAD3isjF83tooR83dxAUm1bfaxKN8oUz0uxHVBYR00qnccKLh5
STRIPE_WEBHOOK_SECRET=whsec_6b68fb340ee684cc6b560cf5bf46c6ee0283a6f508db6a6f7ea946414caf6b74
NEXT_PUBLIC_BASE_URL=http://localhost:3000
UPLOADTHING_TOKEN='eyJhcGlLZXkiOiJza19saXZlXzAzZGZlMDlhOGU0NjE0MzJjZDkxNzM0ZGM2YmQzNzYxODAxZjc4YmU5MjkzNDViYWM0NmU5NTQxZWZiNjc4YzUiLCJhcHBJZCI6ImswbzdkNGFveXIiLCJyZWdpb25zIjpbInNlYTEiXX0='
RESEND_API_KEY=re_E5ypkkv3_KowEgGRFq1nt1Sjf8BSGtKTe
EMAIL_TO=leapster16@gmail.com
EMAIL_FROM=onboarding@resend.dev

=== FILE: ./.gitignore ===

# See https://help.github.com/articles/ignoring-files/ for more about ignoring files.

# dependencies
/node_modules
/.pnp
.pnp.*
.yarn/*
!.yarn/patches
!.yarn/plugins
!.yarn/releases
!.yarn/versions

# testing
/coverage

# next.js
/.next/
/out/

# production
/build

# misc
.DS_Store
*.pem

# debug
npm-debug.log*
yarn-debug.log*
yarn-error.log*
.pnpm-debug.log*

# env files (can opt-in for committing if needed)
.env*

# vercel
.vercel

# typescript
*.tsbuildinfo
next-env.d.ts

/src/generated/prisma

=== FILE: ./all_files.txt ===


=== FILE: ./next-env.d.ts ===

/// <reference types="next" />
/// <reference types="next/image-types/global" />

// NOTE: This file should not be edited
// see https://nextjs.org/docs/app/api-reference/config/typescript for more information.

=== FILE: ./next.config.ts ===

import type { NextConfig } from "next";

const nextConfig: NextConfig = {
  /* config options here */
};

export default nextConfig;

=== FILE: ./package-lock.json ===

{
  "name": "olipopperstudios",
  "version": "0.1.0",
  "lockfileVersion": 3,
  "requires": true,
  "packages": {
    "": {
      "name": "olipopperstudios",
      "version": "0.1.0",
      "hasInstallScript": true,
      "dependencies": {
        "@next-auth/prisma-adapter": "^1.0.7",
        "@prisma/client": "^6.9.0",
        "@types/jsonwebtoken": "^9.0.10",
        "@uploadthing/react": "^7.3.2",
        "bcryptjs": "^3.0.2",
        "jsonwebtoken": "^9.0.2",
        "next": "15.3.2",
        "next-auth": "^4.24.11",
        "react": "^19.0.0",
        "react-dom": "^19.0.0",
        "resend": "^4.6.0",
        "stripe": "^18.2.1",
        "uploadthing": "^7.7.3"
      },
      "devDependencies": {
        "@tailwindcss/postcss": "^4",
        "@types/node": "^20",
        "@types/react": "^19",
        "@types/react-dom": "^19",
        "lightningcss": "^1.30.1",
        "prisma": "^6.8.2",
        "tailwindcss": "^4",
        "tsx": "^4.19.4",
        "typescript": "^5"
      }
    },
    "node_modules/@alloc/quick-lru": {
      "version": "5.2.0",
      "resolved": "https://registry.npmjs.org/@alloc/quick-lru/-/quick-lru-5.2.0.tgz",
      "integrity": "sha512-UrcABB+4bUrFABwbluTIBErXwvbsU/V7TZWfmbgJfbkwiBuziS9gxdODUyuiecfdGQ85jglMW6juS3+z5TsKLw==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">=10"
      },
      "funding": {
        "url": "https://github.com/sponsors/sindresorhus"
      }
    },
    "node_modules/@ampproject/remapping": {
      "version": "2.3.0",
      "resolved": "https://registry.npmjs.org/@ampproject/remapping/-/remapping-2.3.0.tgz",
      "integrity": "sha512-30iZtAPgz+LTIYoeivqYo853f02jBYSd5uGnGpkFV0M3xOt9aN73erkgYAmZU43x4VfqcnLxW9Kpg3R5LC4YYw==",
      "dev": true,
      "license": "Apache-2.0",
      "dependencies": {
        "@jridgewell/gen-mapping": "^0.3.5",
        "@jridgewell/trace-mapping": "^0.3.24"
      },
      "engines": {
        "node": ">=6.0.0"
      }
    },
    "node_modules/@babel/runtime": {
      "version": "7.27.6",
      "resolved": "https://registry.npmjs.org/@babel/runtime/-/runtime-7.27.6.tgz",
      "integrity": "sha512-vbavdySgbTTrmFE+EsiqUTzlOr5bzlnJtUv9PynGCAKvfQqjIXbvFdumPM/GxMDfyuGMJaJAU6TO4zc1Jf1i8Q==",
      "license": "MIT",
      "engines": {
        "node": ">=6.9.0"
      }
    },
    "node_modules/@effect/platform": {
      "version": "0.85.2",
      "resolved": "https://registry.npmjs.org/@effect/platform/-/platform-0.85.2.tgz",
      "integrity": "sha512-zIRixbQeO6QniR0k2mwR7DmR2HO1w6+qQlzQ5nb8lyPyPgd1gV9wo/9yBeB6zRC+CGnxiUiYsRMamclVISuxLw==",
      "license": "MIT",
      "dependencies": {
        "find-my-way-ts": "^0.1.5",
        "msgpackr": "^1.11.4",
        "multipasta": "^0.2.5"
      },
      "peerDependencies": {
        "effect": "^3.16.8"
      }
    },
    "node_modules/@esbuild/aix-ppc64": {
      "version": "0.25.5",
      "resolved": "https://registry.npmjs.org/@esbuild/aix-ppc64/-/aix-ppc64-0.25.5.tgz",
      "integrity": "sha512-9o3TMmpmftaCMepOdA5k/yDw8SfInyzWWTjYTFCX3kPSDJMROQTb8jg+h9Cnwnmm1vOzvxN7gIfB5V2ewpjtGA==",
      "cpu": [
        "ppc64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "aix"
      ],
      "engines": {
        "node": ">=18"
      }
    },
    "node_modules/@esbuild/android-arm": {
      "version": "0.25.5",
      "resolved": "https://registry.npmjs.org/@esbuild/android-arm/-/android-arm-0.25.5.tgz",
      "integrity": "sha512-AdJKSPeEHgi7/ZhuIPtcQKr5RQdo6OO2IL87JkianiMYMPbCtot9fxPbrMiBADOWWm3T2si9stAiVsGbTQFkbA==",
      "cpu": [
        "arm"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "android"
      ],
      "engines": {
        "node": ">=18"
      }
    },
    "node_modules/@esbuild/android-arm64": {
      "version": "0.25.5",
      "resolved": "https://registry.npmjs.org/@esbuild/android-arm64/-/android-arm64-0.25.5.tgz",
      "integrity": "sha512-VGzGhj4lJO+TVGV1v8ntCZWJktV7SGCs3Pn1GRWI1SBFtRALoomm8k5E9Pmwg3HOAal2VDc2F9+PM/rEY6oIDg==",
      "cpu": [
        "arm64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "android"
      ],
      "engines": {
        "node": ">=18"
      }
    },
    "node_modules/@esbuild/android-x64": {
      "version": "0.25.5",
      "resolved": "https://registry.npmjs.org/@esbuild/android-x64/-/android-x64-0.25.5.tgz",
      "integrity": "sha512-D2GyJT1kjvO//drbRT3Hib9XPwQeWd9vZoBJn+bu/lVsOZ13cqNdDeqIF/xQ5/VmWvMduP6AmXvylO/PIc2isw==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "android"
      ],
      "engines": {
        "node": ">=18"
      }
    },
    "node_modules/@esbuild/darwin-arm64": {
      "version": "0.25.5",
      "resolved": "https://registry.npmjs.org/@esbuild/darwin-arm64/-/darwin-arm64-0.25.5.tgz",
      "integrity": "sha512-GtaBgammVvdF7aPIgH2jxMDdivezgFu6iKpmT+48+F8Hhg5J/sfnDieg0aeG/jfSvkYQU2/pceFPDKlqZzwnfQ==",
      "cpu": [
        "arm64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "darwin"
      ],
      "engines": {
        "node": ">=18"
      }
    },
    "node_modules/@esbuild/darwin-x64": {
      "version": "0.25.5",
      "resolved": "https://registry.npmjs.org/@esbuild/darwin-x64/-/darwin-x64-0.25.5.tgz",
      "integrity": "sha512-1iT4FVL0dJ76/q1wd7XDsXrSW+oLoquptvh4CLR4kITDtqi2e/xwXwdCVH8hVHU43wgJdsq7Gxuzcs6Iq/7bxQ==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "darwin"
      ],
      "engines": {
        "node": ">=18"
      }
    },
    "node_modules/@esbuild/freebsd-arm64": {
      "version": "0.25.5",
      "resolved": "https://registry.npmjs.org/@esbuild/freebsd-arm64/-/freebsd-arm64-0.25.5.tgz",
      "integrity": "sha512-nk4tGP3JThz4La38Uy/gzyXtpkPW8zSAmoUhK9xKKXdBCzKODMc2adkB2+8om9BDYugz+uGV7sLmpTYzvmz6Sw==",
      "cpu": [
        "arm64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "freebsd"
      ],
      "engines": {
        "node": ">=18"
      }
    },
    "node_modules/@esbuild/freebsd-x64": {
      "version": "0.25.5",
      "resolved": "https://registry.npmjs.org/@esbuild/freebsd-x64/-/freebsd-x64-0.25.5.tgz",
      "integrity": "sha512-PrikaNjiXdR2laW6OIjlbeuCPrPaAl0IwPIaRv+SMV8CiM8i2LqVUHFC1+8eORgWyY7yhQY+2U2fA55mBzReaw==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "freebsd"
      ],
      "engines": {
        "node": ">=18"
      }
    },
    "node_modules/@esbuild/linux-arm": {
      "version": "0.25.5",
      "resolved": "https://registry.npmjs.org/@esbuild/linux-arm/-/linux-arm-0.25.5.tgz",
      "integrity": "sha512-cPzojwW2okgh7ZlRpcBEtsX7WBuqbLrNXqLU89GxWbNt6uIg78ET82qifUy3W6OVww6ZWobWub5oqZOVtwolfw==",
      "cpu": [
        "arm"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": ">=18"
      }
    },
    "node_modules/@esbuild/linux-arm64": {
      "version": "0.25.5",
      "resolved": "https://registry.npmjs.org/@esbuild/linux-arm64/-/linux-arm64-0.25.5.tgz",
      "integrity": "sha512-Z9kfb1v6ZlGbWj8EJk9T6czVEjjq2ntSYLY2cw6pAZl4oKtfgQuS4HOq41M/BcoLPzrUbNd+R4BXFyH//nHxVg==",
      "cpu": [
        "arm64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": ">=18"
      }
    },
    "node_modules/@esbuild/linux-ia32": {
      "version": "0.25.5",
      "resolved": "https://registry.npmjs.org/@esbuild/linux-ia32/-/linux-ia32-0.25.5.tgz",
      "integrity": "sha512-sQ7l00M8bSv36GLV95BVAdhJ2QsIbCuCjh/uYrWiMQSUuV+LpXwIqhgJDcvMTj+VsQmqAHL2yYaasENvJ7CDKA==",
      "cpu": [
        "ia32"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": ">=18"
      }
    },
    "node_modules/@esbuild/linux-loong64": {
      "version": "0.25.5",
      "resolved": "https://registry.npmjs.org/@esbuild/linux-loong64/-/linux-loong64-0.25.5.tgz",
      "integrity": "sha512-0ur7ae16hDUC4OL5iEnDb0tZHDxYmuQyhKhsPBV8f99f6Z9KQM02g33f93rNH5A30agMS46u2HP6qTdEt6Q1kg==",
      "cpu": [
        "loong64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": ">=18"
      }
    },
    "node_modules/@esbuild/linux-mips64el": {
      "version": "0.25.5",
      "resolved": "https://registry.npmjs.org/@esbuild/linux-mips64el/-/linux-mips64el-0.25.5.tgz",
      "integrity": "sha512-kB/66P1OsHO5zLz0i6X0RxlQ+3cu0mkxS3TKFvkb5lin6uwZ/ttOkP3Z8lfR9mJOBk14ZwZ9182SIIWFGNmqmg==",
      "cpu": [
        "mips64el"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": ">=18"
      }
    },
    "node_modules/@esbuild/linux-ppc64": {
      "version": "0.25.5",
      "resolved": "https://registry.npmjs.org/@esbuild/linux-ppc64/-/linux-ppc64-0.25.5.tgz",
      "integrity": "sha512-UZCmJ7r9X2fe2D6jBmkLBMQetXPXIsZjQJCjgwpVDz+YMcS6oFR27alkgGv3Oqkv07bxdvw7fyB71/olceJhkQ==",
      "cpu": [
        "ppc64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": ">=18"
      }
    },
    "node_modules/@esbuild/linux-riscv64": {
      "version": "0.25.5",
      "resolved": "https://registry.npmjs.org/@esbuild/linux-riscv64/-/linux-riscv64-0.25.5.tgz",
      "integrity": "sha512-kTxwu4mLyeOlsVIFPfQo+fQJAV9mh24xL+y+Bm6ej067sYANjyEw1dNHmvoqxJUCMnkBdKpvOn0Ahql6+4VyeA==",
      "cpu": [
        "riscv64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": ">=18"
      }
    },
    "node_modules/@esbuild/linux-s390x": {
      "version": "0.25.5",
      "resolved": "https://registry.npmjs.org/@esbuild/linux-s390x/-/linux-s390x-0.25.5.tgz",
      "integrity": "sha512-K2dSKTKfmdh78uJ3NcWFiqyRrimfdinS5ErLSn3vluHNeHVnBAFWC8a4X5N+7FgVE1EjXS1QDZbpqZBjfrqMTQ==",
      "cpu": [
        "s390x"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": ">=18"
      }
    },
    "node_modules/@esbuild/linux-x64": {
      "version": "0.25.5",
      "resolved": "https://registry.npmjs.org/@esbuild/linux-x64/-/linux-x64-0.25.5.tgz",
      "integrity": "sha512-uhj8N2obKTE6pSZ+aMUbqq+1nXxNjZIIjCjGLfsWvVpy7gKCOL6rsY1MhRh9zLtUtAI7vpgLMK6DxjO8Qm9lJw==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": ">=18"
      }
    },
    "node_modules/@esbuild/netbsd-arm64": {
      "version": "0.25.5",
      "resolved": "https://registry.npmjs.org/@esbuild/netbsd-arm64/-/netbsd-arm64-0.25.5.tgz",
      "integrity": "sha512-pwHtMP9viAy1oHPvgxtOv+OkduK5ugofNTVDilIzBLpoWAM16r7b/mxBvfpuQDpRQFMfuVr5aLcn4yveGvBZvw==",
      "cpu": [
        "arm64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "netbsd"
      ],
      "engines": {
        "node": ">=18"
      }
    },
    "node_modules/@esbuild/netbsd-x64": {
      "version": "0.25.5",
      "resolved": "https://registry.npmjs.org/@esbuild/netbsd-x64/-/netbsd-x64-0.25.5.tgz",
      "integrity": "sha512-WOb5fKrvVTRMfWFNCroYWWklbnXH0Q5rZppjq0vQIdlsQKuw6mdSihwSo4RV/YdQ5UCKKvBy7/0ZZYLBZKIbwQ==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "netbsd"
      ],
      "engines": {
        "node": ">=18"
      }
    },
    "node_modules/@esbuild/openbsd-arm64": {
      "version": "0.25.5",
      "resolved": "https://registry.npmjs.org/@esbuild/openbsd-arm64/-/openbsd-arm64-0.25.5.tgz",
      "integrity": "sha512-7A208+uQKgTxHd0G0uqZO8UjK2R0DDb4fDmERtARjSHWxqMTye4Erz4zZafx7Di9Cv+lNHYuncAkiGFySoD+Mw==",
      "cpu": [
        "arm64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "openbsd"
      ],
      "engines": {
        "node": ">=18"
      }
    },
    "node_modules/@esbuild/openbsd-x64": {
      "version": "0.25.5",
      "resolved": "https://registry.npmjs.org/@esbuild/openbsd-x64/-/openbsd-x64-0.25.5.tgz",
      "integrity": "sha512-G4hE405ErTWraiZ8UiSoesH8DaCsMm0Cay4fsFWOOUcz8b8rC6uCvnagr+gnioEjWn0wC+o1/TAHt+It+MpIMg==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "openbsd"
      ],
      "engines": {
        "node": ">=18"
      }
    },
    "node_modules/@esbuild/sunos-x64": {
      "version": "0.25.5",
      "resolved": "https://registry.npmjs.org/@esbuild/sunos-x64/-/sunos-x64-0.25.5.tgz",
      "integrity": "sha512-l+azKShMy7FxzY0Rj4RCt5VD/q8mG/e+mDivgspo+yL8zW7qEwctQ6YqKX34DTEleFAvCIUviCFX1SDZRSyMQA==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "sunos"
      ],
      "engines": {
        "node": ">=18"
      }
    },
    "node_modules/@esbuild/win32-arm64": {
      "version": "0.25.5",
      "resolved": "https://registry.npmjs.org/@esbuild/win32-arm64/-/win32-arm64-0.25.5.tgz",
      "integrity": "sha512-O2S7SNZzdcFG7eFKgvwUEZ2VG9D/sn/eIiz8XRZ1Q/DO5a3s76Xv0mdBzVM5j5R639lXQmPmSo0iRpHqUUrsxw==",
      "cpu": [
        "arm64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "win32"
      ],
      "engines": {
        "node": ">=18"
      }
    },
    "node_modules/@esbuild/win32-ia32": {
      "version": "0.25.5",
      "resolved": "https://registry.npmjs.org/@esbuild/win32-ia32/-/win32-ia32-0.25.5.tgz",
      "integrity": "sha512-onOJ02pqs9h1iMJ1PQphR+VZv8qBMQ77Klcsqv9CNW2w6yLqoURLcgERAIurY6QE63bbLuqgP9ATqajFLK5AMQ==",
      "cpu": [
        "ia32"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "win32"
      ],
      "engines": {
        "node": ">=18"
      }
    },
    "node_modules/@esbuild/win32-x64": {
      "version": "0.25.5",
      "resolved": "https://registry.npmjs.org/@esbuild/win32-x64/-/win32-x64-0.25.5.tgz",
      "integrity": "sha512-TXv6YnJ8ZMVdX+SXWVBo/0p8LTcrUYngpWjvm91TMjjBQii7Oz11Lw5lbDV5Y0TzuhSJHwiH4hEtC1I42mMS0g==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "win32"
      ],
      "engines": {
        "node": ">=18"
      }
    },
    "node_modules/@img/sharp-win32-x64": {
      "version": "0.34.2",
      "resolved": "https://registry.npmjs.org/@img/sharp-win32-x64/-/sharp-win32-x64-0.34.2.tgz",
      "integrity": "sha512-aUdT6zEYtDKCaxkofmmJDJYGCf0+pJg3eU9/oBuqvEeoB9dKI6ZLc/1iLJCTuJQDO4ptntAlkUmHgGjyuobZbw==",
      "cpu": [
        "x64"
      ],
      "license": "Apache-2.0 AND LGPL-3.0-or-later",
      "optional": true,
      "os": [
        "win32"
      ],
      "engines": {
        "node": "^18.17.0 || ^20.3.0 || >=21.0.0"
      },
      "funding": {
        "url": "https://opencollective.com/libvips"
      }
    },
    "node_modules/@isaacs/fs-minipass": {
      "version": "4.0.1",
      "resolved": "https://registry.npmjs.org/@isaacs/fs-minipass/-/fs-minipass-4.0.1.tgz",
      "integrity": "sha512-wgm9Ehl2jpeqP3zw/7mo3kRHFp5MEDhqAdwy1fTGkHAwnkGOVsgpvQhL8B5n1qlb01jV3n/bI0ZfZp5lWA1k4w==",
      "dev": true,
      "license": "ISC",
      "dependencies": {
        "minipass": "^7.0.4"
      },
      "engines": {
        "node": ">=18.0.0"
      }
    },
    "node_modules/@jridgewell/gen-mapping": {
      "version": "0.3.8",
      "resolved": "https://registry.npmjs.org/@jridgewell/gen-mapping/-/gen-mapping-0.3.8.tgz",
      "integrity": "sha512-imAbBGkb+ebQyxKgzv5Hu2nmROxoDOXHh80evxdoXNOrvAnVx7zimzc1Oo5h9RlfV4vPXaE2iM5pOFbvOCClWA==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@jridgewell/set-array": "^1.2.1",
        "@jridgewell/sourcemap-codec": "^1.4.10",
        "@jridgewell/trace-mapping": "^0.3.24"
      },
      "engines": {
        "node": ">=6.0.0"
      }
    },
    "node_modules/@jridgewell/resolve-uri": {
      "version": "3.1.2",
      "resolved": "https://registry.npmjs.org/@jridgewell/resolve-uri/-/resolve-uri-3.1.2.tgz",
      "integrity": "sha512-bRISgCIjP20/tbWSPWMEi54QVPRZExkuD9lJL+UIxUKtwVJA8wW1Trb1jMs1RFXo1CBTNZ/5hpC9QvmKWdopKw==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">=6.0.0"
      }
    },
    "node_modules/@jridgewell/set-array": {
      "version": "1.2.1",
      "resolved": "https://registry.npmjs.org/@jridgewell/set-array/-/set-array-1.2.1.tgz",
      "integrity": "sha512-R8gLRTZeyp03ymzP/6Lil/28tGeGEzhx1q2k703KGWRAI1VdvPIXdG70VJc2pAMw3NA6JKL5hhFu1sJX0Mnn/A==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">=6.0.0"
      }
    },
    "node_modules/@jridgewell/sourcemap-codec": {
      "version": "1.5.0",
      "resolved": "https://registry.npmjs.org/@jridgewell/sourcemap-codec/-/sourcemap-codec-1.5.0.tgz",
      "integrity": "sha512-gv3ZRaISU3fjPAgNsriBRqGWQL6quFx04YMPW/zD8XMLsU32mhCCbfbO6KZFLjvYpCZ8zyDEgqsgf+PwPaM7GQ==",
      "dev": true,
      "license": "MIT"
    },
    "node_modules/@jridgewell/trace-mapping": {
      "version": "0.3.25",
      "resolved": "https://registry.npmjs.org/@jridgewell/trace-mapping/-/trace-mapping-0.3.25.tgz",
      "integrity": "sha512-vNk6aEwybGtawWmy/PzwnGDOjCkLWSD2wqvjGGAgOAwCGWySYXfYoxt00IJkTF+8Lb57DwOb3Aa0o9CApepiYQ==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@jridgewell/resolve-uri": "^3.1.0",
        "@jridgewell/sourcemap-codec": "^1.4.14"
      }
    },
    "node_modules/@msgpackr-extract/msgpackr-extract-darwin-arm64": {
      "version": "3.0.3",
      "resolved": "https://registry.npmjs.org/@msgpackr-extract/msgpackr-extract-darwin-arm64/-/msgpackr-extract-darwin-arm64-3.0.3.tgz",
      "integrity": "sha512-QZHtlVgbAdy2zAqNA9Gu1UpIuI8Xvsd1v8ic6B2pZmeFnFcMWiPLfWXh7TVw4eGEZ/C9TH281KwhVoeQUKbyjw==",
      "cpu": [
        "arm64"
      ],
      "license": "MIT",
      "optional": true,
      "os": [
        "darwin"
      ]
    },
    "node_modules/@msgpackr-extract/msgpackr-extract-darwin-x64": {
      "version": "3.0.3",
      "resolved": "https://registry.npmjs.org/@msgpackr-extract/msgpackr-extract-darwin-x64/-/msgpackr-extract-darwin-x64-3.0.3.tgz",
      "integrity": "sha512-mdzd3AVzYKuUmiWOQ8GNhl64/IoFGol569zNRdkLReh6LRLHOXxU4U8eq0JwaD8iFHdVGqSy4IjFL4reoWCDFw==",
      "cpu": [
        "x64"
      ],
      "license": "MIT",
      "optional": true,
      "os": [
        "darwin"
      ]
    },
    "node_modules/@msgpackr-extract/msgpackr-extract-linux-arm": {
      "version": "3.0.3",
      "resolved": "https://registry.npmjs.org/@msgpackr-extract/msgpackr-extract-linux-arm/-/msgpackr-extract-linux-arm-3.0.3.tgz",
      "integrity": "sha512-fg0uy/dG/nZEXfYilKoRe7yALaNmHoYeIoJuJ7KJ+YyU2bvY8vPv27f7UKhGRpY6euFYqEVhxCFZgAUNQBM3nw==",
      "cpu": [
        "arm"
      ],
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ]
    },
    "node_modules/@msgpackr-extract/msgpackr-extract-linux-arm64": {
      "version": "3.0.3",
      "resolved": "https://registry.npmjs.org/@msgpackr-extract/msgpackr-extract-linux-arm64/-/msgpackr-extract-linux-arm64-3.0.3.tgz",
      "integrity": "sha512-YxQL+ax0XqBJDZiKimS2XQaf+2wDGVa1enVRGzEvLLVFeqa5kx2bWbtcSXgsxjQB7nRqqIGFIcLteF/sHeVtQg==",
      "cpu": [
        "arm64"
      ],
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ]
    },
    "node_modules/@msgpackr-extract/msgpackr-extract-linux-x64": {
      "version": "3.0.3",
      "resolved": "https://registry.npmjs.org/@msgpackr-extract/msgpackr-extract-linux-x64/-/msgpackr-extract-linux-x64-3.0.3.tgz",
      "integrity": "sha512-cvwNfbP07pKUfq1uH+S6KJ7dT9K8WOE4ZiAcsrSes+UY55E/0jLYc+vq+DO7jlmqRb5zAggExKm0H7O/CBaesg==",
      "cpu": [
        "x64"
      ],
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ]
    },
    "node_modules/@msgpackr-extract/msgpackr-extract-win32-x64": {
      "version": "3.0.3",
      "resolved": "https://registry.npmjs.org/@msgpackr-extract/msgpackr-extract-win32-x64/-/msgpackr-extract-win32-x64-3.0.3.tgz",
      "integrity": "sha512-x0fWaQtYp4E6sktbsdAqnehxDgEc/VwM7uLsRCYWaiGu0ykYdZPiS8zCWdnjHwyiumousxfBm4SO31eXqwEZhQ==",
      "cpu": [
        "x64"
      ],
      "license": "MIT",
      "optional": true,
      "os": [
        "win32"
      ]
    },
    "node_modules/@next-auth/prisma-adapter": {
      "version": "1.0.7",
      "resolved": "https://registry.npmjs.org/@next-auth/prisma-adapter/-/prisma-adapter-1.0.7.tgz",
      "integrity": "sha512-Cdko4KfcmKjsyHFrWwZ//lfLUbcLqlyFqjd/nYE2m3aZ7tjMNUjpks47iw7NTCnXf+5UWz5Ypyt1dSs1EP5QJw==",
      "license": "ISC",
      "peerDependencies": {
        "@prisma/client": ">=2.26.0 || >=3",
        "next-auth": "^4"
      }
    },
    "node_modules/@next/env": {
      "version": "15.3.2",
      "resolved": "https://registry.npmjs.org/@next/env/-/env-15.3.2.tgz",
      "integrity": "sha512-xURk++7P7qR9JG1jJtLzPzf0qEvqCN0A/T3DXf8IPMKo9/6FfjxtEffRJIIew/bIL4T3C2jLLqBor8B/zVlx6g==",
      "license": "MIT"
    },
    "node_modules/@next/swc-darwin-arm64": {
      "version": "15.3.2",
      "resolved": "https://registry.npmjs.org/@next/swc-darwin-arm64/-/swc-darwin-arm64-15.3.2.tgz",
      "integrity": "sha512-2DR6kY/OGcokbnCsjHpNeQblqCZ85/1j6njYSkzRdpLn5At7OkSdmk7WyAmB9G0k25+VgqVZ/u356OSoQZ3z0g==",
      "cpu": [
        "arm64"
      ],
      "optional": true,
      "os": [
        "darwin"
      ],
      "engines": {
        "node": ">= 10"
      }
    },
    "node_modules/@next/swc-darwin-x64": {
      "version": "15.3.2",
      "resolved": "https://registry.npmjs.org/@next/swc-darwin-x64/-/swc-darwin-x64-15.3.2.tgz",
      "integrity": "sha512-ro/fdqaZWL6k1S/5CLv1I0DaZfDVJkWNaUU3un8Lg6m0YENWlDulmIWzV96Iou2wEYyEsZq51mwV8+XQXqMp3w==",
      "cpu": [
        "x64"
      ],
      "optional": true,
      "os": [
        "darwin"
      ],
      "engines": {
        "node": ">= 10"
      }
    },
    "node_modules/@next/swc-linux-arm64-gnu": {
      "version": "15.3.2",
      "resolved": "https://registry.npmjs.org/@next/swc-linux-arm64-gnu/-/swc-linux-arm64-gnu-15.3.2.tgz",
      "integrity": "sha512-covwwtZYhlbRWK2HlYX9835qXum4xYZ3E2Mra1mdQ+0ICGoMiw1+nVAn4d9Bo7R3JqSmK1grMq/va+0cdh7bJA==",
      "cpu": [
        "arm64"
      ],
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": ">= 10"
      }
    },
    "node_modules/@next/swc-linux-arm64-musl": {
      "version": "15.3.2",
      "resolved": "https://registry.npmjs.org/@next/swc-linux-arm64-musl/-/swc-linux-arm64-musl-15.3.2.tgz",
      "integrity": "sha512-KQkMEillvlW5Qk5mtGA/3Yz0/tzpNlSw6/3/ttsV1lNtMuOHcGii3zVeXZyi4EJmmLDKYcTcByV2wVsOhDt/zg==",
      "cpu": [
        "arm64"
      ],
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": ">= 10"
      }
    },
    "node_modules/@next/swc-linux-x64-gnu": {
      "version": "15.3.2",
      "resolved": "https://registry.npmjs.org/@next/swc-linux-x64-gnu/-/swc-linux-x64-gnu-15.3.2.tgz",
      "integrity": "sha512-uRBo6THWei0chz+Y5j37qzx+BtoDRFIkDzZjlpCItBRXyMPIg079eIkOCl3aqr2tkxL4HFyJ4GHDes7W8HuAUg==",
      "cpu": [
        "x64"
      ],
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": ">= 10"
      }
    },
    "node_modules/@next/swc-linux-x64-musl": {
      "version": "15.3.2",
      "resolved": "https://registry.npmjs.org/@next/swc-linux-x64-musl/-/swc-linux-x64-musl-15.3.2.tgz",
      "integrity": "sha512-+uxFlPuCNx/T9PdMClOqeE8USKzj8tVz37KflT3Kdbx/LOlZBRI2yxuIcmx1mPNK8DwSOMNCr4ureSet7eyC0w==",
      "cpu": [
        "x64"
      ],
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": ">= 10"
      }
    },
    "node_modules/@next/swc-win32-arm64-msvc": {
      "version": "15.3.2",
      "resolved": "https://registry.npmjs.org/@next/swc-win32-arm64-msvc/-/swc-win32-arm64-msvc-15.3.2.tgz",
      "integrity": "sha512-LLTKmaI5cfD8dVzh5Vt7+OMo+AIOClEdIU/TSKbXXT2iScUTSxOGoBhfuv+FU8R9MLmrkIL1e2fBMkEEjYAtPQ==",
      "cpu": [
        "arm64"
      ],
      "optional": true,
      "os": [
        "win32"
      ],
      "engines": {
        "node": ">= 10"
      }
    },
    "node_modules/@next/swc-win32-x64-msvc": {
      "version": "15.3.2",
      "resolved": "https://registry.npmjs.org/@next/swc-win32-x64-msvc/-/swc-win32-x64-msvc-15.3.2.tgz",
      "integrity": "sha512-aW5B8wOPioJ4mBdMDXkt5f3j8pUr9W8AnlX0Df35uRWNT1Y6RIybxjnSUe+PhM+M1bwgyY8PHLmXZC6zT1o5tA==",
      "cpu": [
        "x64"
      ],
      "license": "MIT",
      "optional": true,
      "os": [
        "win32"
      ],
      "engines": {
        "node": ">= 10"
      }
    },
    "node_modules/@panva/hkdf": {
      "version": "1.2.1",
      "resolved": "https://registry.npmjs.org/@panva/hkdf/-/hkdf-1.2.1.tgz",
      "integrity": "sha512-6oclG6Y3PiDFcoyk8srjLfVKyMfVCKJ27JwNPViuXziFpmdz+MZnZN/aKY0JGXgYuO/VghU0jcOAZgWXZ1Dmrw==",
      "license": "MIT",
      "funding": {
        "url": "https://github.com/sponsors/panva"
      }
    },
    "node_modules/@prisma/client": {
      "version": "6.9.0",
      "resolved": "https://registry.npmjs.org/@prisma/client/-/client-6.9.0.tgz",
      "integrity": "sha512-Gg7j1hwy3SgF1KHrh0PZsYvAaykeR0PaxusnLXydehS96voYCGt1U5zVR31NIouYc63hWzidcrir1a7AIyCsNQ==",
      "hasInstallScript": true,
      "license": "Apache-2.0",
      "engines": {
        "node": ">=18.18"
      },
      "peerDependencies": {
        "prisma": "*",
        "typescript": ">=5.1.0"
      },
      "peerDependenciesMeta": {
        "prisma": {
          "optional": true
        },
        "typescript": {
          "optional": true
        }
      }
    },
    "node_modules/@prisma/config": {
      "version": "6.9.0",
      "resolved": "https://registry.npmjs.org/@prisma/config/-/config-6.9.0.tgz",
      "integrity": "sha512-Wcfk8/lN3WRJd5w4jmNQkUwhUw0eksaU/+BlAJwPQKW10k0h0LC9PD/6TQFmqKVbHQL0vG2z266r0S1MPzzhbA==",
      "devOptional": true,
      "license": "Apache-2.0",
      "dependencies": {
        "jiti": "2.4.2"
      }
    },
    "node_modules/@prisma/debug": {
      "version": "6.9.0",
      "resolved": "https://registry.npmjs.org/@prisma/debug/-/debug-6.9.0.tgz",
      "integrity": "sha512-bFeur/qi/Q+Mqk4JdQ3R38upSYPebv5aOyD1RKywVD+rAMLtRkmTFn28ZuTtVOnZHEdtxnNOCH+bPIeSGz1+Fg==",
      "devOptional": true,
      "license": "Apache-2.0"
    },
    "node_modules/@prisma/engines": {
      "version": "6.9.0",
      "resolved": "https://registry.npmjs.org/@prisma/engines/-/engines-6.9.0.tgz",
      "integrity": "sha512-im0X0bwDLA0244CDf8fuvnLuCQcBBdAGgr+ByvGfQY9wWl6EA+kRGwVk8ZIpG65rnlOwtaWIr/ZcEU5pNVvq9g==",
      "devOptional": true,
      "hasInstallScript": true,
      "license": "Apache-2.0",
      "dependencies": {
        "@prisma/debug": "6.9.0",
        "@prisma/engines-version": "6.9.0-10.81e4af48011447c3cc503a190e86995b66d2a28e",
        "@prisma/fetch-engine": "6.9.0",
        "@prisma/get-platform": "6.9.0"
      }
    },
    "node_modules/@prisma/engines-version": {
      "version": "6.9.0-10.81e4af48011447c3cc503a190e86995b66d2a28e",
      "resolved": "https://registry.npmjs.org/@prisma/engines-version/-/engines-version-6.9.0-10.81e4af48011447c3cc503a190e86995b66d2a28e.tgz",
      "integrity": "sha512-Qp9gMoBHgqhKlrvumZWujmuD7q4DV/gooEyPCLtbkc13EZdSz2RsGUJ5mHb3RJgAbk+dm6XenqG7obJEhXcJ6Q==",
      "devOptional": true,
      "license": "Apache-2.0"
    },
    "node_modules/@prisma/fetch-engine": {
      "version": "6.9.0",
      "resolved": "https://registry.npmjs.org/@prisma/fetch-engine/-/fetch-engine-6.9.0.tgz",
      "integrity": "sha512-PMKhJdl4fOdeE3J3NkcWZ+tf3W6rx3ht/rLU8w4SXFRcLhd5+3VcqY4Kslpdm8osca4ej3gTfB3+cSk5pGxgFg==",
      "devOptional": true,
      "license": "Apache-2.0",
      "dependencies": {
        "@prisma/debug": "6.9.0",
        "@prisma/engines-version": "6.9.0-10.81e4af48011447c3cc503a190e86995b66d2a28e",
        "@prisma/get-platform": "6.9.0"
      }
    },
    "node_modules/@prisma/get-platform": {
      "version": "6.9.0",
      "resolved": "https://registry.npmjs.org/@prisma/get-platform/-/get-platform-6.9.0.tgz",
      "integrity": "sha512-/B4n+5V1LI/1JQcHp+sUpyRT1bBgZVPHbsC4lt4/19Xp4jvNIVcq5KYNtQDk5e/ukTSjo9PZVAxxy9ieFtlpTQ==",
      "devOptional": true,
      "license": "Apache-2.0",
      "dependencies": {
        "@prisma/debug": "6.9.0"
      }
    },
    "node_modules/@react-email/render": {
      "version": "1.1.2",
      "resolved": "https://registry.npmjs.org/@react-email/render/-/render-1.1.2.tgz",
      "integrity": "sha512-RnRehYN3v9gVlNMehHPHhyp2RQo7+pSkHDtXPvg3s0GbzM9SQMW4Qrf8GRNvtpLC4gsI+Wt0VatNRUFqjvevbw==",
      "license": "MIT",
      "dependencies": {
        "html-to-text": "^9.0.5",
        "prettier": "^3.5.3",
        "react-promise-suspense": "^0.3.4"
      },
      "engines": {
        "node": ">=18.0.0"
      },
      "peerDependencies": {
        "react": "^18.0 || ^19.0 || ^19.0.0-rc",
        "react-dom": "^18.0 || ^19.0 || ^19.0.0-rc"
      }
    },
    "node_modules/@selderee/plugin-htmlparser2": {
      "version": "0.11.0",
      "resolved": "https://registry.npmjs.org/@selderee/plugin-htmlparser2/-/plugin-htmlparser2-0.11.0.tgz",
      "integrity": "sha512-P33hHGdldxGabLFjPPpaTxVolMrzrcegejx+0GxjrIb9Zv48D8yAIA/QTDR2dFl7Uz7urX8aX6+5bCZslr+gWQ==",
      "license": "MIT",
      "dependencies": {
        "domhandler": "^5.0.3",
        "selderee": "^0.11.0"
      },
      "funding": {
        "url": "https://ko-fi.com/killymxi"
      }
    },
    "node_modules/@standard-schema/spec": {
      "version": "1.0.0-beta.4",
      "resolved": "https://registry.npmjs.org/@standard-schema/spec/-/spec-1.0.0-beta.4.tgz",
      "integrity": "sha512-d3IxtzLo7P1oZ8s8YNvxzBUXRXojSut8pbPrTYtzsc5sn4+53jVqbk66pQerSZbZSJZQux6LkclB/+8IDordHg==",
      "license": "MIT"
    },
    "node_modules/@swc/counter": {
      "version": "0.1.3",
      "resolved": "https://registry.npmjs.org/@swc/counter/-/counter-0.1.3.tgz",
      "integrity": "sha512-e2BR4lsJkkRlKZ/qCHPw9ZaSxc0MVUd7gtbtaB7aMvHeJVYe8sOB8DBZkP2DtISHGSku9sCK6T6cnY0CtXrOCQ==",
      "license": "Apache-2.0"
    },
    "node_modules/@swc/helpers": {
      "version": "0.5.15",
      "resolved": "https://registry.npmjs.org/@swc/helpers/-/helpers-0.5.15.tgz",
      "integrity": "sha512-JQ5TuMi45Owi4/BIMAJBoSQoOJu12oOk/gADqlcUL9JEdHB8vyjUSsxqeNXnmXHjYKMi2WcYtezGEEhqUI/E2g==",
      "license": "Apache-2.0",
      "dependencies": {
        "tslib": "^2.8.0"
      }
    },
    "node_modules/@tailwindcss/node": {
      "version": "4.1.8",
      "resolved": "https://registry.npmjs.org/@tailwindcss/node/-/node-4.1.8.tgz",
      "integrity": "sha512-OWwBsbC9BFAJelmnNcrKuf+bka2ZxCE2A4Ft53Tkg4uoiE67r/PMEYwCsourC26E+kmxfwE0hVzMdxqeW+xu7Q==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@ampproject/remapping": "^2.3.0",
        "enhanced-resolve": "^5.18.1",
        "jiti": "^2.4.2",
        "lightningcss": "1.30.1",
        "magic-string": "^0.30.17",
        "source-map-js": "^1.2.1",
        "tailwindcss": "4.1.8"
      }
    },
    "node_modules/@tailwindcss/oxide": {
      "version": "4.1.8",
      "resolved": "https://registry.npmjs.org/@tailwindcss/oxide/-/oxide-4.1.8.tgz",
      "integrity": "sha512-d7qvv9PsM5N3VNKhwVUhpK6r4h9wtLkJ6lz9ZY9aeZgrUWk1Z8VPyqyDT9MZlem7GTGseRQHkeB1j3tC7W1P+A==",
      "dev": true,
      "hasInstallScript": true,
      "license": "MIT",
      "dependencies": {
        "detect-libc": "^2.0.4",
        "tar": "^7.4.3"
      },
      "engines": {
        "node": ">= 10"
      },
      "optionalDependencies": {
        "@tailwindcss/oxide-android-arm64": "4.1.8",
        "@tailwindcss/oxide-darwin-arm64": "4.1.8",
        "@tailwindcss/oxide-darwin-x64": "4.1.8",
        "@tailwindcss/oxide-freebsd-x64": "4.1.8",
        "@tailwindcss/oxide-linux-arm-gnueabihf": "4.1.8",
        "@tailwindcss/oxide-linux-arm64-gnu": "4.1.8",
        "@tailwindcss/oxide-linux-arm64-musl": "4.1.8",
        "@tailwindcss/oxide-linux-x64-gnu": "4.1.8",
        "@tailwindcss/oxide-linux-x64-musl": "4.1.8",
        "@tailwindcss/oxide-wasm32-wasi": "4.1.8",
        "@tailwindcss/oxide-win32-arm64-msvc": "4.1.8",
        "@tailwindcss/oxide-win32-x64-msvc": "4.1.8"
      }
    },
    "node_modules/@tailwindcss/oxide-win32-x64-msvc": {
      "version": "4.1.8",
      "resolved": "https://registry.npmjs.org/@tailwindcss/oxide-win32-x64-msvc/-/oxide-win32-x64-msvc-4.1.8.tgz",
      "integrity": "sha512-fou+U20j+Jl0EHwK92spoWISON2OBnCazIc038Xj2TdweYV33ZRkS9nwqiUi2d/Wba5xg5UoHfvynnb/UB49cQ==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "win32"
      ],
      "engines": {
        "node": ">= 10"
      }
    },
    "node_modules/@tailwindcss/postcss": {
      "version": "4.1.8",
      "resolved": "https://registry.npmjs.org/@tailwindcss/postcss/-/postcss-4.1.8.tgz",
      "integrity": "sha512-vB/vlf7rIky+w94aWMw34bWW1ka6g6C3xIOdICKX2GC0VcLtL6fhlLiafF0DVIwa9V6EHz8kbWMkS2s2QvvNlw==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@alloc/quick-lru": "^5.2.0",
        "@tailwindcss/node": "4.1.8",
        "@tailwindcss/oxide": "4.1.8",
        "postcss": "^8.4.41",
        "tailwindcss": "4.1.8"
      }
    },
    "node_modules/@types/jsonwebtoken": {
      "version": "9.0.10",
      "resolved": "https://registry.npmjs.org/@types/jsonwebtoken/-/jsonwebtoken-9.0.10.tgz",
      "integrity": "sha512-asx5hIG9Qmf/1oStypjanR7iKTv0gXQ1Ov/jfrX6kS/EO0OFni8orbmGCn0672NHR3kXHwpAwR+B368ZGN/2rA==",
      "license": "MIT",
      "dependencies": {
        "@types/ms": "*",
        "@types/node": "*"
      }
    },
    "node_modules/@types/ms": {
      "version": "2.1.0",
      "resolved": "https://registry.npmjs.org/@types/ms/-/ms-2.1.0.tgz",
      "integrity": "sha512-GsCCIZDE/p3i96vtEqx+7dBUGXrc7zeSK3wwPHIaRThS+9OhWIXRqzs4d6k1SVU8g91DrNRWxWUGhp5KXQb2VA==",
      "license": "MIT"
    },
    "node_modules/@types/node": {
      "version": "20.17.57",
      "resolved": "https://registry.npmjs.org/@types/node/-/node-20.17.57.tgz",
      "integrity": "sha512-f3T4y6VU4fVQDKVqJV4Uppy8c1p/sVvS3peyqxyWnzkqXFJLRU7Y1Bl7rMS1Qe9z0v4M6McY0Fp9yBsgHJUsWQ==",
      "license": "MIT",
      "dependencies": {
        "undici-types": "~6.19.2"
      }
    },
    "node_modules/@types/react": {
      "version": "19.1.6",
      "resolved": "https://registry.npmjs.org/@types/react/-/react-19.1.6.tgz",
      "integrity": "sha512-JeG0rEWak0N6Itr6QUx+X60uQmN+5t3j9r/OVDtWzFXKaj6kD1BwJzOksD0FF6iWxZlbE1kB0q9vtnU2ekqa1Q==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "csstype": "^3.0.2"
      }
    },
    "node_modules/@types/react-dom": {
      "version": "19.1.5",
      "resolved": "https://registry.npmjs.org/@types/react-dom/-/react-dom-19.1.5.tgz",
      "integrity": "sha512-CMCjrWucUBZvohgZxkjd6S9h0nZxXjzus6yDfUb+xLxYM7VvjKNH1tQrE9GWLql1XoOP4/Ds3bwFqShHUYraGg==",
      "dev": true,
      "license": "MIT",
      "peerDependencies": {
        "@types/react": "^19.0.0"
      }
    },
    "node_modules/@uploadthing/mime-types": {
      "version": "0.3.5",
      "resolved": "https://registry.npmjs.org/@uploadthing/mime-types/-/mime-types-0.3.5.tgz",
      "integrity": "sha512-iYOmod80XXOSe4NVvaUG9FsS91YGPUaJMTBj52Nwu0G2aTzEN6Xcl0mG1rWqXJ4NUH8MzjVqg+tQND5TPkJWhg==",
      "license": "MIT"
    },
    "node_modules/@uploadthing/react": {
      "version": "7.3.2",
      "resolved": "https://registry.npmjs.org/@uploadthing/react/-/react-7.3.2.tgz",
      "integrity": "sha512-dssVzrxGBKBHUzJu/CiEGc3hQ49U4sPdnqN5xMmtEdnJP+6OB+a8JUjkwxiJDBQXc3ft9XCmkLCZZoUt1EQSIw==",
      "license": "MIT",
      "dependencies": {
        "@uploadthing/shared": "7.1.9",
        "file-selector": "0.6.0"
      },
      "peerDependencies": {
        "next": "*",
        "react": "^17.0.2 || ^18.0.0 || ^19.0.0",
        "uploadthing": "^7.2.0"
      },
      "peerDependenciesMeta": {
        "next": {
          "optional": true
        }
      }
    },
    "node_modules/@uploadthing/shared": {
      "version": "7.1.9",
      "resolved": "https://registry.npmjs.org/@uploadthing/shared/-/shared-7.1.9.tgz",
      "integrity": "sha512-5Gn1wGVSygsBxI6tjOwwEQt/U4m+vbmZCnsuf8pDfZ+MiXe3el03CWMmpbH3KtSu0BwG48wyCKNfHplZsphvOA==",
      "license": "MIT",
      "dependencies": {
        "@uploadthing/mime-types": "0.3.5",
        "effect": "3.16.8",
        "sqids": "^0.3.0"
      }
    },
    "node_modules/bcryptjs": {
      "version": "3.0.2",
      "resolved": "https://registry.npmjs.org/bcryptjs/-/bcryptjs-3.0.2.tgz",
      "integrity": "sha512-k38b3XOZKv60C4E2hVsXTolJWfkGRMbILBIe2IBITXciy5bOsTKot5kDrf3ZfufQtQOUN5mXceUEpU1rTl9Uog==",
      "license": "BSD-3-Clause",
      "bin": {
        "bcrypt": "bin/bcrypt"
      }
    },
    "node_modules/buffer-equal-constant-time": {
      "version": "1.0.1",
      "resolved": "https://registry.npmjs.org/buffer-equal-constant-time/-/buffer-equal-constant-time-1.0.1.tgz",
      "integrity": "sha512-zRpUiDwd/xk6ADqPMATG8vc9VPrkck7T07OIx0gnjmJAnHnTVXNQG3vfvWNuiZIkwu9KrKdA1iJKfsfTVxE6NA==",
      "license": "BSD-3-Clause"
    },
    "node_modules/busboy": {
      "version": "1.6.0",
      "resolved": "https://registry.npmjs.org/busboy/-/busboy-1.6.0.tgz",
      "integrity": "sha512-8SFQbg/0hQ9xy3UNTB0YEnsNBbWfhf7RtnzpL7TkBiTBRfrQ9Fxcnz7VJsleJpyp6rVLvXiuORqjlHi5q+PYuA==",
      "dependencies": {
        "streamsearch": "^1.1.0"
      },
      "engines": {
        "node": ">=10.16.0"
      }
    },
    "node_modules/call-bind-apply-helpers": {
      "version": "1.0.2",
      "resolved": "https://registry.npmjs.org/call-bind-apply-helpers/-/call-bind-apply-helpers-1.0.2.tgz",
      "integrity": "sha512-Sp1ablJ0ivDkSzjcaJdxEunN5/XvksFJ2sMBFfq6x0ryhQV/2b/KwFe21cMpmHtPOSij8K99/wSfoEuTObmuMQ==",
      "license": "MIT",
      "dependencies": {
        "es-errors": "^1.3.0",
        "function-bind": "^1.1.2"
      },
      "engines": {
        "node": ">= 0.4"
      }
    },
    "node_modules/call-bound": {
      "version": "1.0.4",
      "resolved": "https://registry.npmjs.org/call-bound/-/call-bound-1.0.4.tgz",
      "integrity": "sha512-+ys997U96po4Kx/ABpBCqhA9EuxJaQWDQg7295H4hBphv3IZg0boBKuwYpt4YXp6MZ5AmZQnU/tyMTlRpaSejg==",
      "license": "MIT",
      "dependencies": {
        "call-bind-apply-helpers": "^1.0.2",
        "get-intrinsic": "^1.3.0"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/caniuse-lite": {
      "version": "1.0.30001720",
      "resolved": "https://registry.npmjs.org/caniuse-lite/-/caniuse-lite-1.0.30001720.tgz",
      "integrity": "sha512-Ec/2yV2nNPwb4DnTANEV99ZWwm3ZWfdlfkQbWSDDt+PsXEVYwlhPH8tdMaPunYTKKmz7AnHi2oNEi1GcmKCD8g==",
      "funding": [
        {
          "type": "opencollective",
          "url": "https://opencollective.com/browserslist"
        },
        {
          "type": "tidelift",
          "url": "https://tidelift.com/funding/github/npm/caniuse-lite"
        },
        {
          "type": "github",
          "url": "https://github.com/sponsors/ai"
        }
      ],
      "license": "CC-BY-4.0"
    },
    "node_modules/chownr": {
      "version": "3.0.0",
      "resolved": "https://registry.npmjs.org/chownr/-/chownr-3.0.0.tgz",
      "integrity": "sha512-+IxzY9BZOQd/XuYPRmrvEVjF/nqj5kgT4kEq7VofrDoM1MxoRjEWkrCC3EtLi59TVawxTAn+orJwFQcrqEN1+g==",
      "dev": true,
      "license": "BlueOak-1.0.0",
      "engines": {
        "node": ">=18"
      }
    },
    "node_modules/client-only": {
      "version": "0.0.1",
      "resolved": "https://registry.npmjs.org/client-only/-/client-only-0.0.1.tgz",
      "integrity": "sha512-IV3Ou0jSMzZrd3pZ48nLkT9DA7Ag1pnPzaiQhpW7c3RbcqqzvzzVu+L8gfqMp/8IM2MQtSiqaCxrrcfu8I8rMA==",
      "license": "MIT"
    },
    "node_modules/color": {
      "version": "4.2.3",
      "resolved": "https://registry.npmjs.org/color/-/color-4.2.3.tgz",
      "integrity": "sha512-1rXeuUUiGGrykh+CeBdu5Ie7OJwinCgQY0bc7GCRxy5xVHy+moaqkpL/jqQq0MtQOeYcrqEz4abc5f0KtU7W4A==",
      "license": "MIT",
      "optional": true,
      "dependencies": {
        "color-convert": "^2.0.1",
        "color-string": "^1.9.0"
      },
      "engines": {
        "node": ">=12.5.0"
      }
    },
    "node_modules/color-convert": {
      "version": "2.0.1",
      "resolved": "https://registry.npmjs.org/color-convert/-/color-convert-2.0.1.tgz",
      "integrity": "sha512-RRECPsj7iu/xb5oKYcsFHSppFNnsj/52OVTRKb4zP5onXwVF3zVmmToNcOfGC+CRDpfK/U584fMg38ZHCaElKQ==",
      "license": "MIT",
      "optional": true,
      "dependencies": {
        "color-name": "~1.1.4"
      },
      "engines": {
        "node": ">=7.0.0"
      }
    },
    "node_modules/color-name": {
      "version": "1.1.4",
      "resolved": "https://registry.npmjs.org/color-name/-/color-name-1.1.4.tgz",
      "integrity": "sha512-dOy+3AuW3a2wNbZHIuMZpTcgjGuLU/uBL/ubcZF9OXbDo8ff4O8yVp5Bf0efS8uEoYo5q4Fx7dY9OgQGXgAsQA==",
      "license": "MIT",
      "optional": true
    },
    "node_modules/color-string": {
      "version": "1.9.1",
      "resolved": "https://registry.npmjs.org/color-string/-/color-string-1.9.1.tgz",
      "integrity": "sha512-shrVawQFojnZv6xM40anx4CkoDP+fZsw/ZerEMsW/pyzsRbElpsL/DBVW7q3ExxwusdNXI3lXpuhEZkzs8p5Eg==",
      "license": "MIT",
      "optional": true,
      "dependencies": {
        "color-name": "^1.0.0",
        "simple-swizzle": "^0.2.2"
      }
    },
    "node_modules/cookie": {
      "version": "0.7.2",
      "resolved": "https://registry.npmjs.org/cookie/-/cookie-0.7.2.tgz",
      "integrity": "sha512-yki5XnKuf750l50uGTllt6kKILY4nQ1eNIQatoXEByZ5dWgnKqbnqmTrBE5B4N7lrMJKQ2ytWMiTO2o0v6Ew/w==",
      "license": "MIT",
      "engines": {
        "node": ">= 0.6"
      }
    },
    "node_modules/csstype": {
      "version": "3.1.3",
      "resolved": "https://registry.npmjs.org/csstype/-/csstype-3.1.3.tgz",
      "integrity": "sha512-M1uQkMl8rQK/szD0LNhtqxIPLpimGm8sOBwU7lLnCpSbTyY3yeU1Vc7l4KT5zT4s/yOxHH5O7tIuuLOCnLADRw==",
      "dev": true,
      "license": "MIT"
    },
    "node_modules/deepmerge": {
      "version": "4.3.1",
      "resolved": "https://registry.npmjs.org/deepmerge/-/deepmerge-4.3.1.tgz",
      "integrity": "sha512-3sUqbMEc77XqpdNO7FRyRog+eW3ph+GYCbj+rK+uYyRMuwsVy0rMiVtPn+QJlKFvWP/1PYpapqYn0Me2knFn+A==",
      "license": "MIT",
      "engines": {
        "node": ">=0.10.0"
      }
    },
    "node_modules/detect-libc": {
      "version": "2.0.4",
      "resolved": "https://registry.npmjs.org/detect-libc/-/detect-libc-2.0.4.tgz",
      "integrity": "sha512-3UDv+G9CsCKO1WKMGw9fwq/SWJYbI0c5Y7LU1AXYoDdbhE2AHQ6N6Nb34sG8Fj7T5APy8qXDCKuuIHd1BR0tVA==",
      "devOptional": true,
      "license": "Apache-2.0",
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/dom-serializer": {
      "version": "2.0.0",
      "resolved": "https://registry.npmjs.org/dom-serializer/-/dom-serializer-2.0.0.tgz",
      "integrity": "sha512-wIkAryiqt/nV5EQKqQpo3SToSOV9J0DnbJqwK7Wv/Trc92zIAYZ4FlMu+JPFW1DfGFt81ZTCGgDEabffXeLyJg==",
      "license": "MIT",
      "dependencies": {
        "domelementtype": "^2.3.0",
        "domhandler": "^5.0.2",
        "entities": "^4.2.0"
      },
      "funding": {
        "url": "https://github.com/cheeriojs/dom-serializer?sponsor=1"
      }
    },
    "node_modules/domelementtype": {
      "version": "2.3.0",
      "resolved": "https://registry.npmjs.org/domelementtype/-/domelementtype-2.3.0.tgz",
      "integrity": "sha512-OLETBj6w0OsagBwdXnPdN0cnMfF9opN69co+7ZrbfPGrdpPVNBUj02spi6B1N7wChLQiPn4CSH/zJvXw56gmHw==",
      "funding": [
        {
          "type": "github",
          "url": "https://github.com/sponsors/fb55"
        }
      ],
      "license": "BSD-2-Clause"
    },
    "node_modules/domhandler": {
      "version": "5.0.3",
      "resolved": "https://registry.npmjs.org/domhandler/-/domhandler-5.0.3.tgz",
      "integrity": "sha512-cgwlv/1iFQiFnU96XXgROh8xTeetsnJiDsTc7TYCLFd9+/WNkIqPTxiM/8pSd8VIrhXGTf1Ny1q1hquVqDJB5w==",
      "license": "BSD-2-Clause",
      "dependencies": {
        "domelementtype": "^2.3.0"
      },
      "engines": {
        "node": ">= 4"
      },
      "funding": {
        "url": "https://github.com/fb55/domhandler?sponsor=1"
      }
    },
    "node_modules/domutils": {
      "version": "3.2.2",
      "resolved": "https://registry.npmjs.org/domutils/-/domutils-3.2.2.tgz",
      "integrity": "sha512-6kZKyUajlDuqlHKVX1w7gyslj9MPIXzIFiz/rGu35uC1wMi+kMhQwGhl4lt9unC9Vb9INnY9Z3/ZA3+FhASLaw==",
      "license": "BSD-2-Clause",
      "dependencies": {
        "dom-serializer": "^2.0.0",
        "domelementtype": "^2.3.0",
        "domhandler": "^5.0.3"
      },
      "funding": {
        "url": "https://github.com/fb55/domutils?sponsor=1"
      }
    },
    "node_modules/dunder-proto": {
      "version": "1.0.1",
      "resolved": "https://registry.npmjs.org/dunder-proto/-/dunder-proto-1.0.1.tgz",
      "integrity": "sha512-KIN/nDJBQRcXw0MLVhZE9iQHmG68qAVIBg9CqmUYjmQIhgij9U5MFvrqkUL5FbtyyzZuOeOt0zdeRe4UY7ct+A==",
      "license": "MIT",
      "dependencies": {
        "call-bind-apply-helpers": "^1.0.1",
        "es-errors": "^1.3.0",
        "gopd": "^1.2.0"
      },
      "engines": {
        "node": ">= 0.4"
      }
    },
    "node_modules/ecdsa-sig-formatter": {
      "version": "1.0.11",
      "resolved": "https://registry.npmjs.org/ecdsa-sig-formatter/-/ecdsa-sig-formatter-1.0.11.tgz",
      "integrity": "sha512-nagl3RYrbNv6kQkeJIpt6NJZy8twLB/2vtz6yN9Z4vRKHN4/QZJIEbqohALSgwKdnksuY3k5Addp5lg8sVoVcQ==",
      "license": "Apache-2.0",
      "dependencies": {
        "safe-buffer": "^5.0.1"
      }
    },
    "node_modules/effect": {
      "version": "3.16.8",
      "resolved": "https://registry.npmjs.org/effect/-/effect-3.16.8.tgz",
      "integrity": "sha512-E4U0MZFBun99myxOogy9ZZ1c3IYR47L/A5GqCP9Lp+6ORag0YLmGHOrYxQ3agN1FOMTrElgtJmciicwnHdE+Ug==",
      "license": "MIT",
      "dependencies": {
        "@standard-schema/spec": "^1.0.0",
        "fast-check": "^3.23.1"
      }
    },
    "node_modules/effect/node_modules/@standard-schema/spec": {
      "version": "1.0.0",
      "resolved": "https://registry.npmjs.org/@standard-schema/spec/-/spec-1.0.0.tgz",
      "integrity": "sha512-m2bOd0f2RT9k8QJx1JN85cZYyH1RqFBdlwtkSlf4tBDYLCiiZnv1fIIwacK6cqwXavOydf0NPToMQgpKq+dVlA==",
      "license": "MIT"
    },
    "node_modules/enhanced-resolve": {
      "version": "5.18.1",
      "resolved": "https://registry.npmjs.org/enhanced-resolve/-/enhanced-resolve-5.18.1.tgz",
      "integrity": "sha512-ZSW3ma5GkcQBIpwZTSRAI8N71Uuwgs93IezB7mf7R60tC8ZbJideoDNKjHn2O9KIlx6rkGTTEk1xUCK2E1Y2Yg==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "graceful-fs": "^4.2.4",
        "tapable": "^2.2.0"
      },
      "engines": {
        "node": ">=10.13.0"
      }
    },
    "node_modules/entities": {
      "version": "4.5.0",
      "resolved": "https://registry.npmjs.org/entities/-/entities-4.5.0.tgz",
      "integrity": "sha512-V0hjH4dGPh9Ao5p0MoRY6BVqtwCjhz6vI5LT8AJ55H+4g9/4vbHx1I54fS0XuclLhDHArPQCiMjDxjaL8fPxhw==",
      "license": "BSD-2-Clause",
      "engines": {
        "node": ">=0.12"
      },
      "funding": {
        "url": "https://github.com/fb55/entities?sponsor=1"
      }
    },
    "node_modules/es-define-property": {
      "version": "1.0.1",
      "resolved": "https://registry.npmjs.org/es-define-property/-/es-define-property-1.0.1.tgz",
      "integrity": "sha512-e3nRfgfUZ4rNGL232gUgX06QNyyez04KdjFrF+LTRoOXmrOgFKDg4BCdsjW8EnT69eqdYGmRpJwiPVYNrCaW3g==",
      "license": "MIT",
      "engines": {
        "node": ">= 0.4"
      }
    },
    "node_modules/es-errors": {
      "version": "1.3.0",
      "resolved": "https://registry.npmjs.org/es-errors/-/es-errors-1.3.0.tgz",
      "integrity": "sha512-Zf5H2Kxt2xjTvbJvP2ZWLEICxA6j+hAmMzIlypy4xcBg1vKVnx89Wy0GbS+kf5cwCVFFzdCFh2XSCFNULS6csw==",
      "license": "MIT",
      "engines": {
        "node": ">= 0.4"
      }
    },
    "node_modules/es-object-atoms": {
      "version": "1.1.1",
      "resolved": "https://registry.npmjs.org/es-object-atoms/-/es-object-atoms-1.1.1.tgz",
      "integrity": "sha512-FGgH2h8zKNim9ljj7dankFPcICIK9Cp5bm+c2gQSYePhpaG5+esrLODihIorn+Pe6FGJzWhXQotPv73jTaldXA==",
      "license": "MIT",
      "dependencies": {
        "es-errors": "^1.3.0"
      },
      "engines": {
        "node": ">= 0.4"
      }
    },
    "node_modules/esbuild": {
      "version": "0.25.5",
      "resolved": "https://registry.npmjs.org/esbuild/-/esbuild-0.25.5.tgz",
      "integrity": "sha512-P8OtKZRv/5J5hhz0cUAdu/cLuPIKXpQl1R9pZtvmHWQvrAUVd0UNIPT4IB4W3rNOqVO0rlqHmCIbSwxh/c9yUQ==",
      "dev": true,
      "hasInstallScript": true,
      "license": "MIT",
      "bin": {
        "esbuild": "bin/esbuild"
      },
      "engines": {
        "node": ">=18"
      },
      "optionalDependencies": {
        "@esbuild/aix-ppc64": "0.25.5",
        "@esbuild/android-arm": "0.25.5",
        "@esbuild/android-arm64": "0.25.5",
        "@esbuild/android-x64": "0.25.5",
        "@esbuild/darwin-arm64": "0.25.5",
        "@esbuild/darwin-x64": "0.25.5",
        "@esbuild/freebsd-arm64": "0.25.5",
        "@esbuild/freebsd-x64": "0.25.5",
        "@esbuild/linux-arm": "0.25.5",
        "@esbuild/linux-arm64": "0.25.5",
        "@esbuild/linux-ia32": "0.25.5",
        "@esbuild/linux-loong64": "0.25.5",
        "@esbuild/linux-mips64el": "0.25.5",
        "@esbuild/linux-ppc64": "0.25.5",
        "@esbuild/linux-riscv64": "0.25.5",
        "@esbuild/linux-s390x": "0.25.5",
        "@esbuild/linux-x64": "0.25.5",
        "@esbuild/netbsd-arm64": "0.25.5",
        "@esbuild/netbsd-x64": "0.25.5",
        "@esbuild/openbsd-arm64": "0.25.5",
        "@esbuild/openbsd-x64": "0.25.5",
        "@esbuild/sunos-x64": "0.25.5",
        "@esbuild/win32-arm64": "0.25.5",
        "@esbuild/win32-ia32": "0.25.5",
        "@esbuild/win32-x64": "0.25.5"
      }
    },
    "node_modules/fast-check": {
      "version": "3.23.2",
      "resolved": "https://registry.npmjs.org/fast-check/-/fast-check-3.23.2.tgz",
      "integrity": "sha512-h5+1OzzfCC3Ef7VbtKdcv7zsstUQwUDlYpUTvjeUsJAssPgLn7QzbboPtL5ro04Mq0rPOsMzl7q5hIbRs2wD1A==",
      "funding": [
        {
          "type": "individual",
          "url": "https://github.com/sponsors/dubzzz"
        },
        {
          "type": "opencollective",
          "url": "https://opencollective.com/fast-check"
        }
      ],
      "license": "MIT",
      "dependencies": {
        "pure-rand": "^6.1.0"
      },
      "engines": {
        "node": ">=8.0.0"
      }
    },
    "node_modules/fast-deep-equal": {
      "version": "2.0.1",
      "resolved": "https://registry.npmjs.org/fast-deep-equal/-/fast-deep-equal-2.0.1.tgz",
      "integrity": "sha512-bCK/2Z4zLidyB4ReuIsvALH6w31YfAQDmXMqMx6FyfHqvBxtjC0eRumeSu4Bs3XtXwpyIywtSTrVT99BxY1f9w==",
      "license": "MIT"
    },
    "node_modules/file-selector": {
      "version": "0.6.0",
      "resolved": "https://registry.npmjs.org/file-selector/-/file-selector-0.6.0.tgz",
      "integrity": "sha512-QlZ5yJC0VxHxQQsQhXvBaC7VRJ2uaxTf+Tfpu4Z/OcVQJVpZO+DGU0rkoVW5ce2SccxugvpBJoMvUs59iILYdw==",
      "license": "MIT",
      "dependencies": {
        "tslib": "^2.4.0"
      },
      "engines": {
        "node": ">= 12"
      }
    },
    "node_modules/find-my-way-ts": {
      "version": "0.1.5",
      "resolved": "https://registry.npmjs.org/find-my-way-ts/-/find-my-way-ts-0.1.5.tgz",
      "integrity": "sha512-4GOTMrpGQVzsCH2ruUn2vmwzV/02zF4q+ybhCIrw/Rkt3L8KWcycdC6aJMctJzwN4fXD4SD5F/4B9Sksh5rE0A==",
      "license": "MIT"
    },
    "node_modules/fsevents": {
      "version": "2.3.3",
      "resolved": "https://registry.npmjs.org/fsevents/-/fsevents-2.3.3.tgz",
      "integrity": "sha512-5xoDfX+fL7faATnagmWPpbFtwh/R77WmMMqqHGS65C3vvB0YHrgF+B1YmZ3441tMj5n63k0212XNoJwzlhffQw==",
      "dev": true,
      "hasInstallScript": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "darwin"
      ],
      "engines": {
        "node": "^8.16.0 || ^10.6.0 || >=11.0.0"
      }
    },
    "node_modules/function-bind": {
      "version": "1.1.2",
      "resolved": "https://registry.npmjs.org/function-bind/-/function-bind-1.1.2.tgz",
      "integrity": "sha512-7XHNxH7qX9xG5mIwxkhumTox/MIRNcOgDrxWsMt2pAr23WHp6MrRlN7FBSFpCpr+oVO0F744iUgR82nJMfG2SA==",
      "license": "MIT",
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/get-intrinsic": {
      "version": "1.3.0",
      "resolved": "https://registry.npmjs.org/get-intrinsic/-/get-intrinsic-1.3.0.tgz",
      "integrity": "sha512-9fSjSaos/fRIVIp+xSJlE6lfwhES7LNtKaCBIamHsjr2na1BiABJPo0mOjjz8GJDURarmCPGqaiVg5mfjb98CQ==",
      "license": "MIT",
      "dependencies": {
        "call-bind-apply-helpers": "^1.0.2",
        "es-define-property": "^1.0.1",
        "es-errors": "^1.3.0",
        "es-object-atoms": "^1.1.1",
        "function-bind": "^1.1.2",
        "get-proto": "^1.0.1",
        "gopd": "^1.2.0",
        "has-symbols": "^1.1.0",
        "hasown": "^2.0.2",
        "math-intrinsics": "^1.1.0"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/get-proto": {
      "version": "1.0.1",
      "resolved": "https://registry.npmjs.org/get-proto/-/get-proto-1.0.1.tgz",
      "integrity": "sha512-sTSfBjoXBp89JvIKIefqw7U2CCebsc74kiY6awiGogKtoSGbgjYE/G/+l9sF3MWFPNc9IcoOC4ODfKHfxFmp0g==",
      "license": "MIT",
      "dependencies": {
        "dunder-proto": "^1.0.1",
        "es-object-atoms": "^1.0.0"
      },
      "engines": {
        "node": ">= 0.4"
      }
    },
    "node_modules/get-tsconfig": {
      "version": "4.10.1",
      "resolved": "https://registry.npmjs.org/get-tsconfig/-/get-tsconfig-4.10.1.tgz",
      "integrity": "sha512-auHyJ4AgMz7vgS8Hp3N6HXSmlMdUyhSUrfBF16w153rxtLIEOE+HGqaBppczZvnHLqQJfiHotCYpNhl0lUROFQ==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "resolve-pkg-maps": "^1.0.0"
      },
      "funding": {
        "url": "https://github.com/privatenumber/get-tsconfig?sponsor=1"
      }
    },
    "node_modules/gopd": {
      "version": "1.2.0",
      "resolved": "https://registry.npmjs.org/gopd/-/gopd-1.2.0.tgz",
      "integrity": "sha512-ZUKRh6/kUFoAiTAtTYPZJ3hw9wNxx+BIBOijnlG9PnrJsCcSjs1wyyD6vJpaYtgnzDrKYRSqf3OO6Rfa93xsRg==",
      "license": "MIT",
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/graceful-fs": {
      "version": "4.2.11",
      "resolved": "https://registry.npmjs.org/graceful-fs/-/graceful-fs-4.2.11.tgz",
      "integrity": "sha512-RbJ5/jmFcNNCcDV5o9eTnBLJ/HszWV0P73bc+Ff4nS/rJj+YaS6IGyiOL0VoBYX+l1Wrl3k63h/KrH+nhJ0XvQ==",
      "dev": true,
      "license": "ISC"
    },
    "node_modules/has-symbols": {
      "version": "1.1.0",
      "resolved": "https://registry.npmjs.org/has-symbols/-/has-symbols-1.1.0.tgz",
      "integrity": "sha512-1cDNdwJ2Jaohmb3sg4OmKaMBwuC48sYni5HUw2DvsC8LjGTLK9h+eb1X6RyuOHe4hT0ULCW68iomhjUoKUqlPQ==",
      "license": "MIT",
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/hasown": {
      "version": "2.0.2",
      "resolved": "https://registry.npmjs.org/hasown/-/hasown-2.0.2.tgz",
      "integrity": "sha512-0hJU9SCPvmMzIBdZFqNPXWa6dqh7WdH0cII9y+CyS8rG3nL48Bclra9HmKhVVUHyPWNH5Y7xDwAB7bfgSjkUMQ==",
      "license": "MIT",
      "dependencies": {
        "function-bind": "^1.1.2"
      },
      "engines": {
        "node": ">= 0.4"
      }
    },
    "node_modules/html-to-text": {
      "version": "9.0.5",
      "resolved": "https://registry.npmjs.org/html-to-text/-/html-to-text-9.0.5.tgz",
      "integrity": "sha512-qY60FjREgVZL03vJU6IfMV4GDjGBIoOyvuFdpBDIX9yTlDw0TjxVBQp+P8NvpdIXNJvfWBTNul7fsAQJq2FNpg==",
      "license": "MIT",
      "dependencies": {
        "@selderee/plugin-htmlparser2": "^0.11.0",
        "deepmerge": "^4.3.1",
        "dom-serializer": "^2.0.0",
        "htmlparser2": "^8.0.2",
        "selderee": "^0.11.0"
      },
      "engines": {
        "node": ">=14"
      }
    },
    "node_modules/htmlparser2": {
      "version": "8.0.2",
      "resolved": "https://registry.npmjs.org/htmlparser2/-/htmlparser2-8.0.2.tgz",
      "integrity": "sha512-GYdjWKDkbRLkZ5geuHs5NY1puJ+PXwP7+fHPRz06Eirsb9ugf6d8kkXav6ADhcODhFFPMIXyxkxSuMf3D6NCFA==",
      "funding": [
        "https://github.com/fb55/htmlparser2?sponsor=1",
        {
          "type": "github",
          "url": "https://github.com/sponsors/fb55"
        }
      ],
      "license": "MIT",
      "dependencies": {
        "domelementtype": "^2.3.0",
        "domhandler": "^5.0.3",
        "domutils": "^3.0.1",
        "entities": "^4.4.0"
      }
    },
    "node_modules/is-arrayish": {
      "version": "0.3.2",
      "resolved": "https://registry.npmjs.org/is-arrayish/-/is-arrayish-0.3.2.tgz",
      "integrity": "sha512-eVRqCvVlZbuw3GrM63ovNSNAeA1K16kaR/LRY/92w0zxQ5/1YzwblUX652i4Xs9RwAGjW9d9y6X88t8OaAJfWQ==",
      "license": "MIT",
      "optional": true
    },
    "node_modules/jiti": {
      "version": "2.4.2",
      "resolved": "https://registry.npmjs.org/jiti/-/jiti-2.4.2.tgz",
      "integrity": "sha512-rg9zJN+G4n2nfJl5MW3BMygZX56zKPNVEYYqq7adpmMh4Jn2QNEwhvQlFy6jPVdcod7txZtKHWnyZiA3a0zP7A==",
      "devOptional": true,
      "license": "MIT",
      "bin": {
        "jiti": "lib/jiti-cli.mjs"
      }
    },
    "node_modules/jose": {
      "version": "4.15.9",
      "resolved": "https://registry.npmjs.org/jose/-/jose-4.15.9.tgz",
      "integrity": "sha512-1vUQX+IdDMVPj4k8kOxgUqlcK518yluMuGZwqlr44FS1ppZB/5GWh4rZG89erpOBOJjU/OBsnCVFfapsRz6nEA==",
      "license": "MIT",
      "funding": {
        "url": "https://github.com/sponsors/panva"
      }
    },
    "node_modules/jsonwebtoken": {
      "version": "9.0.2",
      "resolved": "https://registry.npmjs.org/jsonwebtoken/-/jsonwebtoken-9.0.2.tgz",
      "integrity": "sha512-PRp66vJ865SSqOlgqS8hujT5U4AOgMfhrwYIuIhfKaoSCZcirrmASQr8CX7cUg+RMih+hgznrjp99o+W4pJLHQ==",
      "license": "MIT",
      "dependencies": {
        "jws": "^3.2.2",
        "lodash.includes": "^4.3.0",
        "lodash.isboolean": "^3.0.3",
        "lodash.isinteger": "^4.0.4",
        "lodash.isnumber": "^3.0.3",
        "lodash.isplainobject": "^4.0.6",
        "lodash.isstring": "^4.0.1",
        "lodash.once": "^4.0.0",
        "ms": "^2.1.1",
        "semver": "^7.5.4"
      },
      "engines": {
        "node": ">=12",
        "npm": ">=6"
      }
    },
    "node_modules/jwa": {
      "version": "1.4.2",
      "resolved": "https://registry.npmjs.org/jwa/-/jwa-1.4.2.tgz",
      "integrity": "sha512-eeH5JO+21J78qMvTIDdBXidBd6nG2kZjg5Ohz/1fpa28Z4CcsWUzJ1ZZyFq/3z3N17aZy+ZuBoHljASbL1WfOw==",
      "license": "MIT",
      "dependencies": {
        "buffer-equal-constant-time": "^1.0.1",
        "ecdsa-sig-formatter": "1.0.11",
        "safe-buffer": "^5.0.1"
      }
    },
    "node_modules/jws": {
      "version": "3.2.2",
      "resolved": "https://registry.npmjs.org/jws/-/jws-3.2.2.tgz",
      "integrity": "sha512-YHlZCB6lMTllWDtSPHz/ZXTsi8S00usEV6v1tjq8tOUZzw7DpSDWVXjXDre6ed1w/pd495ODpHZYSdkRTsa0HA==",
      "license": "MIT",
      "dependencies": {
        "jwa": "^1.4.1",
        "safe-buffer": "^5.0.1"
      }
    },
    "node_modules/leac": {
      "version": "0.6.0",
      "resolved": "https://registry.npmjs.org/leac/-/leac-0.6.0.tgz",
      "integrity": "sha512-y+SqErxb8h7nE/fiEX07jsbuhrpO9lL8eca7/Y1nuWV2moNlXhyd59iDGcRf6moVyDMbmTNzL40SUyrFU/yDpg==",
      "license": "MIT",
      "funding": {
        "url": "https://ko-fi.com/killymxi"
      }
    },
    "node_modules/lightningcss": {
      "version": "1.30.1",
      "resolved": "https://registry.npmjs.org/lightningcss/-/lightningcss-1.30.1.tgz",
      "integrity": "sha512-xi6IyHML+c9+Q3W0S4fCQJOym42pyurFiJUHEcEyHS0CeKzia4yZDEsLlqOFykxOdHpNy0NmvVO31vcSqAxJCg==",
      "dev": true,
      "license": "MPL-2.0",
      "dependencies": {
        "detect-libc": "^2.0.3"
      },
      "engines": {
        "node": ">= 12.0.0"
      },
      "funding": {
        "type": "opencollective",
        "url": "https://opencollective.com/parcel"
      },
      "optionalDependencies": {
        "lightningcss-darwin-arm64": "1.30.1",
        "lightningcss-darwin-x64": "1.30.1",
        "lightningcss-freebsd-x64": "1.30.1",
        "lightningcss-linux-arm-gnueabihf": "1.30.1",
        "lightningcss-linux-arm64-gnu": "1.30.1",
        "lightningcss-linux-arm64-musl": "1.30.1",
        "lightningcss-linux-x64-gnu": "1.30.1",
        "lightningcss-linux-x64-musl": "1.30.1",
        "lightningcss-win32-arm64-msvc": "1.30.1",
        "lightningcss-win32-x64-msvc": "1.30.1"
      }
    },
    "node_modules/lightningcss-darwin-arm64": {
      "version": "1.30.1",
      "resolved": "https://registry.npmjs.org/lightningcss-darwin-arm64/-/lightningcss-darwin-arm64-1.30.1.tgz",
      "integrity": "sha512-c8JK7hyE65X1MHMN+Viq9n11RRC7hgin3HhYKhrMyaXflk5GVplZ60IxyoVtzILeKr+xAJwg6zK6sjTBJ0FKYQ==",
      "cpu": [
        "arm64"
      ],
      "dev": true,
      "license": "MPL-2.0",
      "optional": true,
      "os": [
        "darwin"
      ],
      "engines": {
        "node": ">= 12.0.0"
      },
      "funding": {
        "type": "opencollective",
        "url": "https://opencollective.com/parcel"
      }
    },
    "node_modules/lightningcss-darwin-x64": {
      "version": "1.30.1",
      "resolved": "https://registry.npmjs.org/lightningcss-darwin-x64/-/lightningcss-darwin-x64-1.30.1.tgz",
      "integrity": "sha512-k1EvjakfumAQoTfcXUcHQZhSpLlkAuEkdMBsI/ivWw9hL+7FtilQc0Cy3hrx0AAQrVtQAbMI7YjCgYgvn37PzA==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MPL-2.0",
      "optional": true,
      "os": [
        "darwin"
      ],
      "engines": {
        "node": ">= 12.0.0"
      },
      "funding": {
        "type": "opencollective",
        "url": "https://opencollective.com/parcel"
      }
    },
    "node_modules/lightningcss-freebsd-x64": {
      "version": "1.30.1",
      "resolved": "https://registry.npmjs.org/lightningcss-freebsd-x64/-/lightningcss-freebsd-x64-1.30.1.tgz",
      "integrity": "sha512-kmW6UGCGg2PcyUE59K5r0kWfKPAVy4SltVeut+umLCFoJ53RdCUWxcRDzO1eTaxf/7Q2H7LTquFHPL5R+Gjyig==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MPL-2.0",
      "optional": true,
      "os": [
        "freebsd"
      ],
      "engines": {
        "node": ">= 12.0.0"
      },
      "funding": {
        "type": "opencollective",
        "url": "https://opencollective.com/parcel"
      }
    },
    "node_modules/lightningcss-linux-arm-gnueabihf": {
      "version": "1.30.1",
      "resolved": "https://registry.npmjs.org/lightningcss-linux-arm-gnueabihf/-/lightningcss-linux-arm-gnueabihf-1.30.1.tgz",
      "integrity": "sha512-MjxUShl1v8pit+6D/zSPq9S9dQ2NPFSQwGvxBCYaBYLPlCWuPh9/t1MRS8iUaR8i+a6w7aps+B4N0S1TYP/R+Q==",
      "cpu": [
        "arm"
      ],
      "dev": true,
      "license": "MPL-2.0",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": ">= 12.0.0"
      },
      "funding": {
        "type": "opencollective",
        "url": "https://opencollective.com/parcel"
      }
    },
    "node_modules/lightningcss-linux-arm64-gnu": {
      "version": "1.30.1",
      "resolved": "https://registry.npmjs.org/lightningcss-linux-arm64-gnu/-/lightningcss-linux-arm64-gnu-1.30.1.tgz",
      "integrity": "sha512-gB72maP8rmrKsnKYy8XUuXi/4OctJiuQjcuqWNlJQ6jZiWqtPvqFziskH3hnajfvKB27ynbVCucKSm2rkQp4Bw==",
      "cpu": [
        "arm64"
      ],
      "dev": true,
      "license": "MPL-2.0",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": ">= 12.0.0"
      },
      "funding": {
        "type": "opencollective",
        "url": "https://opencollective.com/parcel"
      }
    },
    "node_modules/lightningcss-linux-arm64-musl": {
      "version": "1.30.1",
      "resolved": "https://registry.npmjs.org/lightningcss-linux-arm64-musl/-/lightningcss-linux-arm64-musl-1.30.1.tgz",
      "integrity": "sha512-jmUQVx4331m6LIX+0wUhBbmMX7TCfjF5FoOH6SD1CttzuYlGNVpA7QnrmLxrsub43ClTINfGSYyHe2HWeLl5CQ==",
      "cpu": [
        "arm64"
      ],
      "dev": true,
      "license": "MPL-2.0",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": ">= 12.0.0"
      },
      "funding": {
        "type": "opencollective",
        "url": "https://opencollective.com/parcel"
      }
    },
    "node_modules/lightningcss-linux-x64-gnu": {
      "version": "1.30.1",
      "resolved": "https://registry.npmjs.org/lightningcss-linux-x64-gnu/-/lightningcss-linux-x64-gnu-1.30.1.tgz",
      "integrity": "sha512-piWx3z4wN8J8z3+O5kO74+yr6ze/dKmPnI7vLqfSqI8bccaTGY5xiSGVIJBDd5K5BHlvVLpUB3S2YCfelyJ1bw==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MPL-2.0",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": ">= 12.0.0"
      },
      "funding": {
        "type": "opencollective",
        "url": "https://opencollective.com/parcel"
      }
    },
    "node_modules/lightningcss-linux-x64-musl": {
      "version": "1.30.1",
      "resolved": "https://registry.npmjs.org/lightningcss-linux-x64-musl/-/lightningcss-linux-x64-musl-1.30.1.tgz",
      "integrity": "sha512-rRomAK7eIkL+tHY0YPxbc5Dra2gXlI63HL+v1Pdi1a3sC+tJTcFrHX+E86sulgAXeI7rSzDYhPSeHHjqFhqfeQ==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MPL-2.0",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": ">= 12.0.0"
      },
      "funding": {
        "type": "opencollective",
        "url": "https://opencollective.com/parcel"
      }
    },
    "node_modules/lightningcss-win32-arm64-msvc": {
      "version": "1.30.1",
      "resolved": "https://registry.npmjs.org/lightningcss-win32-arm64-msvc/-/lightningcss-win32-arm64-msvc-1.30.1.tgz",
      "integrity": "sha512-mSL4rqPi4iXq5YVqzSsJgMVFENoa4nGTT/GjO2c0Yl9OuQfPsIfncvLrEW6RbbB24WtZ3xP/2CCmI3tNkNV4oA==",
      "cpu": [
        "arm64"
      ],
      "dev": true,
      "license": "MPL-2.0",
      "optional": true,
      "os": [
        "win32"
      ],
      "engines": {
        "node": ">= 12.0.0"
      },
      "funding": {
        "type": "opencollective",
        "url": "https://opencollective.com/parcel"
      }
    },
    "node_modules/lightningcss-win32-x64-msvc": {
      "version": "1.30.1",
      "resolved": "https://registry.npmjs.org/lightningcss-win32-x64-msvc/-/lightningcss-win32-x64-msvc-1.30.1.tgz",
      "integrity": "sha512-PVqXh48wh4T53F/1CCu8PIPCxLzWyCnn/9T5W1Jpmdy5h9Cwd+0YQS6/LwhHXSafuc61/xg9Lv5OrCby6a++jg==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MPL-2.0",
      "optional": true,
      "os": [
        "win32"
      ],
      "engines": {
        "node": ">= 12.0.0"
      },
      "funding": {
        "type": "opencollective",
        "url": "https://opencollective.com/parcel"
      }
    },
    "node_modules/lodash.includes": {
      "version": "4.3.0",
      "resolved": "https://registry.npmjs.org/lodash.includes/-/lodash.includes-4.3.0.tgz",
      "integrity": "sha512-W3Bx6mdkRTGtlJISOvVD/lbqjTlPPUDTMnlXZFnVwi9NKJ6tiAk6LVdlhZMm17VZisqhKcgzpO5Wz91PCt5b0w==",
      "license": "MIT"
    },
    "node_modules/lodash.isboolean": {
      "version": "3.0.3",
      "resolved": "https://registry.npmjs.org/lodash.isboolean/-/lodash.isboolean-3.0.3.tgz",
      "integrity": "sha512-Bz5mupy2SVbPHURB98VAcw+aHh4vRV5IPNhILUCsOzRmsTmSQ17jIuqopAentWoehktxGd9e/hbIXq980/1QJg==",
      "license": "MIT"
    },
    "node_modules/lodash.isinteger": {
      "version": "4.0.4",
      "resolved": "https://registry.npmjs.org/lodash.isinteger/-/lodash.isinteger-4.0.4.tgz",
      "integrity": "sha512-DBwtEWN2caHQ9/imiNeEA5ys1JoRtRfY3d7V9wkqtbycnAmTvRRmbHKDV4a0EYc678/dia0jrte4tjYwVBaZUA==",
      "license": "MIT"
    },
    "node_modules/lodash.isnumber": {
      "version": "3.0.3",
      "resolved": "https://registry.npmjs.org/lodash.isnumber/-/lodash.isnumber-3.0.3.tgz",
      "integrity": "sha512-QYqzpfwO3/CWf3XP+Z+tkQsfaLL/EnUlXWVkIk5FUPc4sBdTehEqZONuyRt2P67PXAk+NXmTBcc97zw9t1FQrw==",
      "license": "MIT"
    },
    "node_modules/lodash.isplainobject": {
      "version": "4.0.6",
      "resolved": "https://registry.npmjs.org/lodash.isplainobject/-/lodash.isplainobject-4.0.6.tgz",
      "integrity": "sha512-oSXzaWypCMHkPC3NvBEaPHf0KsA5mvPrOPgQWDsbg8n7orZ290M0BmC/jgRZ4vcJ6DTAhjrsSYgdsW/F+MFOBA==",
      "license": "MIT"
    },
    "node_modules/lodash.isstring": {
      "version": "4.0.1",
      "resolved": "https://registry.npmjs.org/lodash.isstring/-/lodash.isstring-4.0.1.tgz",
      "integrity": "sha512-0wJxfxH1wgO3GrbuP+dTTk7op+6L41QCXbGINEmD+ny/G/eCqGzxyCsh7159S+mgDDcoarnBw6PC1PS5+wUGgw==",
      "license": "MIT"
    },
    "node_modules/lodash.once": {
      "version": "4.1.1",
      "resolved": "https://registry.npmjs.org/lodash.once/-/lodash.once-4.1.1.tgz",
      "integrity": "sha512-Sb487aTOCr9drQVL8pIxOzVhafOjZN9UU54hiN8PU3uAiSV7lx1yYNpbNmex2PK6dSJoNTSJUUswT651yww3Mg==",
      "license": "MIT"
    },
    "node_modules/lru-cache": {
      "version": "6.0.0",
      "resolved": "https://registry.npmjs.org/lru-cache/-/lru-cache-6.0.0.tgz",
      "integrity": "sha512-Jo6dJ04CmSjuznwJSS3pUeWmd/H0ffTlkXXgwZi+eq1UCmqQwCh+eLsYOYCwY991i2Fah4h1BEMCx4qThGbsiA==",
      "license": "ISC",
      "dependencies": {
        "yallist": "^4.0.0"
      },
      "engines": {
        "node": ">=10"
      }
    },
    "node_modules/lru-cache/node_modules/yallist": {
      "version": "4.0.0",
      "resolved": "https://registry.npmjs.org/yallist/-/yallist-4.0.0.tgz",
      "integrity": "sha512-3wdGidZyq5PB084XLES5TpOSRA3wjXAlIWMhum2kRcv/41Sn2emQ0dycQW4uZXLejwKvg6EsvbdlVL+FYEct7A==",
      "license": "ISC"
    },
    "node_modules/magic-string": {
      "version": "0.30.17",
      "resolved": "https://registry.npmjs.org/magic-string/-/magic-string-0.30.17.tgz",
      "integrity": "sha512-sNPKHvyjVf7gyjwS4xGTaW/mCnF8wnjtifKBEhxfZ7E/S8tQ0rssrwGNn6q8JH/ohItJfSQp9mBtQYuTlH5QnA==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@jridgewell/sourcemap-codec": "^1.5.0"
      }
    },
    "node_modules/math-intrinsics": {
      "version": "1.1.0",
      "resolved": "https://registry.npmjs.org/math-intrinsics/-/math-intrinsics-1.1.0.tgz",
      "integrity": "sha512-/IXtbwEk5HTPyEwyKX6hGkYXxM9nbj64B+ilVJnC/R6B0pH5G4V3b0pVbL7DBj4tkhBAppbQUlf6F6Xl9LHu1g==",
      "license": "MIT",
      "engines": {
        "node": ">= 0.4"
      }
    },
    "node_modules/minipass": {
      "version": "7.1.2",
      "resolved": "https://registry.npmjs.org/minipass/-/minipass-7.1.2.tgz",
      "integrity": "sha512-qOOzS1cBTWYF4BH8fVePDBOO9iptMnGUEZwNc/cMWnTV2nVLZ7VoNWEPHkYczZA0pdoA7dl6e7FL659nX9S2aw==",
      "dev": true,
      "license": "ISC",
      "engines": {
        "node": ">=16 || 14 >=14.17"
      }
    },
    "node_modules/minizlib": {
      "version": "3.0.2",
      "resolved": "https://registry.npmjs.org/minizlib/-/minizlib-3.0.2.tgz",
      "integrity": "sha512-oG62iEk+CYt5Xj2YqI5Xi9xWUeZhDI8jjQmC5oThVH5JGCTgIjr7ciJDzC7MBzYd//WvR1OTmP5Q38Q8ShQtVA==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "minipass": "^7.1.2"
      },
      "engines": {
        "node": ">= 18"
      }
    },
    "node_modules/mkdirp": {
      "version": "3.0.1",
      "resolved": "https://registry.npmjs.org/mkdirp/-/mkdirp-3.0.1.tgz",
      "integrity": "sha512-+NsyUUAZDmo6YVHzL/stxSu3t9YS1iljliy3BSDrXJ/dkn1KYdmtZODGGjLcc9XLgVVpH4KshHB8XmZgMhaBXg==",
      "dev": true,
      "license": "MIT",
      "bin": {
        "mkdirp": "dist/cjs/src/bin.js"
      },
      "engines": {
        "node": ">=10"
      },
      "funding": {
        "url": "https://github.com/sponsors/isaacs"
      }
    },
    "node_modules/ms": {
      "version": "2.1.3",
      "resolved": "https://registry.npmjs.org/ms/-/ms-2.1.3.tgz",
      "integrity": "sha512-6FlzubTLZG3J2a/NVCAleEhjzq5oxgHyaCU9yYXvcLsvoVaHJq/s5xXI6/XXP6tz7R9xAOtHnSO/tXtF3WRTlA==",
      "license": "MIT"
    },
    "node_modules/msgpackr": {
      "version": "1.11.4",
      "resolved": "https://registry.npmjs.org/msgpackr/-/msgpackr-1.11.4.tgz",
      "integrity": "sha512-uaff7RG9VIC4jacFW9xzL3jc0iM32DNHe4jYVycBcjUePT/Klnfj7pqtWJt9khvDFizmjN2TlYniYmSS2LIaZg==",
      "license": "MIT",
      "optionalDependencies": {
        "msgpackr-extract": "^3.0.2"
      }
    },
    "node_modules/msgpackr-extract": {
      "version": "3.0.3",
      "resolved": "https://registry.npmjs.org/msgpackr-extract/-/msgpackr-extract-3.0.3.tgz",
      "integrity": "sha512-P0efT1C9jIdVRefqjzOQ9Xml57zpOXnIuS+csaB4MdZbTdmGDLo8XhzBG1N7aO11gKDDkJvBLULeFTo46wwreA==",
      "hasInstallScript": true,
      "license": "MIT",
      "optional": true,
      "dependencies": {
        "node-gyp-build-optional-packages": "5.2.2"
      },
      "bin": {
        "download-msgpackr-prebuilds": "bin/download-prebuilds.js"
      },
      "optionalDependencies": {
        "@msgpackr-extract/msgpackr-extract-darwin-arm64": "3.0.3",
        "@msgpackr-extract/msgpackr-extract-darwin-x64": "3.0.3",
        "@msgpackr-extract/msgpackr-extract-linux-arm": "3.0.3",
        "@msgpackr-extract/msgpackr-extract-linux-arm64": "3.0.3",
        "@msgpackr-extract/msgpackr-extract-linux-x64": "3.0.3",
        "@msgpackr-extract/msgpackr-extract-win32-x64": "3.0.3"
      }
    },
    "node_modules/multipasta": {
      "version": "0.2.5",
      "resolved": "https://registry.npmjs.org/multipasta/-/multipasta-0.2.5.tgz",
      "integrity": "sha512-c8eMDb1WwZcE02WVjHoOmUVk7fnKU/RmUcosHACglrWAuPQsEJv+E8430sXj6jNc1jHw0zrS16aCjQh4BcEb4A==",
      "license": "MIT"
    },
    "node_modules/nanoid": {
      "version": "3.3.11",
      "resolved": "https://registry.npmjs.org/nanoid/-/nanoid-3.3.11.tgz",
      "integrity": "sha512-N8SpfPUnUp1bK+PMYW8qSWdl9U+wwNWI4QKxOYDy9JAro3WMX7p2OeVRF9v+347pnakNevPmiHhNmZ2HbFA76w==",
      "funding": [
        {
          "type": "github",
          "url": "https://github.com/sponsors/ai"
        }
      ],
      "license": "MIT",
      "bin": {
        "nanoid": "bin/nanoid.cjs"
      },
      "engines": {
        "node": "^10 || ^12 || ^13.7 || ^14 || >=15.0.1"
      }
    },
    "node_modules/next": {
      "version": "15.3.2",
      "resolved": "https://registry.npmjs.org/next/-/next-15.3.2.tgz",
      "integrity": "sha512-CA3BatMyHkxZ48sgOCLdVHjFU36N7TF1HhqAHLFOkV6buwZnvMI84Cug8xD56B9mCuKrqXnLn94417GrZ/jjCQ==",
      "license": "MIT",
      "dependencies": {
        "@next/env": "15.3.2",
        "@swc/counter": "0.1.3",
        "@swc/helpers": "0.5.15",
        "busboy": "1.6.0",
        "caniuse-lite": "^1.0.30001579",
        "postcss": "8.4.31",
        "styled-jsx": "5.1.6"
      },
      "bin": {
        "next": "dist/bin/next"
      },
      "engines": {
        "node": "^18.18.0 || ^19.8.0 || >= 20.0.0"
      },
      "optionalDependencies": {
        "@next/swc-darwin-arm64": "15.3.2",
        "@next/swc-darwin-x64": "15.3.2",
        "@next/swc-linux-arm64-gnu": "15.3.2",
        "@next/swc-linux-arm64-musl": "15.3.2",
        "@next/swc-linux-x64-gnu": "15.3.2",
        "@next/swc-linux-x64-musl": "15.3.2",
        "@next/swc-win32-arm64-msvc": "15.3.2",
        "@next/swc-win32-x64-msvc": "15.3.2",
        "sharp": "^0.34.1"
      },
      "peerDependencies": {
        "@opentelemetry/api": "^1.1.0",
        "@playwright/test": "^1.41.2",
        "babel-plugin-react-compiler": "*",
        "react": "^18.2.0 || 19.0.0-rc-de68d2f4-20241204 || ^19.0.0",
        "react-dom": "^18.2.0 || 19.0.0-rc-de68d2f4-20241204 || ^19.0.0",
        "sass": "^1.3.0"
      },
      "peerDependenciesMeta": {
        "@opentelemetry/api": {
          "optional": true
        },
        "@playwright/test": {
          "optional": true
        },
        "babel-plugin-react-compiler": {
          "optional": true
        },
        "sass": {
          "optional": true
        }
      }
    },
    "node_modules/next-auth": {
      "version": "4.24.11",
      "resolved": "https://registry.npmjs.org/next-auth/-/next-auth-4.24.11.tgz",
      "integrity": "sha512-pCFXzIDQX7xmHFs4KVH4luCjaCbuPRtZ9oBUjUhOk84mZ9WVPf94n87TxYI4rSRf9HmfHEF8Yep3JrYDVOo3Cw==",
      "license": "ISC",
      "dependencies": {
        "@babel/runtime": "^7.20.13",
        "@panva/hkdf": "^1.0.2",
        "cookie": "^0.7.0",
        "jose": "^4.15.5",
        "oauth": "^0.9.15",
        "openid-client": "^5.4.0",
        "preact": "^10.6.3",
        "preact-render-to-string": "^5.1.19",
        "uuid": "^8.3.2"
      },
      "peerDependencies": {
        "@auth/core": "0.34.2",
        "next": "^12.2.5 || ^13 || ^14 || ^15",
        "nodemailer": "^6.6.5",
        "react": "^17.0.2 || ^18 || ^19",
        "react-dom": "^17.0.2 || ^18 || ^19"
      },
      "peerDependenciesMeta": {
        "@auth/core": {
          "optional": true
        },
        "nodemailer": {
          "optional": true
        }
      }
    },
    "node_modules/next/node_modules/postcss": {
      "version": "8.4.31",
      "resolved": "https://registry.npmjs.org/postcss/-/postcss-8.4.31.tgz",
      "integrity": "sha512-PS08Iboia9mts/2ygV3eLpY5ghnUcfLV/EXTOW1E2qYxJKGGBUtNjN76FYHnMs36RmARn41bC0AZmn+rR0OVpQ==",
      "funding": [
        {
          "type": "opencollective",
          "url": "https://opencollective.com/postcss/"
        },
        {
          "type": "tidelift",
          "url": "https://tidelift.com/funding/github/npm/postcss"
        },
        {
          "type": "github",
          "url": "https://github.com/sponsors/ai"
        }
      ],
      "license": "MIT",
      "dependencies": {
        "nanoid": "^3.3.6",
        "picocolors": "^1.0.0",
        "source-map-js": "^1.0.2"
      },
      "engines": {
        "node": "^10 || ^12 || >=14"
      }
    },
    "node_modules/node-gyp-build-optional-packages": {
      "version": "5.2.2",
      "resolved": "https://registry.npmjs.org/node-gyp-build-optional-packages/-/node-gyp-build-optional-packages-5.2.2.tgz",
      "integrity": "sha512-s+w+rBWnpTMwSFbaE0UXsRlg7hU4FjekKU4eyAih5T8nJuNZT1nNsskXpxmeqSK9UzkBl6UgRlnKc8hz8IEqOw==",
      "license": "MIT",
      "optional": true,
      "dependencies": {
        "detect-libc": "^2.0.1"
      },
      "bin": {
        "node-gyp-build-optional-packages": "bin.js",
        "node-gyp-build-optional-packages-optional": "optional.js",
        "node-gyp-build-optional-packages-test": "build-test.js"
      }
    },
    "node_modules/oauth": {
      "version": "0.9.15",
      "resolved": "https://registry.npmjs.org/oauth/-/oauth-0.9.15.tgz",
      "integrity": "sha512-a5ERWK1kh38ExDEfoO6qUHJb32rd7aYmPHuyCu3Fta/cnICvYmgd2uhuKXvPD+PXB+gCEYYEaQdIRAjCOwAKNA==",
      "license": "MIT"
    },
    "node_modules/object-hash": {
      "version": "2.2.0",
      "resolved": "https://registry.npmjs.org/object-hash/-/object-hash-2.2.0.tgz",
      "integrity": "sha512-gScRMn0bS5fH+IuwyIFgnh9zBdo4DV+6GhygmWM9HyNJSgS0hScp1f5vjtm7oIIOiT9trXrShAkLFSc2IqKNgw==",
      "license": "MIT",
      "engines": {
        "node": ">= 6"
      }
    },
    "node_modules/object-inspect": {
      "version": "1.13.4",
      "resolved": "https://registry.npmjs.org/object-inspect/-/object-inspect-1.13.4.tgz",
      "integrity": "sha512-W67iLl4J2EXEGTbfeHCffrjDfitvLANg0UlX3wFUUSTx92KXRFegMHUVgSqE+wvhAbi4WqjGg9czysTV2Epbew==",
      "license": "MIT",
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/oidc-token-hash": {
      "version": "5.1.0",
      "resolved": "https://registry.npmjs.org/oidc-token-hash/-/oidc-token-hash-5.1.0.tgz",
      "integrity": "sha512-y0W+X7Ppo7oZX6eovsRkuzcSM40Bicg2JEJkDJ4irIt1wsYAP5MLSNv+QAogO8xivMffw/9OvV3um1pxXgt1uA==",
      "license": "MIT",
      "engines": {
        "node": "^10.13.0 || >=12.0.0"
      }
    },
    "node_modules/openid-client": {
      "version": "5.7.1",
      "resolved": "https://registry.npmjs.org/openid-client/-/openid-client-5.7.1.tgz",
      "integrity": "sha512-jDBPgSVfTnkIh71Hg9pRvtJc6wTwqjRkN88+gCFtYWrlP4Yx2Dsrow8uPi3qLr/aeymPF3o2+dS+wOpglK04ew==",
      "license": "MIT",
      "dependencies": {
        "jose": "^4.15.9",
        "lru-cache": "^6.0.0",
        "object-hash": "^2.2.0",
        "oidc-token-hash": "^5.0.3"
      },
      "funding": {
        "url": "https://github.com/sponsors/panva"
      }
    },
    "node_modules/parseley": {
      "version": "0.12.1",
      "resolved": "https://registry.npmjs.org/parseley/-/parseley-0.12.1.tgz",
      "integrity": "sha512-e6qHKe3a9HWr0oMRVDTRhKce+bRO8VGQR3NyVwcjwrbhMmFCX9KszEV35+rn4AdilFAq9VPxP/Fe1wC9Qjd2lw==",
      "license": "MIT",
      "dependencies": {
        "leac": "^0.6.0",
        "peberminta": "^0.9.0"
      },
      "funding": {
        "url": "https://ko-fi.com/killymxi"
      }
    },
    "node_modules/peberminta": {
      "version": "0.9.0",
      "resolved": "https://registry.npmjs.org/peberminta/-/peberminta-0.9.0.tgz",
      "integrity": "sha512-XIxfHpEuSJbITd1H3EeQwpcZbTLHc+VVr8ANI9t5sit565tsI4/xK3KWTUFE2e6QiangUkh3B0jihzmGnNrRsQ==",
      "license": "MIT",
      "funding": {
        "url": "https://ko-fi.com/killymxi"
      }
    },
    "node_modules/picocolors": {
      "version": "1.1.1",
      "resolved": "https://registry.npmjs.org/picocolors/-/picocolors-1.1.1.tgz",
      "integrity": "sha512-xceH2snhtb5M9liqDsmEw56le376mTZkEX/jEb/RxNFyegNul7eNslCXP9FDj/Lcu0X8KEyMceP2ntpaHrDEVA==",
      "license": "ISC"
    },
    "node_modules/postcss": {
      "version": "8.5.4",
      "resolved": "https://registry.npmjs.org/postcss/-/postcss-8.5.4.tgz",
      "integrity": "sha512-QSa9EBe+uwlGTFmHsPKokv3B/oEMQZxfqW0QqNCyhpa6mB1afzulwn8hihglqAb2pOw+BJgNlmXQ8la2VeHB7w==",
      "dev": true,
      "funding": [
        {
          "type": "opencollective",
          "url": "https://opencollective.com/postcss/"
        },
        {
          "type": "tidelift",
          "url": "https://tidelift.com/funding/github/npm/postcss"
        },
        {
          "type": "github",
          "url": "https://github.com/sponsors/ai"
        }
      ],
      "license": "MIT",
      "dependencies": {
        "nanoid": "^3.3.11",
        "picocolors": "^1.1.1",
        "source-map-js": "^1.2.1"
      },
      "engines": {
        "node": "^10 || ^12 || >=14"
      }
    },
    "node_modules/preact": {
      "version": "10.26.8",
      "resolved": "https://registry.npmjs.org/preact/-/preact-10.26.8.tgz",
      "integrity": "sha512-1nMfdFjucm5hKvq0IClqZwK4FJkGXhRrQstOQ3P4vp8HxKrJEMFcY6RdBRVTdfQS/UlnX6gfbPuTvaqx/bDoeQ==",
      "license": "MIT",
      "funding": {
        "type": "opencollective",
        "url": "https://opencollective.com/preact"
      }
    },
    "node_modules/preact-render-to-string": {
      "version": "5.2.6",
      "resolved": "https://registry.npmjs.org/preact-render-to-string/-/preact-render-to-string-5.2.6.tgz",
      "integrity": "sha512-JyhErpYOvBV1hEPwIxc/fHWXPfnEGdRKxc8gFdAZ7XV4tlzyzG847XAyEZqoDnynP88akM4eaHcSOzNcLWFguw==",
      "license": "MIT",
      "dependencies": {
        "pretty-format": "^3.8.0"
      },
      "peerDependencies": {
        "preact": ">=10"
      }
    },
    "node_modules/prettier": {
      "version": "3.6.1",
      "resolved": "https://registry.npmjs.org/prettier/-/prettier-3.6.1.tgz",
      "integrity": "sha512-5xGWRa90Sp2+x1dQtNpIpeOQpTDBs9cZDmA/qs2vDNN2i18PdapqY7CmBeyLlMuGqXJRIOPaCaVZTLNQRWUH/A==",
      "license": "MIT",
      "bin": {
        "prettier": "bin/prettier.cjs"
      },
      "engines": {
        "node": ">=14"
      },
      "funding": {
        "url": "https://github.com/prettier/prettier?sponsor=1"
      }
    },
    "node_modules/pretty-format": {
      "version": "3.8.0",
      "resolved": "https://registry.npmjs.org/pretty-format/-/pretty-format-3.8.0.tgz",
      "integrity": "sha512-WuxUnVtlWL1OfZFQFuqvnvs6MiAGk9UNsBostyBOB0Is9wb5uRESevA6rnl/rkksXaGX3GzZhPup5d6Vp1nFew==",
      "license": "MIT"
    },
    "node_modules/prisma": {
      "version": "6.9.0",
      "resolved": "https://registry.npmjs.org/prisma/-/prisma-6.9.0.tgz",
      "integrity": "sha512-resJAwMyZREC/I40LF6FZ6rZTnlrlrYrb63oW37Gq+U+9xHwbyMSPJjKtM7VZf3gTO86t/Oyz+YeSXr3CmAY1Q==",
      "devOptional": true,
      "hasInstallScript": true,
      "license": "Apache-2.0",
      "dependencies": {
        "@prisma/config": "6.9.0",
        "@prisma/engines": "6.9.0"
      },
      "bin": {
        "prisma": "build/index.js"
      },
      "engines": {
        "node": ">=18.18"
      },
      "peerDependencies": {
        "typescript": ">=5.1.0"
      },
      "peerDependenciesMeta": {
        "typescript": {
          "optional": true
        }
      }
    },
    "node_modules/pure-rand": {
      "version": "6.1.0",
      "resolved": "https://registry.npmjs.org/pure-rand/-/pure-rand-6.1.0.tgz",
      "integrity": "sha512-bVWawvoZoBYpp6yIoQtQXHZjmz35RSVHnUOTefl8Vcjr8snTPY1wnpSPMWekcFwbxI6gtmT7rSYPFvz71ldiOA==",
      "funding": [
        {
          "type": "individual",
          "url": "https://github.com/sponsors/dubzzz"
        },
        {
          "type": "opencollective",
          "url": "https://opencollective.com/fast-check"
        }
      ],
      "license": "MIT"
    },
    "node_modules/qs": {
      "version": "6.14.0",
      "resolved": "https://registry.npmjs.org/qs/-/qs-6.14.0.tgz",
      "integrity": "sha512-YWWTjgABSKcvs/nWBi9PycY/JiPJqOD4JA6o9Sej2AtvSGarXxKC3OQSk4pAarbdQlKAh5D4FCQkJNkW+GAn3w==",
      "license": "BSD-3-Clause",
      "dependencies": {
        "side-channel": "^1.1.0"
      },
      "engines": {
        "node": ">=0.6"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/react": {
      "version": "19.1.0",
      "resolved": "https://registry.npmjs.org/react/-/react-19.1.0.tgz",
      "integrity": "sha512-FS+XFBNvn3GTAWq26joslQgWNoFu08F4kl0J4CgdNKADkdSGXQyTCnKteIAJy96Br6YbpEU1LSzV5dYtjMkMDg==",
      "license": "MIT",
      "engines": {
        "node": ">=0.10.0"
      }
    },
    "node_modules/react-dom": {
      "version": "19.1.0",
      "resolved": "https://registry.npmjs.org/react-dom/-/react-dom-19.1.0.tgz",
      "integrity": "sha512-Xs1hdnE+DyKgeHJeJznQmYMIBG3TKIHJJT95Q58nHLSrElKlGQqDTR2HQ9fx5CN/Gk6Vh/kupBTDLU11/nDk/g==",
      "license": "MIT",
      "dependencies": {
        "scheduler": "^0.26.0"
      },
      "peerDependencies": {
        "react": "^19.1.0"
      }
    },
    "node_modules/react-promise-suspense": {
      "version": "0.3.4",
      "resolved": "https://registry.npmjs.org/react-promise-suspense/-/react-promise-suspense-0.3.4.tgz",
      "integrity": "sha512-I42jl7L3Ze6kZaq+7zXWSunBa3b1on5yfvUW6Eo/3fFOj6dZ5Bqmcd264nJbTK/gn1HjjILAjSwnZbV4RpSaNQ==",
      "license": "MIT",
      "dependencies": {
        "fast-deep-equal": "^2.0.1"
      }
    },
    "node_modules/resend": {
      "version": "4.6.0",
      "resolved": "https://registry.npmjs.org/resend/-/resend-4.6.0.tgz",
      "integrity": "sha512-D5T2I82FvEUYFlrHzaDvVtr5ADHdhuoLaXgLFGABKyNtQgPWIuz0Vp2L2Evx779qjK37aF4kcw1yXJDHhA2JnQ==",
      "license": "MIT",
      "dependencies": {
        "@react-email/render": "1.1.2"
      },
      "engines": {
        "node": ">=18"
      }
    },
    "node_modules/resolve-pkg-maps": {
      "version": "1.0.0",
      "resolved": "https://registry.npmjs.org/resolve-pkg-maps/-/resolve-pkg-maps-1.0.0.tgz",
      "integrity": "sha512-seS2Tj26TBVOC2NIc2rOe2y2ZO7efxITtLZcGSOnHHNOQ7CkiUBfw0Iw2ck6xkIhPwLhKNLS8BO+hEpngQlqzw==",
      "dev": true,
      "license": "MIT",
      "funding": {
        "url": "https://github.com/privatenumber/resolve-pkg-maps?sponsor=1"
      }
    },
    "node_modules/safe-buffer": {
      "version": "5.2.1",
      "resolved": "https://registry.npmjs.org/safe-buffer/-/safe-buffer-5.2.1.tgz",
      "integrity": "sha512-rp3So07KcdmmKbGvgaNxQSJr7bGVSVk5S9Eq1F+ppbRo70+YeaDxkw5Dd8NPN+GD6bjnYm2VuPuCXmpuYvmCXQ==",
      "funding": [
        {
          "type": "github",
          "url": "https://github.com/sponsors/feross"
        },
        {
          "type": "patreon",
          "url": "https://www.patreon.com/feross"
        },
        {
          "type": "consulting",
          "url": "https://feross.org/support"
        }
      ],
      "license": "MIT"
    },
    "node_modules/scheduler": {
      "version": "0.26.0",
      "resolved": "https://registry.npmjs.org/scheduler/-/scheduler-0.26.0.tgz",
      "integrity": "sha512-NlHwttCI/l5gCPR3D1nNXtWABUmBwvZpEQiD4IXSbIDq8BzLIK/7Ir5gTFSGZDUu37K5cMNp0hFtzO38sC7gWA==",
      "license": "MIT"
    },
    "node_modules/selderee": {
      "version": "0.11.0",
      "resolved": "https://registry.npmjs.org/selderee/-/selderee-0.11.0.tgz",
      "integrity": "sha512-5TF+l7p4+OsnP8BCCvSyZiSPc4x4//p5uPwK8TCnVPJYRmU2aYKMpOXvw8zM5a5JvuuCGN1jmsMwuU2W02ukfA==",
      "license": "MIT",
      "dependencies": {
        "parseley": "^0.12.0"
      },
      "funding": {
        "url": "https://ko-fi.com/killymxi"
      }
    },
    "node_modules/semver": {
      "version": "7.7.2",
      "resolved": "https://registry.npmjs.org/semver/-/semver-7.7.2.tgz",
      "integrity": "sha512-RF0Fw+rO5AMf9MAyaRXI4AV0Ulj5lMHqVxxdSgiVbixSCXoEmmX/jk0CuJw4+3SqroYO9VoUh+HcuJivvtJemA==",
      "license": "ISC",
      "bin": {
        "semver": "bin/semver.js"
      },
      "engines": {
        "node": ">=10"
      }
    },
    "node_modules/sharp": {
      "version": "0.34.2",
      "resolved": "https://registry.npmjs.org/sharp/-/sharp-0.34.2.tgz",
      "integrity": "sha512-lszvBmB9QURERtyKT2bNmsgxXK0ShJrL/fvqlonCo7e6xBF8nT8xU6pW+PMIbLsz0RxQk3rgH9kd8UmvOzlMJg==",
      "hasInstallScript": true,
      "license": "Apache-2.0",
      "optional": true,
      "dependencies": {
        "color": "^4.2.3",
        "detect-libc": "^2.0.4",
        "semver": "^7.7.2"
      },
      "engines": {
        "node": "^18.17.0 || ^20.3.0 || >=21.0.0"
      },
      "funding": {
        "url": "https://opencollective.com/libvips"
      },
      "optionalDependencies": {
        "@img/sharp-darwin-arm64": "0.34.2",
        "@img/sharp-darwin-x64": "0.34.2",
        "@img/sharp-libvips-darwin-arm64": "1.1.0",
        "@img/sharp-libvips-darwin-x64": "1.1.0",
        "@img/sharp-libvips-linux-arm": "1.1.0",
        "@img/sharp-libvips-linux-arm64": "1.1.0",
        "@img/sharp-libvips-linux-ppc64": "1.1.0",
        "@img/sharp-libvips-linux-s390x": "1.1.0",
        "@img/sharp-libvips-linux-x64": "1.1.0",
        "@img/sharp-libvips-linuxmusl-arm64": "1.1.0",
        "@img/sharp-libvips-linuxmusl-x64": "1.1.0",
        "@img/sharp-linux-arm": "0.34.2",
        "@img/sharp-linux-arm64": "0.34.2",
        "@img/sharp-linux-s390x": "0.34.2",
        "@img/sharp-linux-x64": "0.34.2",
        "@img/sharp-linuxmusl-arm64": "0.34.2",
        "@img/sharp-linuxmusl-x64": "0.34.2",
        "@img/sharp-wasm32": "0.34.2",
        "@img/sharp-win32-arm64": "0.34.2",
        "@img/sharp-win32-ia32": "0.34.2",
        "@img/sharp-win32-x64": "0.34.2"
      }
    },
    "node_modules/side-channel": {
      "version": "1.1.0",
      "resolved": "https://registry.npmjs.org/side-channel/-/side-channel-1.1.0.tgz",
      "integrity": "sha512-ZX99e6tRweoUXqR+VBrslhda51Nh5MTQwou5tnUDgbtyM0dBgmhEDtWGP/xbKn6hqfPRHujUNwz5fy/wbbhnpw==",
      "license": "MIT",
      "dependencies": {
        "es-errors": "^1.3.0",
        "object-inspect": "^1.13.3",
        "side-channel-list": "^1.0.0",
        "side-channel-map": "^1.0.1",
        "side-channel-weakmap": "^1.0.2"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/side-channel-list": {
      "version": "1.0.0",
      "resolved": "https://registry.npmjs.org/side-channel-list/-/side-channel-list-1.0.0.tgz",
      "integrity": "sha512-FCLHtRD/gnpCiCHEiJLOwdmFP+wzCmDEkc9y7NsYxeF4u7Btsn1ZuwgwJGxImImHicJArLP4R0yX4c2KCrMrTA==",
      "license": "MIT",
      "dependencies": {
        "es-errors": "^1.3.0",
        "object-inspect": "^1.13.3"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/side-channel-map": {
      "version": "1.0.1",
      "resolved": "https://registry.npmjs.org/side-channel-map/-/side-channel-map-1.0.1.tgz",
      "integrity": "sha512-VCjCNfgMsby3tTdo02nbjtM/ewra6jPHmpThenkTYh8pG9ucZ/1P8So4u4FGBek/BjpOVsDCMoLA/iuBKIFXRA==",
      "license": "MIT",
      "dependencies": {
        "call-bound": "^1.0.2",
        "es-errors": "^1.3.0",
        "get-intrinsic": "^1.2.5",
        "object-inspect": "^1.13.3"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/side-channel-weakmap": {
      "version": "1.0.2",
      "resolved": "https://registry.npmjs.org/side-channel-weakmap/-/side-channel-weakmap-1.0.2.tgz",
      "integrity": "sha512-WPS/HvHQTYnHisLo9McqBHOJk2FkHO/tlpvldyrnem4aeQp4hai3gythswg6p01oSoTl58rcpiFAjF2br2Ak2A==",
      "license": "MIT",
      "dependencies": {
        "call-bound": "^1.0.2",
        "es-errors": "^1.3.0",
        "get-intrinsic": "^1.2.5",
        "object-inspect": "^1.13.3",
        "side-channel-map": "^1.0.1"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/simple-swizzle": {
      "version": "0.2.2",
      "resolved": "https://registry.npmjs.org/simple-swizzle/-/simple-swizzle-0.2.2.tgz",
      "integrity": "sha512-JA//kQgZtbuY83m+xT+tXJkmJncGMTFT+C+g2h2R9uxkYIrE2yy9sgmcLhCnw57/WSD+Eh3J97FPEDFnbXnDUg==",
      "license": "MIT",
      "optional": true,
      "dependencies": {
        "is-arrayish": "^0.3.1"
      }
    },
    "node_modules/source-map-js": {
      "version": "1.2.1",
      "resolved": "https://registry.npmjs.org/source-map-js/-/source-map-js-1.2.1.tgz",
      "integrity": "sha512-UXWMKhLOwVKb728IUtQPXxfYU+usdybtUrK/8uGE8CQMvrhOpwvzDBwj0QhSL7MQc7vIsISBG8VQ8+IDQxpfQA==",
      "license": "BSD-3-Clause",
      "engines": {
        "node": ">=0.10.0"
      }
    },
    "node_modules/sqids": {
      "version": "0.3.0",
      "resolved": "https://registry.npmjs.org/sqids/-/sqids-0.3.0.tgz",
      "integrity": "sha512-lOQK1ucVg+W6n3FhRwwSeUijxe93b51Bfz5PMRMihVf1iVkl82ePQG7V5vwrhzB11v0NtsR25PSZRGiSomJaJw==",
      "license": "MIT"
    },
    "node_modules/streamsearch": {
      "version": "1.1.0",
      "resolved": "https://registry.npmjs.org/streamsearch/-/streamsearch-1.1.0.tgz",
      "integrity": "sha512-Mcc5wHehp9aXz1ax6bZUyY5afg9u2rv5cqQI3mRrYkGC8rW2hM02jWuwjtL++LS5qinSyhj2QfLyNsuc+VsExg==",
      "engines": {
        "node": ">=10.0.0"
      }
    },
    "node_modules/stripe": {
      "version": "18.2.1",
      "resolved": "https://registry.npmjs.org/stripe/-/stripe-18.2.1.tgz",
      "integrity": "sha512-GwB1B7WSwEBzW4dilgyJruUYhbGMscrwuyHsPUmSRKrGHZ5poSh2oU9XKdii5BFVJzXHn35geRvGJ6R8bYcp8w==",
      "license": "MIT",
      "dependencies": {
        "qs": "^6.11.0"
      },
      "engines": {
        "node": ">=12.*"
      },
      "peerDependencies": {
        "@types/node": ">=12.x.x"
      },
      "peerDependenciesMeta": {
        "@types/node": {
          "optional": true
        }
      }
    },
    "node_modules/styled-jsx": {
      "version": "5.1.6",
      "resolved": "https://registry.npmjs.org/styled-jsx/-/styled-jsx-5.1.6.tgz",
      "integrity": "sha512-qSVyDTeMotdvQYoHWLNGwRFJHC+i+ZvdBRYosOFgC+Wg1vx4frN2/RG/NA7SYqqvKNLf39P2LSRA2pu6n0XYZA==",
      "license": "MIT",
      "dependencies": {
        "client-only": "0.0.1"
      },
      "engines": {
        "node": ">= 12.0.0"
      },
      "peerDependencies": {
        "react": ">= 16.8.0 || 17.x.x || ^18.0.0-0 || ^19.0.0-0"
      },
      "peerDependenciesMeta": {
        "@babel/core": {
          "optional": true
        },
        "babel-plugin-macros": {
          "optional": true
        }
      }
    },
    "node_modules/tailwindcss": {
      "version": "4.1.8",
      "resolved": "https://registry.npmjs.org/tailwindcss/-/tailwindcss-4.1.8.tgz",
      "integrity": "sha512-kjeW8gjdxasbmFKpVGrGd5T4i40mV5J2Rasw48QARfYeQ8YS9x02ON9SFWax3Qf616rt4Cp3nVNIj6Hd1mP3og==",
      "devOptional": true,
      "license": "MIT"
    },
    "node_modules/tapable": {
      "version": "2.2.2",
      "resolved": "https://registry.npmjs.org/tapable/-/tapable-2.2.2.tgz",
      "integrity": "sha512-Re10+NauLTMCudc7T5WLFLAwDhQ0JWdrMK+9B2M8zR5hRExKmsRDCBA7/aV/pNJFltmBFO5BAMlQFi/vq3nKOg==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">=6"
      }
    },
    "node_modules/tar": {
      "version": "7.4.3",
      "resolved": "https://registry.npmjs.org/tar/-/tar-7.4.3.tgz",
      "integrity": "sha512-5S7Va8hKfV7W5U6g3aYxXmlPoZVAwUMy9AOKyF2fVuZa2UD3qZjg578OrLRt8PcNN1PleVaL/5/yYATNL0ICUw==",
      "dev": true,
      "license": "ISC",
      "dependencies": {
        "@isaacs/fs-minipass": "^4.0.0",
        "chownr": "^3.0.0",
        "minipass": "^7.1.2",
        "minizlib": "^3.0.1",
        "mkdirp": "^3.0.1",
        "yallist": "^5.0.0"
      },
      "engines": {
        "node": ">=18"
      }
    },
    "node_modules/tslib": {
      "version": "2.8.1",
      "resolved": "https://registry.npmjs.org/tslib/-/tslib-2.8.1.tgz",
      "integrity": "sha512-oJFu94HQb+KVduSUQL7wnpmqnfmLsOA/nAh6b6EH0wCEoK0/mPeXU6c3wKDV83MkOuHPRHtSXKKU99IBazS/2w==",
      "license": "0BSD"
    },
    "node_modules/tsx": {
      "version": "4.19.4",
      "resolved": "https://registry.npmjs.org/tsx/-/tsx-4.19.4.tgz",
      "integrity": "sha512-gK5GVzDkJK1SI1zwHf32Mqxf2tSJkNx+eYcNly5+nHvWqXUJYUkWBQtKauoESz3ymezAI++ZwT855x5p5eop+Q==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "esbuild": "~0.25.0",
        "get-tsconfig": "^4.7.5"
      },
      "bin": {
        "tsx": "dist/cli.mjs"
      },
      "engines": {
        "node": ">=18.0.0"
      },
      "optionalDependencies": {
        "fsevents": "~2.3.3"
      }
    },
    "node_modules/typescript": {
      "version": "5.8.3",
      "resolved": "https://registry.npmjs.org/typescript/-/typescript-5.8.3.tgz",
      "integrity": "sha512-p1diW6TqL9L07nNxvRMM7hMMw4c5XOo/1ibL4aAIGmSAt9slTE1Xgw5KWuof2uTOvCg9BY7ZRi+GaF+7sfgPeQ==",
      "devOptional": true,
      "license": "Apache-2.0",
      "bin": {
        "tsc": "bin/tsc",
        "tsserver": "bin/tsserver"
      },
      "engines": {
        "node": ">=14.17"
      }
    },
    "node_modules/undici-types": {
      "version": "6.19.8",
      "resolved": "https://registry.npmjs.org/undici-types/-/undici-types-6.19.8.tgz",
      "integrity": "sha512-ve2KP6f/JnbPBFyobGHuerC9g1FYGn/F8n1LWTwNxCEzd6IfqTwUQcNXgEtmmQ6DlRrC1hrSrBnCZPokRrDHjw==",
      "license": "MIT"
    },
    "node_modules/uploadthing": {
      "version": "7.7.3",
      "resolved": "https://registry.npmjs.org/uploadthing/-/uploadthing-7.7.3.tgz",
      "integrity": "sha512-jmPMVoqM+fWP1EXiwP6VBLTJykZ8z4ryrUr1N8yc87T+cxZw2vyvX2ReCaLhfjdbielPjHm486VCHtO2gYBFQA==",
      "license": "MIT",
      "dependencies": {
        "@effect/platform": "0.85.2",
        "@standard-schema/spec": "1.0.0-beta.4",
        "@uploadthing/mime-types": "0.3.5",
        "@uploadthing/shared": "7.1.9",
        "effect": "3.16.8"
      },
      "engines": {
        "node": ">=18.13.0"
      },
      "peerDependencies": {
        "express": "*",
        "h3": "*",
        "tailwindcss": "^3.0.0 || ^4.0.0-beta.0"
      },
      "peerDependenciesMeta": {
        "express": {
          "optional": true
        },
        "fastify": {
          "optional": true
        },
        "h3": {
          "optional": true
        },
        "next": {
          "optional": true
        },
        "tailwindcss": {
          "optional": true
        }
      }
    },
    "node_modules/uuid": {
      "version": "8.3.2",
      "resolved": "https://registry.npmjs.org/uuid/-/uuid-8.3.2.tgz",
      "integrity": "sha512-+NYs2QeMWy+GWFOEm9xnn6HCDp0l7QBD7ml8zLUmJ+93Q5NF0NocErnwkTkXVFNiX3/fpC6afS8Dhb/gz7R7eg==",
      "license": "MIT",
      "bin": {
        "uuid": "dist/bin/uuid"
      }
    },
    "node_modules/yallist": {
      "version": "5.0.0",
      "resolved": "https://registry.npmjs.org/yallist/-/yallist-5.0.0.tgz",
      "integrity": "sha512-YgvUTfwqyc7UXVMrB+SImsVYSmTS8X/tSrtdNZMImM+n7+QTriRXyXim0mBrTXNeqzVF0KWGgHPeiyViFFrNDw==",
      "dev": true,
      "license": "BlueOak-1.0.0",
      "engines": {
        "node": ">=18"
      }
    }
  }
}

=== FILE: ./package.json ===

{
  "name": "olipopperstudios",
  "version": "0.1.0",
  "private": true,
  "scripts": {
    "dev": "next dev",
    "build": "next build",
    "start": "next start",
    "lint": "next lint",
    "postinstall": "prisma generate && prisma db push",
    "dev:setup": "prisma generate && prisma db push && next dev",
    "seed": "tsx prisma/seed.ts",
    "deploy:vercel": "prisma migrate deploy && next build",
    "migrate:dev": "prisma migrate dev"
  },
  "dependencies": {
    "@next-auth/prisma-adapter": "^1.0.7",
    "@prisma/client": "^6.9.0",
    "@types/jsonwebtoken": "^9.0.10",
    "@uploadthing/react": "^7.3.2",
    "bcryptjs": "^3.0.2",
    "jsonwebtoken": "^9.0.2",
    "next": "15.3.2",
    "next-auth": "^4.24.11",
    "react": "^19.0.0",
    "react-dom": "^19.0.0",
    "resend": "^4.6.0",
    "stripe": "^18.2.1",
    "uploadthing": "^7.7.3"
  },
  "devDependencies": {
    "@tailwindcss/postcss": "^4",
    "@types/node": "^20",
    "@types/react": "^19",
    "@types/react-dom": "^19",
    "lightningcss": "^1.30.1",
    "prisma": "^6.8.2",
    "tailwindcss": "^4",
    "tsx": "^4.19.4",
    "typescript": "^5"
  }
}

=== FILE: ./postcss.config.mjs ===

const config = {
  plugins: ["@tailwindcss/postcss"],
};

export default config;

=== FILE: ./prisma/migrations/20250607214445_readd_product/migration.sql ===

-- CreateTable
CREATE TABLE "Product" (
    "id" SERIAL NOT NULL,
    "name" TEXT NOT NULL,
    "description" TEXT,
    "price" INTEGER NOT NULL,
    "isPattern" BOOLEAN NOT NULL DEFAULT false,
    "imageUrl" TEXT,
    "isActive" BOOLEAN NOT NULL DEFAULT true,
    "createdAt" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
    "updateAt" TIMESTAMP(3) NOT NULL,

    CONSTRAINT "Product_pkey" PRIMARY KEY ("id")
);

-- CreateTable
CREATE TABLE "Order" (
    "id" SERIAL NOT NULL,
    "productId" INTEGER NOT NULL,
    "customerEmail" TEXT NOT NULL,
    "customNotes" TEXT,
    "createdAt" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,

    CONSTRAINT "Order_pkey" PRIMARY KEY ("id")
);

-- AddForeignKey
ALTER TABLE "Order" ADD CONSTRAINT "Order_productId_fkey" FOREIGN KEY ("productId") REFERENCES "Product"("id") ON DELETE RESTRICT ON UPDATE CASCADE;

=== FILE: ./prisma/migrations/20250608010102_add_auth_models/migration.sql ===

-- CreateTable
CREATE TABLE "User" (
    "id" TEXT NOT NULL,
    "email" TEXT NOT NULL,
    "password" TEXT NOT NULL,
    "name" TEXT,
    "role" TEXT NOT NULL DEFAULT 'user',
    "createdAt" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
    "updatedAt" TIMESTAMP(3) NOT NULL,

    CONSTRAINT "User_pkey" PRIMARY KEY ("id")
);

-- CreateIndex
CREATE UNIQUE INDEX "User_email_key" ON "User"("email");

=== FILE: ./prisma/migrations/20250619224309_updated_schema/migration.sql ===

/*
  Warnings:

  - You are about to drop the column `imageUrl` on the `Product` table. All the data in the column will be lost.

*/
-- AlterTable
ALTER TABLE "Product" DROP COLUMN "imageUrl",
ADD COLUMN     "sizeGuideId" INTEGER,
ADD COLUMN     "sizeGuideUrl" TEXT,
ADD COLUMN     "tags" TEXT[],
ADD COLUMN     "videoUrl" TEXT;

-- CreateTable
CREATE TABLE "CustomRequestLog" (
    "id" SERIAL NOT NULL,
    "customer" TEXT NOT NULL,
    "email" TEXT NOT NULL,
    "garment" TEXT NOT NULL,
    "status" TEXT NOT NULL DEFAULT 'pending',
    "createdAt" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,

    CONSTRAINT "CustomRequestLog_pkey" PRIMARY KEY ("id")
);

-- CreateTable
CREATE TABLE "SizeGuide" (
    "id" SERIAL NOT NULL,
    "name" TEXT NOT NULL,
    "tableData" JSONB NOT NULL,

    CONSTRAINT "SizeGuide_pkey" PRIMARY KEY ("id")
);

-- CreateTable
CREATE TABLE "ProductImage" (
    "id" SERIAL NOT NULL,
    "productId" INTEGER NOT NULL,
    "url" TEXT NOT NULL,
    "altText" TEXT,
    "order" INTEGER NOT NULL,

    CONSTRAINT "ProductImage_pkey" PRIMARY KEY ("id")
);

-- AddForeignKey
ALTER TABLE "Product" ADD CONSTRAINT "Product_sizeGuideId_fkey" FOREIGN KEY ("sizeGuideId") REFERENCES "SizeGuide"("id") ON DELETE SET NULL ON UPDATE CASCADE;

-- AddForeignKey
ALTER TABLE "ProductImage" ADD CONSTRAINT "ProductImage_productId_fkey" FOREIGN KEY ("productId") REFERENCES "Product"("id") ON DELETE RESTRICT ON UPDATE CASCADE;

=== FILE: ./prisma/migrations/20250623021122_updated_schema/migration.sql ===

/*
  Warnings:

  - You are about to drop the column `videoUrl` on the `Product` table. All the data in the column will be lost.
  - Added the required column `updatedAt` to the `Order` table without a default value. This is not possible if the table is not empty.

*/
-- DropForeignKey
ALTER TABLE "Order" DROP CONSTRAINT "Order_productId_fkey";

-- AlterTable
ALTER TABLE "Order" ADD COLUMN     "customOrder" JSONB,
ADD COLUMN     "customerName" TEXT,
ADD COLUMN     "designImages" TEXT,
ADD COLUMN     "isCustom" BOOLEAN NOT NULL DEFAULT false,
ADD COLUMN     "isPaid" BOOLEAN NOT NULL DEFAULT false,
ADD COLUMN     "occasion" TEXT,
ADD COLUMN     "quantity" INTEGER NOT NULL DEFAULT 1,
ADD COLUMN     "shippingAddress" TEXT,
ADD COLUMN     "status" TEXT NOT NULL DEFAULT 'pending',
ADD COLUMN     "totalPrice" INTEGER,
ADD COLUMN     "updatedAt" TIMESTAMP(3) NOT NULL,
ALTER COLUMN "productId" DROP NOT NULL;

-- AlterTable
ALTER TABLE "Product" DROP COLUMN "videoUrl";

-- AddForeignKey
ALTER TABLE "Order" ADD CONSTRAINT "Order_productId_fkey" FOREIGN KEY ("productId") REFERENCES "Product"("id") ON DELETE SET NULL ON UPDATE CASCADE;

=== FILE: ./prisma/migrations/20250623030804_updated_schema/migration.sql ===

-- AlterTable
ALTER TABLE "ProductImage" ADD COLUMN     "mediaLibraryId" INTEGER;

-- CreateTable
CREATE TABLE "MediaLibrary" (
    "id" SERIAL NOT NULL,
    "url" TEXT NOT NULL,
    "createdAt" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,

    CONSTRAINT "MediaLibrary_pkey" PRIMARY KEY ("id")
);

-- CreateIndex
CREATE UNIQUE INDEX "MediaLibrary_url_key" ON "MediaLibrary"("url");

-- AddForeignKey
ALTER TABLE "ProductImage" ADD CONSTRAINT "ProductImage_mediaLibraryId_fkey" FOREIGN KEY ("mediaLibraryId") REFERENCES "MediaLibrary"("id") ON DELETE SET NULL ON UPDATE CASCADE;

=== FILE: ./prisma/migrations/20250625012853_add_session_id_to_order/migration.sql ===

-- AlterTable
ALTER TABLE "Order" ADD COLUMN     "sessionId" TEXT;

=== FILE: ./prisma/migrations/20250626201608_add_custom_upload_flag/migration.sql ===

-- AlterTable
ALTER TABLE "MediaLibrary" ADD COLUMN     "customUpload" BOOLEAN NOT NULL DEFAULT false;

=== FILE: ./prisma/migrations/20250626210523_add_custom_upload_flag/migration.sql ===

/*
  Warnings:

  - You are about to drop the column `customUpload` on the `MediaLibrary` table. All the data in the column will be lost.

*/
-- AlterTable
ALTER TABLE "MediaLibrary" DROP COLUMN "customUpload";

=== FILE: ./prisma/migrations/20250706035116_custom_order_images/migration.sql ===

/*
  Warnings:

  - The `designImages` column on the `Order` table would be dropped and recreated. This will lead to data loss if there is data in the column.

*/
-- AlterTable
ALTER TABLE "Order" DROP COLUMN "designImages",
ADD COLUMN     "designImages" TEXT[];

=== FILE: ./prisma/migrations/20250706040444_custom_order_tweaks/migration.sql ===

/*
  Warnings:

  - You are about to drop the column `occasion` on the `Order` table. All the data in the column will be lost.
  - You are about to drop the column `sessionId` on the `Order` table. All the data in the column will be lost.

*/
-- AlterTable
ALTER TABLE "Order" DROP COLUMN "occasion",
DROP COLUMN "sessionId";

=== FILE: ./prisma/migrations/20250706041715_custom_order_tweaks2/migration.sql ===

/*
  Warnings:

  - You are about to drop the column `customNotes` on the `Order` table. All the data in the column will be lost.

*/
-- AlterTable
ALTER TABLE "Order" DROP COLUMN "customNotes";

=== FILE: ./prisma/migrations/20250715010536_cascade_delete/migration.sql ===

-- DropForeignKey
ALTER TABLE "ProductImage" DROP CONSTRAINT "ProductImage_productId_fkey";

-- AddForeignKey
ALTER TABLE "ProductImage" ADD CONSTRAINT "ProductImage_productId_fkey" FOREIGN KEY ("productId") REFERENCES "Product"("id") ON DELETE CASCADE ON UPDATE CASCADE;

=== FILE: ./prisma/migrations/20250715031358_add_pattern_file_url/migration.sql ===

-- AlterTable
ALTER TABLE "Product" ADD COLUMN     "patternFileUrl" TEXT;

=== FILE: ./prisma/migrations/20250717010736_revertchange/migration.sql ===

/*
  Warnings:

  - You are about to drop the column `patternFileUrl` on the `Product` table. All the data in the column will be lost.

*/
-- AlterTable
ALTER TABLE "Product" DROP COLUMN "patternFileUrl";

=== FILE: ./prisma/migrations/20250717012312_revertchange/migration.sql ===

-- AlterTable
ALTER TABLE "Product" ADD COLUMN     "patternURL" TEXT;

=== FILE: ./prisma/migrations/20250717023135_add_order_items/migration.sql ===

-- CreateTable
CREATE TABLE "OrderItem" (
    "id" SERIAL NOT NULL,
    "orderId" INTEGER NOT NULL,
    "productId" INTEGER NOT NULL,
    "quantity" INTEGER NOT NULL DEFAULT 1,
    "unitPrice" INTEGER NOT NULL,

    CONSTRAINT "OrderItem_pkey" PRIMARY KEY ("id")
);

-- AddForeignKey
ALTER TABLE "OrderItem" ADD CONSTRAINT "OrderItem_orderId_fkey" FOREIGN KEY ("orderId") REFERENCES "Order"("id") ON DELETE RESTRICT ON UPDATE CASCADE;

-- AddForeignKey
ALTER TABLE "OrderItem" ADD CONSTRAINT "OrderItem_productId_fkey" FOREIGN KEY ("productId") REFERENCES "Product"("id") ON DELETE RESTRICT ON UPDATE CASCADE;

=== FILE: ./prisma/migrations/20250717023723_add_order_items4/migration.sql ===

/*
  Warnings:

  - You are about to drop the column `productId` on the `Order` table. All the data in the column will be lost.

*/
-- DropForeignKey
ALTER TABLE "Order" DROP CONSTRAINT "Order_productId_fkey";

-- AlterTable
ALTER TABLE "Order" DROP COLUMN "productId";

=== FILE: ./prisma/migrations/20250717195502_droppedsizeguideurl/migration.sql ===

/*
  Warnings:

  - You are about to drop the column `sizeGuideUrl` on the `Product` table. All the data in the column will be lost.

*/
-- AlterTable
ALTER TABLE "Product" DROP COLUMN "sizeGuideUrl";

=== FILE: ./prisma/migrations/20250717222425_orderscontainuser/migration.sql ===

-- AlterTable
ALTER TABLE "Order" ADD COLUMN     "userId" TEXT;

-- AddForeignKey
ALTER TABLE "Order" ADD CONSTRAINT "Order_userId_fkey" FOREIGN KEY ("userId") REFERENCES "User"("id") ON DELETE SET NULL ON UPDATE CASCADE;

=== FILE: ./prisma/migrations/20250718190027_added_sizes_to_product/migration.sql ===

-- AlterTable
ALTER TABLE "Product" ADD COLUMN     "sizes" TEXT[];

=== FILE: ./prisma/migrations/20250718200652_/migration.sql ===

-- DropForeignKey
ALTER TABLE "OrderItem" DROP CONSTRAINT "OrderItem_productId_fkey";

-- AddForeignKey
ALTER TABLE "OrderItem" ADD CONSTRAINT "OrderItem_productId_fkey" FOREIGN KEY ("productId") REFERENCES "Product"("id") ON DELETE SET NULL ON UPDATE CASCADE;

=== FILE: ./prisma/migrations/20250718200750_haircut/migration.sql ===

-- DropForeignKey
ALTER TABLE "OrderItem" DROP CONSTRAINT "OrderItem_productId_fkey";

-- AddForeignKey
ALTER TABLE "OrderItem" ADD CONSTRAINT "OrderItem_productId_fkey" FOREIGN KEY ("productId") REFERENCES "Product"("id") ON DELETE CASCADE ON UPDATE CASCADE;

=== FILE: ./prisma/migrations/20250718200855_fairnuff/migration.sql ===

-- DropForeignKey
ALTER TABLE "OrderItem" DROP CONSTRAINT "OrderItem_productId_fkey";

-- AddForeignKey
ALTER TABLE "OrderItem" ADD CONSTRAINT "OrderItem_productId_fkey" FOREIGN KEY ("productId") REFERENCES "Product"("id") ON DELETE RESTRICT ON UPDATE CASCADE;

=== FILE: ./prisma/migrations/20250718214746_/migration.sql ===

-- AlterTable
ALTER TABLE "OrderItem" ADD COLUMN     "size" TEXT;

=== FILE: ./prisma/migrations/20250904025634_add_password_reset_fields/migration.sql ===

-- AlterTable
ALTER TABLE "User" ADD COLUMN     "resetTokenExpires" TIMESTAMP(3),
ADD COLUMN     "resetTokenHash" VARCHAR(128);

=== FILE: ./prisma/migrations/20250904035843_site_settings_singleton/migration.sql ===

/*
  Warnings:

  - A unique constraint covering the columns `[emailChangeNew]` on the table `User` will be added. If there are existing duplicate values, this will fail.

*/
-- AlterTable
ALTER TABLE "User" ADD COLUMN     "emailChangeNew" TEXT,
ADD COLUMN     "emailChangeTokenExpires" TIMESTAMP(3),
ADD COLUMN     "emailChangeTokenHash" VARCHAR(128);

-- CreateTable
CREATE TABLE "SiteSettings" (
    "id" INTEGER NOT NULL DEFAULT 1,
    "purchasingPaused" BOOLEAN NOT NULL DEFAULT false,
    "updatedAt" TIMESTAMP(3) NOT NULL,

    CONSTRAINT "SiteSettings_pkey" PRIMARY KEY ("id")
);

-- CreateIndex
CREATE UNIQUE INDEX "User_emailChangeNew_key" ON "User"("emailChangeNew");

=== FILE: ./prisma/migrations/migration_lock.toml ===

# Please do not edit this file manually
# It should be added in your version-control system (e.g., Git)
provider = "postgresql"

=== FILE: ./prisma/schema.prisma ===

// === FILE: prisma/schema.prisma
// this is the prisma schema file that defines the local database.

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
  directUrl = env("DIRECT_URL")
}

model Product {
  id           Int            @id @default(autoincrement())
  name         String
  description  String?
  price        Int
  isPattern    Boolean        @default(false)
  patternURL   String?
  images       ProductImage[]
  isActive     Boolean        @default(true)
  createdAt    DateTime       @default(now())
  updateAt     DateTime       @updatedAt
  sizeGuideId  Int?
  sizeGuide    SizeGuide?     @relation(fields: [sizeGuideId], references: [id])
  tags         String[]
  orderItems   OrderItem[]
  sizes        String[]
}

model Order {
  id        Int      @id @default(autoincrement())
  
  customerEmail   String
  customerName    String?
  shippingAddress String?

  isCustom     Boolean @default(false)
  designImages String[]
  customOrder  Json? // store as raw JSON
  status     String  @default("pending")
  isPaid     Boolean @default(false)
  totalPrice Int?
  orderItems OrderItem[]
  quantity   Int     @default(1)
  userId  String?
  user User? @relation(fields: [userId], references: [id], onDelete: SetNull)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model OrderItem {
  id        Int     @id @default(autoincrement())
  order     Order   @relation(fields: [orderId], references: [id])
  orderId   Int
  product   Product @relation(fields: [productId], references: [id])
  productId Int
  quantity  Int     @default(1)
  unitPrice Int     // Price at time of order (store for history)
  size      String?
  // Optionally, add more fields if needed (like customization info)
}

model User {
  id        String   @id @default(cuid())
  email     String   @unique
  password  String // hash this if you're doing credentials-based login
  name      String?
  role      String   @default("user") // useful for admin access
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  orders Order[]
  resetTokenHash     String?  @db.VarChar(128)
  resetTokenExpires  DateTime?
  emailChangeTokenHash  String?  @db.VarChar(128)
  emailChangeTokenExpires DateTime?
  emailChangeNew        String?  @unique
}

model CustomRequestLog {
  id        Int      @id @default(autoincrement())
  customer  String
  email     String
  garment   String
  status    String   @default("pending")
  createdAt DateTime @default(now())
}

model SizeGuide {
  id        Int       @id @default(autoincrement())
  name      String
  tableData Json // e.g. [["Size", "Bust", "Waist"], ["S", "34", "26"]]
  Product   Product[]
}

model ProductImage {
  id             Int           @id @default(autoincrement())
  product        Product       @relation(fields: [productId], references: [id], onDelete: Cascade)
  productId      Int
  url            String
  altText        String?
  order          Int //  optional, for ordering images
  MediaLibrary   MediaLibrary? @relation(fields: [mediaLibraryId], references: [id])
  mediaLibraryId Int?
}

model MediaLibrary {
  id        Int            @id @default(autoincrement())
  url       String         @unique
  createdAt DateTime       @default(now())
  usedBy    ProductImage[] // optional relation if you want
}

model SiteSettings {
  id                 Int      @id @default(1) // singleton row
  purchasingPaused   Boolean  @default(false)
  updatedAt          DateTime @updatedAt
}

=== FILE: ./prisma/seed.ts ===

// === FILE: prisma/seed.ts ===
// This file seeds the database with initial data for the size guide.

import { prisma } from '@/lib/prisma';

async function main() {
  await prisma.siteSettings.upsert({
  where: { id: 1 },
  update: {},
  create: { id: 1, purchasingPaused: false },
});
 console.log('Database has been seeded. ');
}

main().catch((e) => {
  console.error(e);
  process.exit(1);
});

=== FILE: ./public/file.svg ===

<svg fill="none" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M14.5 13.5V5.41a1 1 0 0 0-.3-.7L9.8.29A1 1 0 0 0 9.08 0H1.5v13.5A2.5 2.5 0 0 0 4 16h8a2.5 2.5 0 0 0 2.5-2.5m-1.5 0v-7H8v-5H3v12a1 1 0 0 0 1 1h8a1 1 0 0 0 1-1M9.5 5V2.12L12.38 5zM5.13 5h-.62v1.25h2.12V5zm-.62 3h7.12v1.25H4.5zm.62 3h-.62v1.25h7.12V11z" clip-rule="evenodd" fill="#666" fill-rule="evenodd"/></svg>
=== FILE: ./public/globe.svg ===

<svg fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><g clip-path="url(#a)"><path fill-rule="evenodd" clip-rule="evenodd" d="M10.27 14.1a6.5 6.5 0 0 0 3.67-3.45q-1.24.21-2.7.34-.31 1.83-.97 3.1M8 16A8 8 0 1 0 8 0a8 8 0 0 0 0 16m.48-1.52a7 7 0 0 1-.96 0H7.5a4 4 0 0 1-.84-1.32q-.38-.89-.63-2.08a40 40 0 0 0 3.92 0q-.25 1.2-.63 2.08a4 4 0 0 1-.84 1.31zm2.94-4.76q1.66-.15 2.95-.43a7 7 0 0 0 0-2.58q-1.3-.27-2.95-.43a18 18 0 0 1 0 3.44m-1.27-3.54a17 17 0 0 1 0 3.64 39 39 0 0 1-4.3 0 17 17 0 0 1 0-3.64 39 39 0 0 1 4.3 0m1.1-1.17q1.45.13 2.69.34a6.5 6.5 0 0 0-3.67-3.44q.65 1.26.98 3.1M8.48 1.5l.01.02q.41.37.84 1.31.38.89.63 2.08a40 40 0 0 0-3.92 0q.25-1.2.63-2.08a4 4 0 0 1 .85-1.32 7 7 0 0 1 .96 0m-2.75.4a6.5 6.5 0 0 0-3.67 3.44 29 29 0 0 1 2.7-.34q.31-1.83.97-3.1M4.58 6.28q-1.66.16-2.95.43a7 7 0 0 0 0 2.58q1.3.27 2.95.43a18 18 0 0 1 0-3.44m.17 4.71q-1.45-.12-2.69-.34a6.5 6.5 0 0 0 3.67 3.44q-.65-1.27-.98-3.1" fill="#666"/></g><defs><clipPath id="a"><path fill="#fff" d="M0 0h16v16H0z"/></clipPath></defs></svg>
=== FILE: ./public/next.svg ===

<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 394 80"><path fill="#000" d="M262 0h68.5v12.7h-27.2v66.6h-13.6V12.7H262V0ZM149 0v12.7H94v20.4h44.3v12.6H94v21h55v12.6H80.5V0h68.7zm34.3 0h-17.8l63.8 79.4h17.9l-32-39.7 32-39.6h-17.9l-23 28.6-23-28.6zm18.3 56.7-9-11-27.1 33.7h17.8l18.3-22.7z"/><path fill="#000" d="M81 79.3 17 0H0v79.3h13.6V17l50.2 62.3H81Zm252.6-.4c-1 0-1.8-.4-2.5-1s-1.1-1.6-1.1-2.6.3-1.8 1-2.5 1.6-1 2.6-1 1.8.3 2.5 1a3.4 3.4 0 0 1 .6 4.3 3.7 3.7 0 0 1-3 1.8zm23.2-33.5h6v23.3c0 2.1-.4 4-1.3 5.5a9.1 9.1 0 0 1-3.8 3.5c-1.6.8-3.5 1.3-5.7 1.3-2 0-3.7-.4-5.3-1s-2.8-1.8-3.7-3.2c-.9-1.3-1.4-3-1.4-5h6c.1.8.3 1.6.7 2.2s1 1.2 1.6 1.5c.7.4 1.5.5 2.4.5 1 0 1.8-.2 2.4-.6a4 4 0 0 0 1.6-1.8c.3-.8.5-1.8.5-3V45.5zm30.9 9.1a4.4 4.4 0 0 0-2-3.3 7.5 7.5 0 0 0-4.3-1.1c-1.3 0-2.4.2-3.3.5-.9.4-1.6 1-2 1.6a3.5 3.5 0 0 0-.3 4c.3.5.7.9 1.3 1.2l1.8 1 2 .5 3.2.8c1.3.3 2.5.7 3.7 1.2a13 13 0 0 1 3.2 1.8 8.1 8.1 0 0 1 3 6.5c0 2-.5 3.7-1.5 5.1a10 10 0 0 1-4.4 3.5c-1.8.8-4.1 1.2-6.8 1.2-2.6 0-4.9-.4-6.8-1.2-2-.8-3.4-2-4.5-3.5a10 10 0 0 1-1.7-5.6h6a5 5 0 0 0 3.5 4.6c1 .4 2.2.6 3.4.6 1.3 0 2.5-.2 3.5-.6 1-.4 1.8-1 2.4-1.7a4 4 0 0 0 .8-2.4c0-.9-.2-1.6-.7-2.2a11 11 0 0 0-2.1-1.4l-3.2-1-3.8-1c-2.8-.7-5-1.7-6.6-3.2a7.2 7.2 0 0 1-2.4-5.7 8 8 0 0 1 1.7-5 10 10 0 0 1 4.3-3.5c2-.8 4-1.2 6.4-1.2 2.3 0 4.4.4 6.2 1.2 1.8.8 3.2 2 4.3 3.4 1 1.4 1.5 3 1.5 5h-5.8z"/></svg>
=== FILE: ./public/SisBG.jpg ===
=== FILE: ./public/vercel.svg ===

<svg fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1155 1000"><path d="m577.3 0 577.4 1000H0z" fill="#fff"/></svg>
=== FILE: ./public/window.svg ===

<svg fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path fill-rule="evenodd" clip-rule="evenodd" d="M1.5 2.5h13v10a1 1 0 0 1-1 1h-11a1 1 0 0 1-1-1zM0 1h16v11.5a2.5 2.5 0 0 1-2.5 2.5h-11A2.5 2.5 0 0 1 0 12.5zm3.75 4.5a.75.75 0 1 0 0-1.5.75.75 0 0 0 0 1.5M7 4.75a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0m1.75.75a.75.75 0 1 0 0-1.5.75.75 0 0 0 0 1.5" fill="#666"/></svg>
=== FILE: ./README.md ===

This is a [Next.js](https://nextjs.org) project bootstrapped with [`create-next-app`](https://nextjs.org/docs/app/api-reference/cli/create-next-app).

## Getting Started

First, run the development server:

```bash
npm run dev
# or
yarn dev
# or
pnpm dev
# or
bun dev
```

Open [http://localhost:3000](http://localhost:3000) with your browser to see the result.

You can start editing the page by modifying `app/page.tsx`. The page auto-updates as you edit the file.

This project uses [`next/font`](https://nextjs.org/docs/app/building-your-application/optimizing/fonts) to automatically optimize and load [Geist](https://vercel.com/font), a new font family for Vercel.

## Learn More

To learn more about Next.js, take a look at the following resources:

- [Next.js Documentation](https://nextjs.org/docs) - learn about Next.js features and API.
- [Learn Next.js](https://nextjs.org/learn) - an interactive Next.js tutorial.

You can check out [the Next.js GitHub repository](https://github.com/vercel/next.js) - your feedback and contributions are welcome!

## Deploy on Vercel

The easiest way to deploy your Next.js app is to use the [Vercel Platform](https://vercel.com/new?utm_medium=default-template&filter=next.js&utm_source=create-next-app&utm_campaign=create-next-app-readme) from the creators of Next.js.

Check out our [Next.js deployment documentation](https://nextjs.org/docs/app/building-your-application/deploying) for more details.

src/
 app/               # Routes
    page.tsx       # Home page
    admin/         # Admin panel routes
    products/      # Product display
 components/        # Reusable UI components
 lib/               # Utility functions (e.g. stripe.ts, email.ts)
 styles/            # Tailwind + custom CSS
 types/             # TypeScript interfaces and types
 data/              # Temporary mock data (replace with DB later)
 config/            # Configs like SEO, env constants, etc.


|                              | Server Component (default) | Client Component (`'use client'`) |
| ---------------------------: | -------------------------- | --------------------------------- |
|                   Runs on... | Server                     | Browser                           |
| Use `useState`, `useEffect`? |                           |                                  |
| Access cookies, DB, secrets? |                           |                                  |
| Needs `'use client'` at top? |                           |                                  |
|                     Examples | ProductPage, API route     | Buttons, forms, cart UI           |


layout.tsx auto-wraps everything

page.tsx gets inserted as {children}

Nav.tsx is a child of layout.tsx and shows on every page

Middleware Use Cases

    File: src/middleware.ts

    Runs before route is rendered

    Good for:

        Redirecting from /admin if not logged in

        Checking cookies / session auth

    Not needed for Stripe, API routes, or general content

export const config = {
  matcher: ['/admin/:path*'],
};

 Auth Strategy

    Store session/token in a cookie

    Middleware checks it

    Server routes use it to validate user

    Avoid calling client-side functions in server logic

    
 Dev Tips

    Use server components by default  faster, more SEO-friendly

    Only use 'use client' when absolutely necessary

    Dont import functions from client components into server logic

    Keep logic separate:

        /components/client/ for UI

        /lib/ for DB/API helpers

        /app/api/ for secure server-side handlers
 reverse
 vercel push
=== FILE: ./src/app/admin/components/AddProductForm.tsx ===

// === FILE: src/app/admin/components/AddProductForm.tsx ===
// This file contains the form for adding a new product in the admin panel.

"use client";

import { useState, useEffect } from "react";
import UploadButton from "@/components/UploadButton";
import MediaLibraryPicker from "@/components/MediaLibraryPicker";
import { UploadDropzone } from "@/utils/uploadthing";

export default function AddProductForm({
  onProductAdded,
}: {
  onProductAdded: () => void;
}) {
  const [patternPdfUrl, setPatternPdfUrl] = useState<string | null>(null);
  const [name, setName] = useState("");
  const [price, setPrice] = useState("");
  const [description, setDescription] = useState("");
  const [tags, setTags] = useState<string[]>([]);
  const [images, setImages] = useState<string[]>([]);
  const [imageInput, setImageInput] = useState("");
  const [sizes, setSizes] = useState<string>("");
  const [sizeGuideId, setSizeGuideId] = useState<number | "">("");
  const [sizeGuides, setSizeGuides] = useState<{ id: number; name: string }[]>(
    []
  );
  const [isPattern, setIsPattern] = useState(false);
  const [isActive, setIsActive] = useState(true);
  const [loading, setLoading] = useState(false);
  const [error, setError] = useState("");
  const [success, setSuccess] = useState(false);
  const ALLOWED_TAGS = [
    "dress",
    "top",
    "bottom",
    "set",
    "outerwear",
    "accessories",
    "pattern",
  ];

  useEffect(() => {
    fetch("/api/admin/size-guides")
      .then((res) => res.json())
      .then(setSizeGuides)
      .catch(() => setSizeGuides([]));
  }, []);

  const handleSubmit = async (e: React.FormEvent) => {
    e.preventDefault();
    setLoading(true);
    setError("");
    setSuccess(false);

    const sizesArray = sizes
      .split(/[,\s]+/)
      .map((s) => s.trim())
      .filter(Boolean);

    try {
      const res = await fetch("/api/admin/products", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({
          name,
          price: parseInt(price),
          description,
          tags,
          sizeGuideId: isPattern ? undefined : sizeGuideId || undefined,
          images: images.map((url, index) => ({ url, order: index })),
          isPattern,
          isActive,
          sizes: isPattern ? [] : sizesArray,
          patternPdfUrl: isPattern ? patternPdfUrl : null,
        }),
      });

      if (!res.ok) throw new Error("Failed to add product");

      setSuccess(true);
      onProductAdded();
      setName("");
      setPrice("");
      setDescription("");
      setTags([]);
      setSizeGuideId("");
      setImages([]);
      setIsPattern(false);
      setIsActive(true);
    } catch (err: any) {
      setError(err.message);
    } finally {
      setLoading(false);
    }
  };

  const addImage = () => {
    if (imageInput.trim()) {
      setImages((prev) => [...prev, imageInput.trim()]);
      setImageInput("");
    }
  };

  const removeImage = (url: string) => {
    setImages((prev) => prev.filter((img) => img !== url));
  };

  return (
    <form onSubmit={handleSubmit} className="mb-6 border rounded p-4">
      <h2 className="text-lg font-bold mb-2">Add New Product</h2>

      {error && <p className="text-red-600 mb-2">{error}</p>}
      {success && <p className="text-green-600 mb-2">Product added!</p>}

      <div className="grid grid-cols-1 sm:grid-cols-2 gap-4">
        <input
          type="text"
          placeholder="Product Name"
          required
          value={name}
          onChange={(e) => setName(e.target.value)}
          className="border p-2 rounded"
        />
        <input
          type="number"
          placeholder="Price in cents"
          required
          value={price}
          onChange={(e) => setPrice(e.target.value)}
          className="border p-2 rounded"
        />
        <textarea
          placeholder="Description"
          value={description}
          onChange={(e) => setDescription(e.target.value)}
          className="border p-2 rounded col-span-full"
        />
        <label className="block font-medium mb-1 col-span-full">
          Tags (hold Ctrl/Cmd to select multiple)
        </label>
        <select
          multiple
          value={tags}
          onChange={(e) => {
            // Changed: Handle multi-select array
            const selected = Array.from(e.target.selectedOptions).map(
              (opt) => opt.value
            );
            setTags(selected);
          }}
          className="border p-2 rounded col-span-full"
          required
        >
          {ALLOWED_TAGS.map((tag) => (
            <option key={tag} value={tag}>
              {tag.charAt(0).toUpperCase() + tag.slice(1)}
            </option>
          ))}
        </select>

        <div className="mb-2">
          <label className="block mb-1 font-medium">
            Sizes (comma or space separated)
          </label>
          {!isPattern && (
            <input
              className="border p-2 rounded"
              placeholder="Sizes e.g. XS, S, M, L"
              value={sizes}
              onChange={(e) => setSizes(e.target.value)}
            />
          )}
        </div>

        <div className="col-span-full">
          <label className="block font-medium mb-1">Images</label>

          <UploadButton
            onUploadComplete={(urls) => {
              setImages((prev) => [...prev, ...urls]);
            }}
          />
          {images.length > 0 && (
            <ul className="list-disc pl-5 mt-2">
              {images.map((url, i) => (
                <li
                  key={i}
                  className="flex justify-between items-center text-sm mb-1"
                >
                  <span className="truncate max-w-xs">{url}</span>
                  <button
                    type="button"
                    onClick={() =>
                      setImages((prev) => prev.filter((img) => img !== url))
                    }
                    className="text-red-500 ml-2 text-xs"
                  >
                    Remove
                  </button>
                </li>
              ))}
            </ul>
          )}
        </div>
        <div className="mt-4">
          <p className="font-medium mb-1">Or select from existing images:</p>
          <MediaLibraryPicker
            onSelect={(url) => {
              setImages((prev) => [...prev, url]);
            }}
          />
        </div>

        {!isPattern && (
          <select
            value={sizeGuideId}
            onChange={(e) =>
              setSizeGuideId(e.target.value ? parseInt(e.target.value) : "")
            }
            className="border p-2 rounded col-span-full"
          >
            <option value="">No Size Guide</option>
            {sizeGuides.map((g) => (
              <option key={g.id} value={g.id}>
                {g.name}
              </option>
            ))}
          </select>
        )}

        <label className="flex items-center gap-2">
          <input
            type="checkbox"
            checked={isPattern}
            onChange={(e) => setIsPattern(e.target.checked)}
          />{" "}
          Is Pattern
        </label>
        {isPattern && (
          <div className="col-span-full">
            <label className="block font-medium mb-1">Pattern PDF</label>
            <UploadDropzone
              endpoint="productImage"
              onClientUploadComplete={(res) => {
                const url = res[0]?.url;
                if (url) setPatternPdfUrl(url);
              }}
              onUploadError={(err) => alert(`Upload failed: ${err.message}`)}
              appearance={{
                container:
                  "border border-dashed border-gray-400 p-4 rounded-md w-full max-w-md mx-auto",
                uploadIcon: "w-10 h-10 text-gray-500 mx-auto",
                label: "text-center text-sm text-gray-600 mt-2",
                button:
                  "mt-4 bg-black text-white px-4 py-2 rounded hover:bg-gray-800 cursor-pointer",
              }}
            />
            {patternPdfUrl && (
              <div className="mt-2 text-sm text-green-700">
                 Uploaded:{" "}
                <a href={patternPdfUrl} target="_blank" className="underline">
                  {patternPdfUrl}
                </a>
              </div>
            )}
          </div>
        )}
        <label className="flex items-center gap-2">
          <input
            type="checkbox"
            checked={isActive}
            onChange={(e) => setIsActive(e.target.checked)}
          />{" "}
          Is Active
        </label>
      </div>

      <button
        type="submit"
        disabled={loading}
        className="mt-4 bg-black text-white px-4 py-2 rounded hover:bg-gray-800 disabled:opacity-50"
      >
        {loading ? "Adding..." : "Add Product"}
      </button>
    </form>
  );
}

=== FILE: ./src/app/admin/components/AddSizeGuideForm.tsx ===

// === FILE: src/app/admin/size-guides/AddSizeGuideForm.tsx ===

'use client';

import { useState } from "react";

// Props: onGuideAdded callback to refresh parent list
export default function AddSizeGuideForm({ onGuideAdded }: { onGuideAdded: () => void }) {
  const [name, setName] = useState("");
  const [csvText, setCsvText] = useState(""); // For quick Excel-like copy/paste
  const [loading, setLoading] = useState(false);
  const [error, setError] = useState("");
  const [success, setSuccess] = useState(false);

  // Utility: Parse CSV/TSV string into array of arrays
  function parseCsv(text: string): string[][] {
    return text
      .trim()
      .split("\n")
      .map(row => row.split(/,|\t/).map(cell => cell.trim()));
  }

  async function handleSubmit(e: React.FormEvent) {
    e.preventDefault();
    setError("");
    setSuccess(false);

    const tableData = parseCsv(csvText);
    if (!name || tableData.length < 1 || tableData[0].length < 2) {
      setError("Please enter a name and a valid table (at least 2 columns).");
      return;
    }

    setLoading(true);
    try {
      const res = await fetch("/api/admin/size-guides", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ name, tableData }),
      });

      if (!res.ok) throw new Error("Failed to add size guide.");
      setSuccess(true);
      setName("");
      setCsvText("");
      onGuideAdded();
    } catch (err: any) {
      setError(err.message || "Unknown error.");
    } finally {
      setLoading(false);
    }
  }

  return (
    <form onSubmit={handleSubmit} className="mb-8 border rounded p-4 bg-white text-black">
      <h2 className="text-lg font-bold mb-2">Add New Size Guide</h2>
      {error && <p className="text-red-600 mb-2">{error}</p>}
      {success && <p className="text-green-600 mb-2">Added!</p>}

      <div className="mb-2">
        <label className="block mb-1 font-medium">Guide Name</label>
        <input
          className="border rounded w-full p-2"
          value={name}
          onChange={e => setName(e.target.value)}
          required
        />
      </div>

      <div className="mb-2">
        <label className="block mb-1 font-medium">
          Table Data (CSV/TSV: Size,Bust,Waist...  copy-paste from Excel works)
        </label>
        <textarea
          className="border rounded w-full p-2 font-mono text-sm"
          rows={5}
          value={csvText}
          onChange={e => setCsvText(e.target.value)}
          placeholder={"Size,Bust,Waist\nS,32,24\nM,34,26"}
          required
        />
      </div>

      <button
        className="mt-2 bg-black text-white px-4 py-2 rounded hover:bg-gray-800 disabled:opacity-50"
        type="submit"
        disabled={loading}
      >
        {loading ? "Adding..." : "Add Size Guide"}
      </button>
    </form>
  );
}

=== FILE: ./src/app/admin/components/ProductTable.tsx ===

// === FILE: src/app/admin/components/ProductTable.tsx ===
// This file displays a table of products in the admin panel, allowing for editing and deletion.

"use client";

import { useEffect, useState } from "react";
import { useSession } from "next-auth/react";

interface ProductImage {
  id?: number;
  url: string;
  altText?: string;
  order?: number;
}

interface Product {
  id: number;
  name: string;
  description?: string;
  price: number;
  isPattern: boolean;
  isActive: boolean;
  tags: string[];
  sizeGuideId?: number;
  createdAt: string;
  updateAt: string;
  images: ProductImage[];
  sizes: string[];
}

export default function ProductTable() {
  const { data: session, status } = useSession();
  const [products, setProducts] = useState<Product[]>([]);
  const [loading, setLoading] = useState(true);
  const [error, setError] = useState("");
  const [sizeGuides, setSizeGuides] = useState<{ id: number; name: string }[]>(
    []
  );

  useEffect(() => {
    const fetchData = async () => {
      try {
        const productsRes = await fetch("/api/admin/products");
        if (!productsRes.ok) throw new Error("Failed to fetch products");

        const guidesRes = await fetch("/api/admin/size-guides");
        if (!guidesRes.ok) throw new Error("Failed to fetch size guides");

        const [productsData, guidesData] = await Promise.all([
          productsRes.json(),
          guidesRes.json(),
        ]);

        setProducts(productsData);
        setSizeGuides(guidesData);
      } catch (err: any) {
        setError(err.message);
      } finally {
        setLoading(false);
      }
    };

    fetchData();
  }, []);

  const handleDelete = async (id: number) => {
    if (!confirm("Are you sure you want to delete this product?")) return;
    try {
      const res = await fetch(`/api/admin/products/${id}`, {
        method: "DELETE",
      });
      if (!res.ok) throw new Error("Failed to delete product");
      setProducts((prev) => prev.filter((p) => p.id !== id));
    } catch (err: any) {
      alert(err.message);
    }
  };

  const handleSave = async (product: Product) => {
    try {
      const res = await fetch(`/api/admin/products/${product.id}`, {
        method: "PUT",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(product),
      });
      if (!res.ok) throw new Error("Failed to save changes");
      alert("Product updated!");
    } catch (err: any) {
      alert(err.message);
    }
  };

  if (status === "loading" || loading) return <p>Loading products</p>;
  if (error) return <p className="text-red-600">Error: {error}</p>;

  return (
    <div className="overflow-x-auto mt-6">
      <table className="min-w-full border border-gray-300">
        <thead>
          <tr className="text-left text-sm">
            <th className="px-4 py-2 border">Name</th>
            <th className="px-4 py-2 border">Price ($)</th>
            <th className="px-4 py-2 border">Active</th>
            <th className="px-4 py-2 border">Pattern</th>
            <th className="px-4 py-2 border">Tags</th>
            <th className="px-4 py-2 border">Sizes</th>
            <th className="px-4 py-2 border">Size Guide</th>
            <th className="px-4 py-2 border">Images</th>
            <th className="px-4 py-2 border">Actions</th>
          </tr>
        </thead>
        <tbody>
          {products.map((product) => (
            <tr key={product.id} className="text-sm hover:bg-gray-50">
              <td className="px-4 py-2 border">
                <input
                  className="w-full border p-1"
                  value={product.name}
                  onChange={(e) =>
                    setProducts((prev) =>
                      prev.map((p) =>
                        p.id === product.id ? { ...p, name: e.target.value } : p
                      )
                    )
                  }
                />
              </td>
              <td className="px-4 py-2 border">
                <input
                  type="number"
                  className="w-full border p-1"
                  value={(product.price / 100).toFixed(2)}
                  onChange={(e) =>
                    setProducts((prev) =>
                      prev.map((p) =>
                        p.id === product.id
                          ? {
                              ...p,
                              price: Math.round(
                                parseFloat(e.target.value) * 100
                              ),
                            }
                          : p
                      )
                    )
                  }
                />
              </td>
              <td className="px-4 py-2 border text-center">
                <input
                  type="checkbox"
                  checked={product.isActive}
                  onChange={(e) =>
                    setProducts((prev) =>
                      prev.map((p) =>
                        p.id === product.id
                          ? { ...p, isActive: e.target.checked }
                          : p
                      )
                    )
                  }
                />
              </td>
              <td className="px-4 py-2 border text-center">
                <input
                  type="checkbox"
                  checked={product.isPattern}
                  onChange={(e) =>
                    setProducts((prev) =>
                      prev.map((p) =>
                        p.id === product.id
                          ? { ...p, isPattern: e.target.checked }
                          : p
                      )
                    )
                  }
                />
              </td>
              <td className="px-4 py-2 border">
                <input
                  className="w-full border p-1"
                  value={product.tags.join(", ")}
                  onChange={(e) =>
                    setProducts((prev) =>
                      prev.map((p) =>
                        p.id === product.id
                          ? {
                              ...p,
                              tags: e.target.value
                                .split(",")
                                .map((tag) => tag.trim()),
                            }
                          : p
                      )
                    )
                  }
                />
              </td>

              <td className="px-2 py-2 border-b text-sm">
                {Array.isArray(product.sizes) && product.sizes.length > 0 ? (
                  product.sizes.join(", ")
                ) : (
                  <span className="text-gray-400"></span>
                )}
              </td>

              <td className="px-4 py-2 border">
                <select
                  className="w-full border p-1"
                  value={product.sizeGuideId || ""}
                  onChange={(e) =>
                    setProducts((prev) =>
                      prev.map((p) =>
                        p.id === product.id
                          ? {
                              ...p,
                              sizeGuideId:
                                parseInt(e.target.value) || undefined,
                            }
                          : p
                      )
                    )
                  }
                >
                  <option value="">None</option>
                  {sizeGuides.map((guide) => (
                    <option key={guide.id} value={guide.id}>
                      {guide.name}
                    </option>
                  ))}
                </select>
              </td>
              <td className="px-4 py-2 border">
                <ul className="space-y-1 max-w-[150px]">
                  {product.images.map((img, i) => (
                    <li key={i} className="text-xs truncate text-blue-600">
                      <a href={img.url} target="_blank" rel="noreferrer">
                        {img.url}
                      </a>
                    </li>
                  ))}
                </ul>
              </td>
              <td className="px-4 py-2 border whitespace-nowrap">
                <button
                  onClick={() => handleDelete(product.id)}
                  className="text-red-600 hover:underline"
                >
                  Delete
                </button>
                <button
                  onClick={() => handleSave(product)}
                  className="text-blue-600 hover:underline ml-4"
                >
                  Save
                </button>
              </td>
            </tr>
          ))}
        </tbody>
      </table>
    </div>
  );
}

=== FILE: ./src/app/admin/components/sizeGuideTable.tsx ===

// === FILE: src/app/admin/size-guides/SizeGuideTable.tsx ===

"use client";

import { useEffect, useState } from "react";

interface SizeGuide {
  id: number;
  name: string;
  tableData: string[][];
}

export default function SizeGuideTable({
  refreshKey = 0,
}: {
  refreshKey?: number;
}) {
  const [guides, setGuides] = useState<SizeGuide[]>([]);
  const [loading, setLoading] = useState(true);
  const [error, setError] = useState("");

  useEffect(() => {
    setLoading(true);
    fetch("/api/admin/size-guides")
      .then((res) => res.json())
      .then((data) => {
        console.log("Fetched size guides:", data); // LOG full data
        setGuides(Array.isArray(data) ? data : []);
        setError("");
      })
      .catch((err) => {
        setError("Failed to fetch size guides.");
        console.error("Fetch error:", err); // LOG fetch error
      })
      .finally(() => setLoading(false));
  }, [refreshKey]);

  if (loading) return <p>Loading size guides</p>;
  if (error) return <p className="text-red-600">{error}</p>;
  if (!guides.length) return <p>No size guides found.</p>;

  return (
    <div>
      <h2 className="text-lg font-bold mb-3">Existing Size Guides</h2>
      <div className="space-y-8">
        {guides.map((guide) => (
          <div key={guide.id} className="border rounded p-4 bg-gray-50">
            <div className="flex items-center gap-4 mb-2">
              <span className="font-bold text-gray-800">{guide.name}</span>
              <span className="text-xs text-gray-400">ID: {guide.id}</span>
            </div>
            {/* Preview the first 4 rows of the table */}
            <div className="overflow-x-auto">
              <table className="min-w-max border border-gray-800 bg-white text-sm">
                <tbody>
                  {(() => {
                    console.log("Guide:", guide);
                    console.log(
                      "Guide.tableData type:",
                      typeof guide.tableData,
                      "Value:",
                      guide.tableData
                    );
                    if (
                      Array.isArray(guide.tableData) &&
                      guide.tableData.length > 0
                    ) {
                      return guide.tableData.slice(0, 4).map((row, i) => (
                        <tr key={i}>
                          {row.map((cell, j) => (
                            <td key={j} className="border px-2 py-1 text-gray-800">
                              {cell}
                            </td>
                          ))}
                        </tr>
                      ));
                    } else {
                      return (
                        <tr>
                          <td className="text-gray-80 italic border px-2 py-1">
                            No table data
                          </td>
                        </tr>
                      );
                    }
                  })()}
                  {/* ...and your more-rows logic below */}
                </tbody>
              </table>
            </div>
          </div>
        ))}
      </div>
    </div>
  );
}

=== FILE: ./src/app/admin/orders/page.tsx ===

// === FILE: src/app/admin/orders/page.tsx ===

// This file displays the admin orders page where admins can view and manage customer orders.

"use client";

import { useEffect, useState } from "react";

interface OrderItem {
  id: number;
  product?: {
    name: string;
  };
  quantity: number;
  unitPrice: number;
  size?: string;
}

interface Order {
  id: number;
  customerEmail: string;
  customerName?: string;
  totalPrice: number;
  status: string;
  isCustom: boolean;
  sessionId?: string;
  createdAt: string;
  orderItems: OrderItem[];
}

export default function AdminOrdersPage() {
  const [orders, setOrders] = useState<Order[]>([]);
  const [loading, setLoading] = useState(true);
  const [error, setError] = useState("");

  useEffect(() => {
    const fetchOrders = async () => {
      try {
        const res = await fetch("/api/admin/orders");
        if (!res.ok) throw new Error("Failed to fetch orders");
        const data = await res.json();
        setOrders(data);
      } catch (err: any) {
        setError(err.message);
      } finally {
        setLoading(false);
      }
    };

    fetchOrders();
  }, []);

  const handleStatusChange = async (orderId: number, status: string) => {
    try {
      const res = await fetch(`/api/admin/orders/${orderId}`, {
        method: "PUT",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ status }),
      });
      if (!res.ok) throw new Error("Failed to update status");
      setOrders(prev => prev.map(o => o.id === orderId ? { ...o, status } : o));
    } catch (err) {
      alert("Failed to update status");
    }
  };

  if (loading) return <p>Loading orders</p>;
  if (error) return <p className="text-red-600">Error: {error}</p>;

  return (
    <div className="max-w-5xl mx-auto p-8">
      <h1 className="text-3xl font-bold mb-8">Admin: Orders</h1>
      <table className="w-full border-collapse bg-white shadow rounded-xl overflow-hidden">
        <thead>
          <tr className="bg-gray-100">
            <th className="p-3 text-left">Order #</th>
            <th className="p-3 text-left">Date</th>
            <th className="p-3 text-left">Customer</th>
            <th className="p-3 text-left">Email</th>
            <th className="p-3 text-left">Items</th>
            <th className="p-3 text-left">Total</th>
            <th className="p-3 text-left">Status</th>
          </tr>
        </thead>
        <tbody>
          {orders.length === 0 ? (
            <tr>
              <td colSpan={7} className="text-center py-10 text-gray-500">
                No orders found.
              </td>
            </tr>
          ) : (
            orders.map(order => (
              <tr key={order.id} className="border-b">
                <td className="p-3 font-mono">{order.id}</td>
                <td className="p-3">
                  {order.createdAt
                    ? new Date(order.createdAt).toLocaleDateString()
                    : "-"}
                </td>
                <td className="p-3">{order.customerName || "-"}</td>
                <td className="p-3">{order.customerEmail}</td>
                <td className="p-3">
                  <ul>
                    {order.orderItems.map(item => (
                      <li key={item.id} className="mb-1">
                        <span className="font-medium">{item.product?.name || "Deleted Product"}</span>
                        {" "}
                        <span className="ml-1">{item.quantity}</span>
                        {item.size && (
                          <span className="ml-2 text-xs px-2 py-1 bg-gray-200 rounded font-mono">
                            Size: {item.size}
                          </span>
                        )}
                        <span className="ml-3 text-gray-400 text-xs">
                          (${(item.unitPrice / 100).toFixed(2)} each)
                        </span>
                      </li>
                    ))}
                  </ul>
                </td>
                <td className="p-3 font-semibold">${(order.totalPrice / 100).toFixed(2)}</td>
                <td className="p-3">
                  <select
                    className="border rounded px-2 py-1"
                    value={order.status}
                    onChange={e => handleStatusChange(order.id, e.target.value)}
                  >
                    {["paid", "in_progress", "in_transit", "delivered", "cancelled"].map(status => (
                      <option key={status} value={status}>{status}</option>
                    ))}
                  </select>
                </td>
              </tr>
            ))
          )}
        </tbody>
      </table>
    </div>
  );
}

=== FILE: ./src/app/admin/page.tsx ===

// === FILE: src/app/admin/page.tsx ===
// Admin dashboard with inline "Pause purchasing" control (client-only)

"use client";

import { useEffect, useState } from "react";
import ProductTable from "./components/ProductTable";
import AddProductForm from "./components/AddProductForm";

export default function AdminDashboard() {
  const [refreshKey, setRefreshKey] = useState(0);
  const [paused, setPaused] = useState(false);
  const [loading, setLoading] = useState(false);

  // Load current flag on mount
  useEffect(() => {
    let alive = true;
    (async () => {
      try {
        console.log("NEXT_PUBLIC_BASE_URL:", process.env.NEXT_PUBLIC_BASE_URL);
        const res = await fetch("/api/public/site-flags", {
          cache: "no-store",
        });
        if (!res.ok) throw new Error(`site-flags ${res.status}`);
        const ct = res.headers.get("content-type") || "";
        if (!ct.includes("application/json"))
          throw new Error(`Expected JSON, got ${ct}`);
        const data = await res.json();
        if (alive) setPaused(!!data.purchasingPaused);
      } catch {
        if (alive) setPaused(false);
      }
    })();
    return () => {
      alive = false;
    };
  }, []);

  // Toggle via admin API
  const togglePause = async () => {
    setLoading(true);
    try {
      const res = await fetch("/api/admin/site-flags", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ purchasingPaused: !paused }),
      });
      if (!res.ok) {
        // optional: surface error to user
        return;
      }
      setPaused(!paused);
    } finally {
      setLoading(false);
    }
  };

  return (
    <div className="p-6">
      <h1 className="text-2xl font-bold mb-4 mt-20">Admin Panel</h1>

      {/* Inline pause/resume card */}
      <div className="border rounded-xl shadow p-5 mb-6">
        <h2 className="text-lg font-semibold mb-2">Purchasing</h2>
        <p className="text-sm text-gray-600 mb-4">
          Status:{" "}
          <span className="font-medium">{paused ? "Paused" : "Active"}</span>
        </p>
        <button
          onClick={togglePause}
          disabled={loading}
          className="bg-black text-white rounded px-4 py-2 disabled:opacity-50"
        >
          {paused
            ? loading
              ? "Resuming"
              : "Resume purchasing"
            : loading
              ? "Pausing"
              : "Pause purchasing"}
        </button>
      </div>

      <AddProductForm onProductAdded={() => setRefreshKey((k) => k + 1)} />
      <ProductTable key={refreshKey} />
    </div>
  );
}

=== FILE: ./src/app/admin/size-guide/page.tsx ===

// === FILE: src/app/admin/size-guides/page.tsx ===

'use client';

import { useState } from "react";
import AddSizeGuideForm from "../components/AddSizeGuideForm";
import SizeGuideTable from "../components/sizeGuideTable";

export default function AdminSizeGuidesPage() {
  // Used to trigger table refresh when a guide is added
  const [refreshKey, setRefreshKey] = useState(0);

  return (
    <div className="p-8 mt-40">
      <h1 className="text-2xl font-bold mb-6">Admin: Size Guides</h1>
      
      {/* Add Size Guide form, triggers refresh on add */}
      <AddSizeGuideForm onGuideAdded={() => setRefreshKey(k => k + 1)} />

      {/* Table of existing guides, re-fetches when refreshKey changes */}
      <SizeGuideTable refreshKey={refreshKey} />
    </div>
  );
}

=== FILE: ./src/app/api/admin/orders/route.ts ===

// === FILE: src/app/api/admin/orders/route.ts ===
// This file handles the API route for fetching all orders in the admin panel.

import { NextResponse } from "next/server";
import { prisma } from "@/lib/prisma";
import { getServerSession } from "next-auth";
import { authOptions } from "@/lib/auth";


export async function GET() {
  const session = await getServerSession(authOptions);

  if (!session || session.user.role !== "admin") {
    return NextResponse.json({ error: "Unauthorized" }, { status: 403 });
  }

  // Changed: Include orderItems and each associated product
  const orders = await prisma.order.findMany({
    orderBy: { createdAt: "desc" },
    include: {
      orderItems: {
        include: { product: { select: { name: true } } },
      },
    },
  });

  // Map each order to list of product names
  const result = orders.map((order) => ({
    ...order,
    products: order.orderItems.map((item) => ({
      name: item.product?.name || "[Deleted Product]",
      quantity: item.quantity,
    })),
  }));

  return NextResponse.json(result);
}

=== FILE: ./src/app/api/admin/orders/[id]/route.ts ===

// === FILE: src/app/api/admin/orders/[id]/route.ts ===
// This file handles the API route for updating an order's status in the admin panel.

import { prisma } from '@/lib/prisma';
import { NextResponse } from 'next/server';
import { getServerSession } from 'next-auth';
import { authOptions } from '@/lib/auth';

export async function PUT(
  req: Request,
  context: { params: Promise<{ id: string }> }
) {
  // Await the params promise
  const { params } = context;
  const { id: idStr } = await params;

  const session = await getServerSession(authOptions);
  if (!session || session.user.role !== 'admin') {
    return NextResponse.json({ error: 'Unauthorized' }, { status: 403 });
  }

  const orderId = parseInt(idStr, 10);
  if (isNaN(orderId)) {
    return NextResponse.json({ error: 'Invalid ID' }, { status: 400 });
  }

  const { status } = await req.json();
  const validStatuses = ['paid','in_progress','in_transit','delivered','cancelled'];
  if (!validStatuses.includes(status)) {
    return NextResponse.json({ error: 'Invalid status' }, { status: 400 });
  }

  const updated = await prisma.order.update({
    where: { id: orderId },
    data: { status },
  });

  return NextResponse.json(updated);
}

=== FILE: ./src/app/api/admin/products/route.ts ===

// === FILE: src/app/api/admin/products/route.ts ===
// This file handles the API routes for managing products in the admin panel.

import { NextRequest, NextResponse } from "next/server";
import { getServerSession } from "next-auth";
import { authOptions } from "@/lib/auth"; // Make sure this path is correct based on your project
import { prisma } from "@/lib/prisma"; // Singleton Prisma client

// GET: Return all products for the admin panel
export async function GET(req: NextRequest) {
  const session = await getServerSession(authOptions);

  // Only allow admins to access this endpoint
  if (!session || session.user.role !== "admin") {
    return NextResponse.json({ error: "Unauthorized" }, { status: 401 });
  }

  try {
    const products = await prisma.product.findMany({
      orderBy: { updateAt: "desc" },
      include: {
        images: true,
        sizeGuide: true,
      },
    });

    return NextResponse.json(products);
  } catch (error) {
    console.error("Error fetching products:", error);
    return NextResponse.json(
      { error: "Internal Server Error" },
      { status: 500 }
    );
  }
}

export async function POST(req: NextRequest) {
  const session = await getServerSession(authOptions);

  if (!session || session.user.role !== 'admin') {
    return NextResponse.json({ error: 'Unauthorized' }, { status: 401 });
  }

  try {
    const body = await req.json();
    const {
      name,
      description,
      price,
      isPattern = false,
      isActive = true,
      tags,
      sizeGuideId,
      images = [],
      patternPdfUrl, 
    } = body;

    if (!name || typeof price !== 'number') {
      return NextResponse.json({ error: 'Missing or invalid fields' }, { status: 400 });
    }

    // Normalize tags to an array of strings
    let tagsArray: string[] = [];
    if (Array.isArray(tags)) {
      tagsArray = tags.map(tag => tag.trim().toLowerCase()).filter(Boolean);
    } else if (typeof tags === "string") {
      tagsArray = tags
        .split(",")
        .map(tag => tag.trim().toLowerCase())
        .filter(Boolean);
    }

    // Create product first
    console.log("Writing product with sizes:", body.sizes);
    const newProduct = await prisma.product.create({
      data: {
        name,
        description,
        price,
        isPattern,
        isActive,
        tags,
        sizeGuideId,
        patternURL: patternPdfUrl,
        sizes: Array.isArray(body.sizes) ? body.sizes : [],
      },
    });

    // Create associated images if provided
    if (Array.isArray(images) && images.length > 0) {
      const imageData = images.map((img: any, index: number) => ({
        productId: newProduct.id,
        url: img.url,
        altText: img.altText || '',
        order: img.order ?? index,
      }));

      await prisma.productImage.createMany({
        data: imageData,
      });
    }

    // Return the product with images
    const fullProduct = await prisma.product.findUnique({
      where: { id: newProduct.id },
      include: {
        images: true,
        sizeGuide: true,
      },
    });

    return NextResponse.json(fullProduct, { status: 201 });
  } catch (error) {
    console.error('Error creating product:', error);
    return NextResponse.json({ error: 'Internal Server Error' }, { status: 500 });
  }
}

=== FILE: ./src/app/api/admin/products/[id]/route.ts ===

// === FILE: src/app/api/admin/products/[id]/route.ts ===
import { NextRequest, NextResponse } from 'next/server';
import { getServerSession } from 'next-auth';
import { authOptions } from '@/lib/auth';
import { prisma } from '@/lib/prisma';

// DELETE /api/admin/products/:id
export async function DELETE(
  req: NextRequest,
  { params }: { params: Promise<{ id: string }> }   // CHANGED: Promise
) {
  const session = await getServerSession(authOptions);
  if (!session || session.user.role !== 'admin') {
    return NextResponse.json({ error: 'Unauthorized' }, { status: 401 });
  }

  const { id } = await params;                        // CHANGED: await
  const productId = Number(id);
  if (Number.isNaN(productId)) {
    return NextResponse.json({ error: 'Invalid product ID' }, { status: 400 });
  }

  try {
    await prisma.product.delete({ where: { id: productId } });
    return NextResponse.json({ message: 'Product deleted' });
  } catch (error: any) {
    console.error('Error deleting product:', error);
    if (error.code === 'P2025') {
      return NextResponse.json({ error: 'Product not found' }, { status: 404 });
    }
    return NextResponse.json({ error: 'Internal Server Error' }, { status: 500 });
  }
}

// PUT /api/admin/products/:id
export async function PUT(
  req: NextRequest,
  { params }: { params: Promise<{ id: string }> }     // CHANGED: Promise
) {
  const session = await getServerSession(authOptions);
  if (!session || session.user.role !== 'admin') {
    return NextResponse.json({ error: 'Unauthorized' }, { status: 401 });
  }

  const { id } = await params;                        // CHANGED: await
  const productId = Number(id);
  if (Number.isNaN(productId)) {
    return NextResponse.json({ error: 'Invalid product ID' }, { status: 400 });
  }

  try {
    const body = await req.json();

    const updatedProduct = await prisma.$transaction(async (tx) => {
      if (Array.isArray(body.images)) {
        await tx.productImage.deleteMany({ where: { productId } });
        for (const [index, img] of body.images.entries()) {
          await tx.productImage.create({
            data: {
              productId,
              url: img.url,
              altText: img.altText || '',
              order: img.order ?? index,
            },
          });
        }
      }

      return tx.product.update({
        where: { id: productId },
        data: {
          name: body.name,
          price: body.price,
          description: body.description,
          isPattern: body.isPattern,
          isActive: body.isActive,
          tags: body.tags,
          sizeGuideId: body.sizeGuideId || null,
        },
        include: { images: true, sizeGuide: true },
      });
    });

    return NextResponse.json(updatedProduct);
  } catch (error) {
    console.error('Error updating product:', error);
    return NextResponse.json({ error: 'Internal Server Error' }, { status: 500 });
  }
}

=== FILE: ./src/app/api/admin/site-flags/route.ts ===

// src/app/api/admin/site-flags/route.ts
import { NextResponse } from "next/server";
import { getServerSession } from "next-auth";
import { authOptions } from "@/lib/auth";
import { setPurchasingPaused } from "@/lib/siteSettings";

export async function POST(req: Request) {
  const session = await getServerSession(authOptions);
  if (!session?.user?.email || session.user.role !== "admin") {
    return NextResponse.json({ error: "Unauthorized" }, { status: 401 });
  }

  const { purchasingPaused } = await req.json();
  if (typeof purchasingPaused !== "boolean") {
    return NextResponse.json({ error: "Invalid input" }, { status: 400 });
  }

  await setPurchasingPaused(purchasingPaused);
  return NextResponse.json({ ok: true });
}

=== FILE: ./src/app/api/admin/size-guides/route.ts ===

// === FILE: src/app/api/admin/size-guides/route.ts ===
// This file handles the API route for fetching size guides in the admin panel.

import { NextRequest, NextResponse } from 'next/server';
import { getServerSession } from 'next-auth';
import { authOptions } from '@/lib/auth';
import { prisma } from '@/lib/prisma';

export async function GET(req: NextRequest) {
  const session = await getServerSession(authOptions);

  if (!session || session.user.role !== 'admin') {
    return NextResponse.json({ error: 'Unauthorized' }, { status: 401 });
  }

  try {
    const guides = await prisma.sizeGuide.findMany({
      select: { id: true, name: true, tableData: true }
    });

    return NextResponse.json(guides);
  } catch (error) {
    console.error('Error fetching size guides:', error);
    return NextResponse.json({ error: 'Failed to fetch size guides' }, { status: 500 });
  }
}

export async function POST(req: NextRequest) {
  const session = await getServerSession(authOptions);

  // Only allow admins to create size guides
  if (!session || session.user.role !== 'admin') {
    return NextResponse.json({ error: 'Unauthorized' }, { status: 401 });
  }

  try {
    const { name, tableData } = await req.json();

    // Validate input
    if (!name || !Array.isArray(tableData) || !tableData.length) {
      return NextResponse.json({ error: 'Missing or invalid fields' }, { status: 400 });
    }

    // Create the new size guide
    const newGuide = await prisma.sizeGuide.create({
      data: {
        name,
        tableData,
      },
    });

    return NextResponse.json(newGuide, { status: 201 });
  } catch (error) {
    console.error('Error creating size guide:', error);
    return NextResponse.json({ error: 'Internal Server Error' }, { status: 500 });
  }
}
=== FILE: ./src/app/api/auth/change-email/confirm/route.ts ===

import { NextResponse } from "next/server";
import { prisma } from "@/lib/prisma";
import crypto from "crypto";

export async function POST(req: Request) {
  const { token } = await req.json();
  if (!token || typeof token !== "string") {
    return NextResponse.json({ error: "Invalid request" }, { status: 400 });
  }

  const tokenHash = crypto.createHash("sha256").update(token).digest("hex");

  // Find user with matching, unexpired token
  const user = await prisma.user.findFirst({
    where: {
      emailChangeTokenHash: tokenHash,
      emailChangeTokenExpires: { gt: new Date() },
      emailChangeNew: { not: null },
    },
  });

  if (!user || !user.emailChangeNew) {
    return NextResponse.json({ error: "Invalid or expired token" }, { status: 400 });
  }

  const newEmail = user.emailChangeNew;

  // Ensure the email isn't taken (race condition protection)
  const exists = await prisma.user.findUnique({ where: { email: newEmail } });
  if (exists && exists.id !== user.id) {
    // Clear pending fields to force a fresh attempt
    await prisma.user.update({
      where: { id: user.id },
      data: {
        //This is untested and probably broken
        emailChangeTokenHash: null,
        emailChangeTokenExpires: null,
        emailChangeNew: null,
      },
    });
    return NextResponse.json({ error: "Email already in use" }, { status: 400 });
  }

  // Apply the change, clear pending fields, and log the user out everywhere
  await prisma.user.update({
  where: { id: user.id },
  data: {
    email: newEmail,
    emailChangeTokenHash: null,
    emailChangeTokenExpires: null,
    emailChangeNew: null,
  },
});

// Best-effort: delete DB sessions only if the delegate exists (Prisma Adapter sessions)
try {
  // @ts-ignore - Delegate may not exist when using JWT sessions
  await (prisma as any).session?.deleteMany?.({ where: { userId: user.id } });
} catch {
  // ignore
}

return NextResponse.json({ ok: true });
}

=== FILE: ./src/app/api/auth/change-email/initiate/route.ts ===

import { NextResponse } from "next/server";
import { getServerSession } from "next-auth";
import { authOptions } from "@/lib/auth";
import { prisma } from "@/lib/prisma";
import bcrypt from "bcryptjs";
import crypto from "crypto";
import { Resend } from "resend";

const resend = new Resend(process.env.RESEND_API_KEY!);

export async function POST(req: Request) {
  const session = await getServerSession(authOptions);
  if (!session?.user?.email) {
    return NextResponse.json({ error: "Unauthorized" }, { status: 401 });
  }

  const { currentPassword, newEmail } = await req.json();
  if (
    typeof currentPassword !== "string" ||
    typeof newEmail !== "string" ||
    !newEmail.includes("@")
  ) {
    return NextResponse.json({ error: "Invalid input" }, { status: 400 });
  }

  const user = await prisma.user.findUnique({
    where: { email: session.user.email.toLowerCase() },
    select: { id: true, email: true, password: true },
  });
  if (!user?.password) return NextResponse.json({ error: "Unauthorized" }, { status: 401 });

  const ok = await bcrypt.compare(currentPassword, user.password);
  if (!ok) return NextResponse.json({ error: "Invalid password" }, { status: 400 });

  const normalizedNew = newEmail.toLowerCase();

  // Ensure the desired email is not already used by someone else
  const exists = await prisma.user.findUnique({ where: { email: normalizedNew } });
  if (exists) return NextResponse.json({ error: "Email already in use" }, { status: 400 });

  const rawToken = crypto.randomBytes(32).toString("hex");
  const tokenHash = crypto.createHash("sha256").update(rawToken).digest("hex");
  const expiresAt = new Date(Date.now() + 1000 * 60 * 60); // 1 hour

  // Store pending data on the user
  await prisma.user.update({
    where: { id: user.id },
    data: {
      emailChangeTokenHash: tokenHash,
      emailChangeTokenExpires: expiresAt,
      emailChangeNew: normalizedNew,
    },
  });

  const base = process.env.NEXT_PUBLIC_BASE_URL!;
  const confirmUrl = `${base}/user/confirm-email-change?token=${rawToken}`;

  // Email only the NEW address for confirmation; optionally notify old email too.
  try {
    await resend.emails.send({
      from: process.env.EMAIL_FROM!,
      to: normalizedNew,
      subject: "Confirm your new email",
      html: `
        <p>Click to confirm your new login email:</p>
        <p><a href="${confirmUrl}">${confirmUrl}</a></p>
        <p>This link expires in 1 hour.</p>
      `,
    });
  } catch (e) {
    // Roll back the pending fields if email fails to send
    await prisma.user.update({
      where: { id: user.id },
      data: {
        //This is untested and probably broken
        emailChangeTokenHash: null,
        emailChangeTokenExpires: null,
        emailChangeNew: null,
      },
    });
    return NextResponse.json({ error: "Failed to send email" }, { status: 500 });
  }

  // Optional: notify old email that a change was requested (no link)
  try {
    await resend.emails.send({
      from: process.env.EMAIL_FROM!,
      to: user.email,
      subject: "Email change requested",
      html: `<p>If you didn't request this, change your password immediately.</p>`,
    });
  } catch (_) {}

  return NextResponse.json({ ok: true });
}

=== FILE: ./src/app/api/auth/change-password/route.ts ===

import { NextResponse } from "next/server";
import { getServerSession } from "next-auth";
import { authOptions } from "@/lib/auth";
import { prisma } from "@/lib/prisma";
import bcrypt from "bcryptjs";

export async function POST(req: Request) {
  const session = await getServerSession(authOptions);
  if (!session?.user?.email) {
    return NextResponse.json({ error: "Unauthorized" }, { status: 401 });
  }

  const { currentPassword, newPassword } = await req.json();

  if (typeof currentPassword !== "string" || typeof newPassword !== "string") {
    return NextResponse.json({ error: "Invalid input" }, { status: 400 });
  }
  if (newPassword.length < 8) {
    return NextResponse.json({ error: "Password too short" }, { status: 400 });
  }

  const user = await prisma.user.findUnique({
    where: { email: session.user.email.toLowerCase() },
    select: { id: true, password: true },
  });
  if (!user?.password) {
    return NextResponse.json({ error: "Unauthorized" }, { status: 401 });
  }

  const ok = await bcrypt.compare(currentPassword, user.password);
  if (!ok) {
    return NextResponse.json({ error: "Invalid current password" }, { status: 400 });
  }

  const hashed = await bcrypt.hash(newPassword, 10);

  await prisma.user.update({
    where: { id: user.id },
    data: {
      password: hashed,
      resetTokenHash: null,
      resetTokenExpires: null,
    },
  });

  return NextResponse.json({ ok: true });
}

=== FILE: ./src/app/api/auth/forgot-password/route.ts ===

import { NextResponse } from "next/server";
import crypto from "crypto";
import { prisma } from "@/lib/prisma";
import { Resend } from "resend";

const resend = new Resend(process.env.RESEND_API_KEY!);

export async function POST(req: Request) {
  const { email } = await req.json();
  // Always send a generic response to avoid user enumeration
  const generic = NextResponse.json({ message: "If that email exists, we've sent instructions." });

  if (!email || typeof email !== "string") return generic;

  // Normalize email
  const normalized = email.toLowerCase();

  // Generate raw token and store only the hash
  const rawToken = crypto.randomBytes(32).toString("hex");
  const tokenHash = crypto.createHash("sha256").update(rawToken).digest("hex");
  const expiresAt = new Date(Date.now() + 1000 * 60 * 60); // 1 hour

  // Upsert reset fields for existing user, but dont leak whether they exist
  await prisma.user.updateMany({
    where: { email: normalized },
    data: { resetTokenHash: tokenHash, resetTokenExpires: expiresAt },
  });

  // Build reset URL regardless
  const base = process.env.NEXT_PUBLIC_BASE_URL!;
  const resetUrl = `${base}/user/reset-password?token=${rawToken}&email=${encodeURIComponent(normalized)}`;

  try {
    // Send the email (even if the user doesn't exist, for indistinguishability)
    await resend.emails.send({
      from: process.env.EMAIL_FROM!, // e.g. onboarding@resend.dev
      to: normalized,
      subject: "Reset your password",
      html: `
        <p>We received a request to reset your password.</p>
        <p><a href="${resetUrl}">Click here to reset it</a>. This link expires in 1 hour.</p>
        <p>If you didnt request this, you can ignore this email.</p>
      `,
    });
  } catch (_) {
    // Swallow errors to keep response generic
  }

  return generic;
}

=== FILE: ./src/app/api/auth/register/route.ts ===

// === FILE: src/app/api/auth/register/route.ts ===
// This file handles the API route for user registration.

import { NextResponse } from 'next/server';
import { PrismaClient } from '@prisma/client';
import bcrypt from 'bcryptjs';
import { prisma } from '@/lib/prisma';


export async function POST(req: Request) {
    const { email, password, name } = await req.json();

    if (!email || !password || !name) {
        return NextResponse.json({ error: 'All fields are required' }, { status: 400 });
    }

    const existingUser = await prisma.user.findUnique({ where: { email } });

    if (existingUser) {
        return NextResponse.json({ error: 'User already exists' }, { status: 400 });
    }

    const hashedPassword = await bcrypt.hash(password, 10);

    const user = await prisma.user.create({
        data: {
            email: email.toLowerCase(),
            name,
            password: hashedPassword,
            role: "user", // Default role
        },
    });

    return NextResponse.json({ user: { id: user.id, email: user.email}}, { status: 201 });
}
=== FILE: ./src/app/api/auth/reset-password/route.ts ===

import { NextResponse } from "next/server";
import crypto from "crypto";
import bcrypt from "bcryptjs";
import { prisma } from "@/lib/prisma";

export async function POST(req: Request) {
  const { email, token, newPassword } = await req.json();

  if (!email || !token || !newPassword || newPassword.length < 8) {
    return NextResponse.json({ error: "Invalid request" }, { status: 400 });
  }

  const tokenHash = crypto.createHash("sha256").update(token).digest("hex");
  const user = await prisma.user.findUnique({ where: { email: email.toLowerCase() } });

  if (
    !user ||
    !user.resetTokenHash ||
    !user.resetTokenExpires ||
    user.resetTokenHash !== tokenHash ||
    user.resetTokenExpires < new Date()
  ) {
    // Dont reveal which check failed
    return NextResponse.json({ error: "Invalid or expired token" }, { status: 400 });
  }

  const hashed = await bcrypt.hash(newPassword, 10);

  await prisma.user.update({
    where: { email: user.email },
    data: {
      password: hashed,
      resetTokenHash: null,
      resetTokenExpires: null,
    },
  });

  return NextResponse.json({ ok: true });
}

=== FILE: ./src/app/api/auth/[...nextauth]/route.ts ===

// === FILE: src/app/api/auth/[...nextauth]/route.ts ===
// This file handles the NextAuth API routes for authentication.

import NextAuth from "next-auth";
import { authOptions } from "@/lib/auth";

// Use the centralized auth config
const handler = NextAuth(authOptions);

// Export GET and POST handlers for NextAuth API routes
export { handler as GET, handler as POST };

=== FILE: ./src/app/api/checkout/route.ts ===

// === FILE: src/app/api/checkout/route.ts ===
// This file handles the API route for creating a Stripe checkout session.

import Stripe from "stripe";
import { NextResponse } from "next/server";
import { prisma } from "@/lib/prisma";
import { getServerSession } from "next-auth";
import { authOptions } from "@/lib/auth";
import { getPurchasingPaused } from "@/lib/siteSettings";

const stripe = new Stripe(process.env.STRIPE_SECRET_KEY!);

export async function POST(req: Request) {
  if (await getPurchasingPaused()) {
    return NextResponse.json(
      { error: "Purchasing is temporarily paused. Please try again later." },
      { status: 503 }
    );
  }
  
  const session = await getServerSession(authOptions);
  if (!session || !session.user?.email) {
    return NextResponse.json({ message: "Unauthorized" }, { status: 401 });
  }
  try {
    const { cart, name } = await req.json();

    if (!cart || cart.length === 0) {
      return NextResponse.json({ message: "Missing required info" }, { status: 400 });
    }

    // Build secure line_items from real DB values
    const line_items: Stripe.Checkout.SessionCreateParams.LineItem[] = [];

    for (const item of cart) {
      if (
        typeof item.quantity !== "number" ||
        item.quantity < 1 ||
        item.quantity > 99
      ) {
        return NextResponse.json(
          { message: `Invalid quantity for product ${item.productId}.` },
          { status: 400 }
        );
      }
      const product = await prisma.product.findUnique({
        where: { id: item.productId },
        include: { images: true },
      });

      if (!product || !product.isActive) {
        return NextResponse.json(
          { message: `Product ${item.productId} is invalid.` },
          { status: 400 }
        );
      }

      line_items.push({
        price_data: {
          currency: "usd",
          product_data: {
            name: product.name,
            images: product.images?.[0] ? [product.images[0].url] : [],
          },
          unit_amount: product.price,
        },
        quantity: item.quantity,
      });
    }

    const sessionStripe = await stripe.checkout.sessions.create({
      payment_method_types: ["card"],
      mode: "payment",
      customer_email: session.user.email,
      line_items,
      metadata: {
        customerName: name || session.user.name || "",
        rawCart: JSON.stringify(cart),
      },
      success_url: `${process.env.NEXT_PUBLIC_BASE_URL}/checkout/success`,
      cancel_url: `${process.env.NEXT_PUBLIC_BASE_URL}/cart`,
    });

    return NextResponse.json({ url: sessionStripe.url });
  } catch (err: any) {
    console.error("Stripe checkout error:", err.message);
    return NextResponse.json(
      { message: "Something went wrong" },
      { status: 500 }
    );
  }
}

=== FILE: ./src/app/api/custom-order/route.ts ===

// === FILE: src/app/api/custom-order/route.ts ===
// This file handles the API route for submitting a custom order form.

import { prisma } from "@/lib/prisma";
import { NextResponse } from "next/server";
import { Resend } from "resend";

const resend = new Resend(process.env.RESEND_API_KEY);

export async function POST(req: Request) {
  try {
    const data = await req.json();

    let imagesHtml = "";
    if (Array.isArray(data.designImages) && data.designImages.length > 0) {
      imagesHtml = `
    <h3>Design Inspiration Images</h3>
    <ul>
      ${(data.designImages as string[])
        .map(
          (url: string) =>
            `<li>
              <a href="${url}" target="_blank">${url}</a><br/>
              <img src="${url}" style="max-width:200px;max-height:200px;"/>
            </li>`
        )
        .join("")}
    </ul>
  `;
    }

    const htmlBody = `
      <h2>New Custom Order</h2>
      <p><strong>Garment Type:</strong> ${data.garmentType} ${data.otherGarment || ""}</p>
      <p><strong>Fabric:</strong> ${data.fabric}</p>
      <p><strong>Color:</strong> ${data.color}</p>
      <p><strong>Design Details:</strong> ${data.designDetails}</p>
      ${imagesHtml}
      <p><strong>Occasion:</strong> ${data.occasion}</p>
      <h3>Measurements</h3>
      <ul>
        <li>Size: ${data.size} ${data.customSize || ""}</li>
        <li>Waist: ${data.waist}</li>
        <li>Bust: ${data.bust}</li>
        <li>Hips: ${data.hips}</li>
        <li>Height: ${data.height}</li>
        <li>Bra: ${data.braBand || ""}${data.braCup || ""}</li>
        <li>Under Bust: ${data.underBust}</li>
        <li>Shoulder Span: ${data.shoulderSpan}</li>
        <li>Inseam: ${data.inseam}</li>
        <li>Arm Length: ${data.armLength}</li>
        <li>Bicep: ${data.bicep}</li>
        <li>Wrist: ${data.wrist}</li>
        <li>Neck: ${data.neckCircumference}</li>
        <li>Thigh: ${data.thigh}</li>
        <li>Calf: ${data.calf}</li>
        <li>Shoulder to Waist: ${data.shoulderToWaist}</li>
        <li>Other Measurements: ${data.otherMeasurements}</li>
      </ul>
      <h3>Preferences</h3>
      <p>Fabric Swatch Approval: ${data["Fabric Swatch Approval"] ? "Yes" : "No"}</p>
      <p>Sketch Approval: ${data["Sketch Approval"] ? "Yes" : "No"}</p>
      <p>Progress updates (messages): ${data["Progress updates (messages)"] ? "Yes" : "No"}</p>
      <p>Progress updates (photos): ${data["Progress updates (photos)"] ? "Yes" : "No"}</p>
      <p>None (surprise me): ${data["None (surprise me)"] ? "Yes" : "No"}</p>
      <p>Other follow-up: ${data.followUpOther}</p>
      <h3>Customer Info</h3>
      <p>Name: ${data.name}</p>
      <p>Phone: ${data.phone}</p>
      <p>Email: ${data.email}</p>
      <p>Preferred Contact: ${data.preferredContact}</p>
      <h3>Budget & Timeline</h3>
      <p>Budget: ${data.budget}</p>
      <p>Deadline: ${data.deadline}</p>
      <p>Rush Order: ${data.rushOrder}</p>
      <h3>Closures</h3>
      <ul>
        ${["Zipper (exposed)", "Zipper (hidden/invisible)", "Buttons (functional)", "Buttons (decorative)", "Hook & eye", "Lacing", "Snaps", "Velcro", "Tie closure"].map((type) => `<li>${type}: ${data[type] ? "Yes" : "No"}</li>`).join("")}
      </ul>
      <p>Other Closures: ${data.closureOther}</p>
      <h3>Pockets</h3>
      <p>No Pockets: ${data["No pockets"] ? "Yes" : "No"}</p>
      <p>Hidden/Secret Pockets: ${data["Hidden/secret pockets"] ? "Yes" : "No"}</p>
      <p>Other Pockets: ${data.pocketOther}</p>
      <h3>Fit</h3>
      <p>Tailored: ${data.tailored ? "Yes" : "No"}</p>
      <p>Tight: ${data.tight ? "Yes" : "No"}</p>
      <p>Relaxed: ${data.relaxed ? "Yes" : "No"}</p>
      <p>Other Fit: ${data.fitOther}</p>
      <p>Lining: ${data.lining ? "Yes" : "No"}</p>
      <p>Other Lining: ${data.liningOther}</p>
      <h3>Additional Info</h3>
      <p>${data.additionalInfo}</p>
    `;

    const response = await resend.emails.send({
      from: process.env.EMAIL_FROM!,
      to: process.env.EMAIL_TO!,
      subject: `New Custom Order from ${data.name}`,
      html: htmlBody,
    });

    await prisma.order.create({
      data: {
        isCustom: true,
        customerEmail: data.email,
        customerName: data.name,
        designImages: data.designImages,
        customOrder: data,
        status: "pending",
      },
    });

    return NextResponse.json({ success: true, id: response });
  } catch (err) {
    console.error(err);
    return NextResponse.json(
      { success: false, error: "Failed to send email" },
      { status: 500 }
    );
  }
}

=== FILE: ./src/app/api/media-library/route.ts ===

// === FILE: src/app/api/media-library/route.ts ===
// This file handles the API route for fetching images from the media library.

import { NextResponse } from 'next/server';
import { prisma } from '@/lib/prisma';

export async function GET() {
  const images = await prisma.mediaLibrary.findMany({
    orderBy: { createdAt: 'desc' },
  });

  return NextResponse.json(images);
}

=== FILE: ./src/app/api/pattern-download/route.ts ===

// === FILE: src/app/api/pattern-download/route.ts ===
// This file handles the download of pattern PDFs for customers

import { NextRequest, NextResponse } from "next/server";
import { prisma } from "@/lib/prisma";
import jwt from "jsonwebtoken"; // npm i jsonwebtoken

const JWT_SECRET = process.env.PATTERN_DOWNLOAD_SECRET || "something-very-secret";

// URL: /api/pattern-download?token=...

export async function GET(req: NextRequest) {
  const token = req.nextUrl.searchParams.get("token");
  if (!token) return NextResponse.json({ error: "Missing token" }, { status: 400 });

  try {
    // Decode and verify the JWT token from the email
    const { orderId, patternId, email } = jwt.verify(token, JWT_SECRET) as any;

    // Find the order and its items/products
    const order = await prisma.order.findUnique({
      where: { id: orderId },
      include: { orderItems: { include: { product: true } } },
    });

    if (!order) {
      return NextResponse.json({ error: "Order not found" }, { status: 404 });
    }

    // Check that the email matches (if you want)
    if (order.customerEmail !== email) {
      return NextResponse.json({ error: "Email mismatch" }, { status: 403 });
    }

    // Find the order item for the pattern product
    const patternOrderItem = order.orderItems.find(
      (item) =>
        item.productId === patternId &&
        item.product &&
        item.product.isPattern &&
        item.product.patternURL
    );

    if (!patternOrderItem) {
      return NextResponse.json({ error: "Pattern not found in order" }, { status: 403 });
    }

    // Redirect to the pattern PDF
    if (!patternOrderItem.product.patternURL) {
      return NextResponse.json({ error: "Pattern URL not found" }, { status: 500 });
    }
    return NextResponse.redirect(patternOrderItem.product.patternURL, 302);
  } catch (err) {
    return NextResponse.json({ error: "Invalid or expired token" }, { status: 403 });
  }
}

=== FILE: ./src/app/api/products/route.ts ===

// === FILE: src/app/api/products/route.ts ===
// This file handles the API route for fetching all products.

import { NextResponse } from "next/server";
import { prisma } from "@/lib/prisma";

export async function GET(req: Request) {
  const url = new URL(req.url);
  const tag = url.searchParams.get("tag");

  try {
    const products = await prisma.product.findMany({
      where: {
        isActive: true,
        ...(tag && {
          tags: {
            has: tag,
          },
        }),
      },
      include: {
        images: true,
        sizeGuide: true,
      },
    });

    return NextResponse.json(products);
  } catch (error) {
    console.error("Error fetching products:", error);
    return NextResponse.json(
      { error: "Failed to fetch products" },
      { status: 500 }
    );
  }
}

=== FILE: ./src/app/api/products/[id]/route.ts ===

// === FILE: src/app/api/products/[id]/route.ts ===
// This file handles fetching product details by ID

import { NextResponse } from "next/server";
import { prisma } from "@/lib/prisma";

export async function GET(
  req: Request,
  context: { params: Promise<{ id: string }> }
) {
  const { params } = context;
  const { id } = await params;

  const numId = Number(id);
  if (isNaN(numId))
    return NextResponse.json({ error: "Invalid ID" }, { status: 400 });

  const product = await prisma.product.findUnique({
    where: { id: numId },
    include: {
      images: true,
      sizeGuide: true,
    },
  });

  if (!product || !product.isActive)
    return NextResponse.json({ error: "Not found" }, { status: 404 });

  return NextResponse.json(product);
}

=== FILE: ./src/app/api/public/site-flags/route.ts ===

// src/app/api/public/site-flags/route.ts
import { NextResponse } from "next/server";
import { getPurchasingPaused } from "@/lib/siteSettings";

export async function GET() {
  const purchasingPaused = await getPurchasingPaused();
  return NextResponse.json(
    { purchasingPaused },
    { headers: { "Cache-Control": "public, max-age=15" } }
  );
}

=== FILE: ./src/app/api/stripe/webhook/route.ts ===

// === FILE: src/app/api/stripe/webhook/route.ts ===
// This file handles Stripe webhook events, particularly for order completion

import { NextResponse } from "next/server";
import Stripe from "stripe";
import { prisma } from "@/lib/prisma";
import { Resend } from "resend";

const stripe = new Stripe(process.env.STRIPE_SECRET_KEY!, {});
const resend = new Resend(process.env.RESEND_API_KEY);

export async function POST(req: Request) {
  const signature = req.headers.get("stripe-signature");
  if (!signature) {
    return new NextResponse("Missing stripe-signature header", { status: 400 });
  }

  const rawBody = await req.text();

  let event: Stripe.Event;

  try {
    event = stripe.webhooks.constructEvent(
      rawBody,
      signature,
      process.env.STRIPE_WEBHOOK_SECRET!
    );
  } catch (err) {
    console.error(" Stripe webhook signature verification failed:", err);
    return new NextResponse("Webhook Error: Invalid signature", {
      status: 400,
    });
  }

  if (event.type === "checkout.session.completed") {
    const session = event.data.object as Stripe.Checkout.Session;

    const email = session.customer_email?.toLowerCase();
    const name = session.metadata?.customerName || "Unknown";
    const rawCart = session.metadata?.rawCart;
    const sessionId = session.id;

    if (!email || !rawCart) {
      console.warn(" Webhook missing required metadata");
      return new NextResponse("Missing required metadata", { status: 400 });
    }

    let cart: { productId: number; quantity: number; size?: string }[];
    try {
      cart = JSON.parse(rawCart);
    } catch (err) {
      console.error(" Failed to parse cart JSON:", err);
      return new NextResponse("Invalid cart format", { status: 400 });
    }

    // Get all products in the cart
    const products = await prisma.product.findMany({
      where: { id: { in: cart.map((i) => i.productId) } },
    });

    const user = await prisma.user.findUnique({ where: { email } });
    const order = await prisma.order.create({
      data: {
        customerEmail: email,
        customerName: name,
        userId: user ? user.id : null,
        status: "paid",
        isPaid: true,
        totalPrice: products.reduce((sum, product) => {
          const item = cart.find((c) => c.productId === product.id);
          return sum + product.price * (item?.quantity || 1);
        }, 0),
        orderItems: {
          create: cart.map((item) => ({
            product: { connect: { id: item.productId } },
            quantity: item.quantity,
            unitPrice:
              products.find((p) => p.id === item.productId)?.price || 0,
            ...(item.size && { size: item.size }),
          })),
        },
      },
      include: { orderItems: { include: { product: true } } },
    });

    try {
      await resend.emails.send({
        from: process.env.EMAIL_FROM!,
        to: email,
        subject: "Order Confirmation - Olipopper Studios",
        html: `
      <h2>Thank you for your order!</h2>
      <p>Hi ${name},</p>
      <p>Your order <strong>#${order.id}</strong> has been received and is being processed.</p>
      <p>
        <strong>Order Details:</strong><br/>
        ${order.orderItems
          .map(
            (item) =>
              `${item.product?.name || "Product"} x${item.quantity}${item.size ? ` (Size: ${item.size})` : ""}`
          )
          .join("<br/>")}
      </p>
      <p>
        <strong>Total:</strong> $${((order.totalPrice ?? 0) / 100).toFixed(2)}
      </p>
      <p>
        You will receive another email when your order ships or is ready for download.<br/>
        If you have any questions, reply to this email or contact us at <a href="mailto:contact@olipopperstudios.com">contact@olipopperstudios.com</a>.
      </p>
      <p>
        Thank you!<br/>
        Olipopper Studios
      </p>
    `,
      });
      console.log(`Order confirmation email sent to ${email}`);
    } catch (err) {
      console.error(" Failed to send confirmation email:", err);
    }

    for (const item of order.orderItems) {
      if (item.product.isPattern && item.product.patternURL) {
        try {
          console.log(`Attempting to send pattern PDF to ${email}...`);
          const pdfRes = await fetch(item.product.patternURL);
          if (!pdfRes.ok) {
            console.error(
              `Failed to fetch PDF at ${item.product.patternURL}:`,
              pdfRes.statusText
            );
            continue;
          }
          const pdfBuffer = await pdfRes.arrayBuffer();

          await resend.emails.send({
            from: process.env.EMAIL_FROM!,
            to: email,
            subject: `Your Sewing Pattern: ${item.product.name}`,
            html: `...`,
            attachments: [
              {
                filename: `${item.product.name}.pdf`,
                content: Buffer.from(pdfBuffer),
                contentType: "application/pdf",
              },
            ],
          });
          console.log(`Successfully sent email to ${email}`);
        } catch (err) {
          console.error("Failed to send pattern PDF email:", err);
        }
      }
    }

    return NextResponse.json({ success: true });
  }

  return NextResponse.json(
    { message: "Unhandled event type" },
    { status: 200 }
  );
}

=== FILE: ./src/app/api/uploadthing/core.ts ===

// === FILE: src/app/api/uploadthing/core.ts ===
// This file handles the Uploadthing file upload configuration and API routes.

import { createUploadthing, type FileRouter } from "uploadthing/next";
import { getServerSession } from "next-auth"; // Adjust if you use a different session system
import { prisma } from "@/lib/prisma"; // Adjust the import path as needed

const f = createUploadthing();

export const ourFileRouter = {
  productImage: f({
    image: { maxFileSize: "8MB", maxFileCount: 4 },
    pdf: { maxFileSize: "16MB", maxFileCount: 1 },
  })
    .middleware(async () => {
      const session = await getServerSession();
      if (!session?.user) throw new Error("Unauthorized");
      return { userId: session.user.id };
    })
    .onUploadComplete(async ({ metadata, file }) => {
      // Save to your media library DB
      await prisma.mediaLibrary.upsert({
        where: { url: file.ufsUrl },
        update: {},
        create: {
          url: file.ufsUrl,
        },
      });

      console.log("Uploaded and saved:", file.ufsUrl);
      return { url: file.ufsUrl };
    }),
} satisfies FileRouter;

export type OurFileRouter = typeof ourFileRouter;

=== FILE: ./src/app/api/uploadthing/route.ts ===

// === FILE: src/app/api/uploadthing/route.ts ===
// This file handles the Uploadthing file upload API routes.

import { createRouteHandler } from "uploadthing/next";
import { ourFileRouter } from "./core";

export const { GET, POST } = createRouteHandler({ router: ourFileRouter });

=== FILE: ./src/app/api/user/orders/route.ts ===

// === FILE: src/app/api/user/orders/route.ts ===

import { NextResponse } from "next/server";
import { getServerSession } from "next-auth";
import { authOptions } from "@/lib/auth";
import { prisma } from "@/lib/prisma";

// Returns orders for current user (must be logged in)
export async function GET() {
  const session = await getServerSession(authOptions);

  if (!session || !session.user?.id) {
    return NextResponse.json({ error: "Unauthorized" }, { status: 401 });
  }

  // Find all orders for this user
  const orders = await prisma.order.findMany({
    where: {
      userId: session.user.id,
    },
    orderBy: { createdAt: "desc" },
    include: {
      orderItems: {
        include: { product: true }
      }
    },
  });

  return NextResponse.json(orders);
}

=== FILE: ./src/app/api/user/route.ts ===

// === FILE: src/app/api/user/route.ts ===

import { NextResponse } from "next/server";
import { getServerSession } from "next-auth";
import { authOptions } from "@/lib/auth";
import { prisma } from "@/lib/prisma";

// Securely delete the current user's account
export async function DELETE() {
  const session = await getServerSession(authOptions);

  if (!session || !session.user?.id) {
    return NextResponse.json({ error: "Unauthorized" }, { status: 401 });
  }

  try {
    // Delete the user by id
    await prisma.user.delete({
      where: { id: session.user.id },
    });
    

    return NextResponse.json({ success: true });
  } catch (error) {
    console.error("Error deleting user:", error);
    return NextResponse.json({ error: "Failed to delete user" }, { status: 500 });
  }
}

=== FILE: ./src/app/cart/page.tsx ===

// === FILE: src/app/cart/page.tsx ===

'use client';

import { useCart } from '@/utils/CartContext';
import Link from 'next/link';
import { useSession, signIn } from 'next-auth/react';
import { useRouter } from 'next/navigation';

export default function CartPage() {
  const { cart, updateQuantity, removeFromCart, getTotal } = useCart();

  const { data: session, status } = useSession();
  const router = useRouter();

  async function handleCheckout() {
    if (status === 'unauthenticated') {
      router.push('/user/login');
      return;
    }

    try {
      const res = await fetch('/api/checkout', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ cart }),
      });

      const data = await res.json();
      if (!res.ok || !data?.url) {
        throw new Error(data?.message || 'Checkout failed');
      }

      window.location.href = data.url;
    } catch (err) {
      console.error(err);
    }
  }

  if (cart.length === 0) {
    return (
      <div className="p-6 text-center">
        <h1 className="mt-30 text-2xl font-bold mb-4">Your Cart is Empty</h1>
        <Link href="/products" className="text-blue-600 hover:underline">Browse Products</Link>
      </div>
    );
  }

  return (
    <div className="p-6 max-w-4xl mx-auto">
      <h1 className="text-3xl font-bold mb-6 text-center">Shopping Cart</h1>

      <ul className="space-y-6 mb-8">
        {cart.map(item => (
          <li
            key={item.productId + (item.size || "")}
            className="flex flex-col sm:flex-row gap-4 items-center border rounded-2xl p-4 bg-white shadow-md"
          >
            {item.image ? (
              <img
                src={item.image}
                alt={item.name}
                className="w-28 h-28 object-cover rounded-xl border"
              />
            ) : (
              <div className="w-28 h-28 bg-gray-200 flex items-center justify-center text-gray-500 rounded-xl border">
                No Image
              </div>
            )}

            <div className="flex-1 w-full">
              <div className="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2">
                <h2 className="text-xl font-semibold">{item.name}</h2>
                {/* Show size if present */}
                {item.size && (
                  <span className="px-3 py-1 text-xs font-medium bg-gray-100 border rounded text-gray-700">
                    Size: {item.size}
                  </span>
                )}
              </div>
              <p className="text-base text-gray-600 mt-1">${(item.price / 100).toFixed(2)} each</p>
              <div className="flex items-center gap-3 mt-3">
                <label className="text-sm font-medium">Qty:</label>
                <input
                  type="number"
                  min="1"
                  value={item.quantity}
                  onChange={e => updateQuantity(item.productId, parseInt(e.target.value), item.size)}
                  className="w-16 border px-2 py-1 rounded"
                />
                <button
                  onClick={() => removeFromCart(item.productId, item.size)}
                  className="text-red-600 hover:underline text-sm font-medium ml-2"
                >
                  Remove
                </button>
              </div>
            </div>
          </li>
        ))}
      </ul>

      <div className="flex flex-col sm:flex-row sm:justify-between items-center mb-8">
        <div className="text-lg font-bold">
          Total: <span className="text-gray-900">${(getTotal() / 100).toFixed(2)}</span>
        </div>

        {/* replaced Link-to-/checkout with direct button to API */}
        <button
          onClick={handleCheckout}
          className="bg-black text-white px-7 py-3 rounded-lg hover:bg-gray-800 transition font-semibold shadow mt-4 sm:mt-0"
        >
          {status !== 'authenticated' ? 'Sign in to Checkout' : 'Proceed to Checkout'}
        </button>
      </div>
    </div>
  );
}

=== FILE: ./src/app/checkout/page.tsx ===

// === FILE: src/app/checkout/page.tsx ===
// This file defines the checkout page where users can review their cart and proceed to payment.
/*
'use client';

import { useCart } from '@/utils/CartContext';
import { useState } from 'react';
import { useSession, signIn } from 'next-auth/react';

export default function CheckoutPage() {
  const { cart, getTotal } = useCart();
  const [email, setEmail] = useState('');
  const [name, setName] = useState('');
  const [loading, setLoading] = useState(false);
  const [error, setError] = useState('');
  const { data: session, status } = useSession();

  const handleCheckout = async () => {
    if (status === 'unauthenticated') {
      return signIn(undefined, { callbackUrl: '/checkout' });
    }
    setLoading(true);
    setError('');

    try {
      const res = await fetch('/api/checkout', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ cart, name }),
      });

      const data = await res.json();

      if (!res.ok || !data.url) {
        throw new Error(data.message || 'Checkout failed');
      }

      // Redirect to Stripe Checkout
      window.location.href = data.url;
    } catch (err: any) {
      setError(err.message);
      setLoading(false);
    }
  };

  if (cart.length === 0) {
    return (
      <div className="p-6 text-center">
        <h1 className="text-2xl font-bold mb-4">Your Cart is Empty</h1>
      </div>
    );
  }

  return (
    <div className="p-6 max-w-2xl mx-auto">
      <h1 className="text-2xl font-bold mb-4">Checkout</h1>

      <ul className="mb-4">
        {cart.map(item => (
          <li key={item.productId} className="flex justify-between text-sm py-1">
            <span>{item.name}  {item.quantity}</span>
            <span>${((item.price * item.quantity) / 100).toFixed(2)}</span>
          </li>
        ))}
      </ul>

      <div className="text-right font-semibold text-lg mb-6">
        Total: ${(getTotal() / 100).toFixed(2)}
      </div>

      {/* <input
        type="email"
        placeholder="Email (required)"
        value={email}
        onChange={e => setEmail(e.target.value)}
        className="w-full border p-2 mb-4 rounded"
        required
      />

      {/* <input
        type="text"
        placeholder="Name (optional)"
        value={name}
        onChange={e => setName(e.target.value)}
        className="w-full border p-2 mb-4 rounded"
      /> 

      {error && <p className="text-red-600 mb-2">{error}</p>}

      <button
        onClick={handleCheckout}
        disabled={loading}
        className="bg-black text-white px-6 py-2 rounded hover:bg-gray-800 disabled:opacity-50"
      >
        {loading ? 'Processing...' : (status !== 'authenticated' ? 'Sign in to Checkout' : 'Proceed to Payment')}
      </button>
    </div>
  );
}
*/

// File: src/app/checkout/page.tsx

export default function CheckoutPage() {
  return (
    <div className="p-6 text-center">
      <h1 className="text-2xl font-bold mb-4">Checkout (stub)</h1>
      <p>This page is under construction.</p>
    </div>
  );
}

=== FILE: ./src/app/checkout/success/page.tsx ===

// === FILE: src/app/checkout/success/page.tsx ===
// This file defines the success page displayed after a successful checkout.

'use client';

import Link from 'next/link';
import { useEffect } from 'react';
import { useCart } from '@/utils/CartContext';

export default function SuccessPage() {
  const { cart, clearCart } = useCart();

   console.log("SuccessPage mounted!");

  useEffect(() => {
    console.log("Cart before clear:", cart);
    // Clear the cart once payment is done
    const timeout = setTimeout(() => {
    clearCart();
  }, 100);
  console.log("Cart after clear:", cart);
  }, []);

  return (
    <div className="p-6 text-center max-w-xl mx-auto mt-30">
      <h1 className="text-3xl font-bold mb-4"> Thank You for Your Order!</h1>
      <p className="text-lg text-gray-700 mb-6">
        Your payment was successful. You'll receive a confirmation email shortly.
      </p>
      <a href="/" className="bg-black text-white px-6 py-2 rounded hover:bg-gray-800">Continue Shopping</a>

    </div>
  );
}

=== FILE: ./src/app/contact/page.tsx ===

// === FILE: src/app/contact/page.tsx ===

'use client';

import { useState } from "react";

export default function ContactPage() {
  const [name, setName] = useState("");
  const [email, setEmail] = useState("");
  const [message, setMessage] = useState("");
  const [sent, setSent] = useState(false);
  const [error, setError] = useState("");

  // Placeholder form handler for demoreplace with actual send logic later!
  async function handleSubmit(e: React.FormEvent) {
    e.preventDefault();
    setSent(false);
    setError("");
    // Optionally, you could POST to /api/contact here
    if (!name || !email || !message) {
      setError("Please fill out all fields.");
      return;
    }
    setSent(true);
    setName("");
    setEmail("");
    setMessage("");
  }

  return (
    <div className="max-w-xl mx-auto px-6 py-16">
      <h1 className="text-3xl font-bold mb-6 text-center">Contact Us</h1>
      <p className="mb-6 text-gray-600 text-center">
        Questions, feedback, or custom requests? Wed love to hear from you!
      </p>

      <form onSubmit={handleSubmit} className="bg-white shadow rounded-xl p-6 flex flex-col gap-4">
        {error && <p className="text-red-600 font-semibold">{error}</p>}
        {sent && <p className="text-green-600 font-semibold">Message sent! Thank you.</p>}
        <div>
          <label className="block mb-1 font-medium">Your Name</label>
          <input
            className="border rounded w-full p-2"
            value={name}
            onChange={e => setName(e.target.value)}
            placeholder="Jane Doe"
            required
          />
        </div>
        <div>
          <label className="block mb-1 font-medium">Your Email</label>
          <input
            className="border rounded w-full p-2"
            value={email}
            onChange={e => setEmail(e.target.value)}
            type="email"
            placeholder="jane@example.com"
            required
          />
        </div>
        <div>
          <label className="block mb-1 font-medium">Message</label>
          <textarea
            className="border rounded w-full p-2"
            value={message}
            onChange={e => setMessage(e.target.value)}
            rows={5}
            placeholder="How can we help you?"
            required
          />
        </div>
        <button
          type="submit"
          className="bg-black text-white px-6 py-2 rounded hover:bg-gray-800 mt-2"
        >
          Send Message
        </button>
      </form>
    </div>
  );
}

=== FILE: ./src/app/custom-order/page.tsx ===

// === FILE: src/app/custom-order/page.tsx
// This file defines a custom order form for users to submit their custom garment requests.
"use client";

import { useState } from "react";
import { useRouter } from "next/navigation";
import UploadButton from "@/components/UploadButton";

export default function CustomOrderForm() {
  const [form, setForm] = useState<any>({});
  const router = useRouter();
  const [designImages, setDesignImages] = useState<string[]>([]);

  const handleChange = (e: React.ChangeEvent<any>) => {
    const { name, value, type, checked } = e.target;
    setForm((prev: any) => ({
      ...prev,
      [name]: type === "checkbox" ? checked : value,
    }));
  };

  const handleSubmit = async (e: React.FormEvent) => {
    e.preventDefault();
    const res = await fetch("/api/custom-order", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ ...form, designImages }),
    });
    if (res.ok) {
      alert("Your custom order has been submitted successfully!");
      setForm({});
      setDesignImages([]);
      router.push("/"); // Redirect to home or another page
    } else {
      const errorData = await res.json();
      alert(`Error submitting form: ${errorData.message || "Unknown error"}`);
    }
  };

  return (
    <div className="mt-30 m-5">
      <h1 className="text-3xl font-sans font-light mb-6 text-center text-gray-600">
        Custom Order Form
      </h1>
      <form
        onSubmit={handleSubmit}
        className="mx-auto pb-20 px-4 grid grid-cols-1 md:grid-cols-2 gap-8 text-gray-800"
      >
        {/* --- Begin: Garment & Design Section (Card 1) --- */}
        <div className="bg-white rounded-2xl shadow-md border border-gray-100 p-6 space-y-4">
          <h2 className="font-sans text-xl font-light mb-2">Garment Details</h2>
          {/* Garment Type */}
          <label className="block font-medium">Garment Type</label>
          <select
            name="garmentType"
            onChange={handleChange}
            className="w-full border p-2 rounded"
          >
            <option value="">Select...</option>
            <option>Dress</option>
            <option>Top</option>
            <option>Pants</option>
            <option>Skirt</option>
            <option>Jacket</option>
            <option>Romper</option>
            <option>Jumpsuit</option>
            <option>Matching set</option>
            <option>Other</option>
          </select>
          <input
            name="otherGarment"
            placeholder="Other (specify)"
            onChange={handleChange}
            className="w-full border p-2 rounded"
          />

          {/* Fabric & Color */}
          <div className="flex gap-4">
            <input
              name="fabric"
              placeholder="Fabric"
              onChange={handleChange}
              className="w-full border p-2 rounded"
            />
            <input
              name="color"
              placeholder="Color"
              onChange={handleChange}
              className="w-full border p-2 rounded"
            />
          </div>

          {/* Design Details */}
          <textarea
            name="designDetails"
            placeholder="Design Details (include link if any)"
            onChange={handleChange}
            className="w-full border p-2 rounded"
          />
          {/* Occasion */}
          <input
            name="occasion"
            placeholder="Occasion (optional)"
            onChange={handleChange}
            className="w-full border p-2 rounded mt-4"
          />
          {/* Inspiration Images */}
          <label className="block font-medium mt-4">
            Upload Inspiration Images{" "}
            <span className="font-normal text-gray-500 text-xs">
              (up to 4, optional)
            </span>
          </label>
          <UploadButton
            onUploadComplete={(urls) => setDesignImages(urls.slice(0, 4))}
          />
          {/* Show thumbnails of uploaded images */}
          {designImages.length > 0 && (
            <div className="flex gap-2 mt-2 flex-wrap">
              {designImages.map((url, i) => (
                <div
                  key={url}
                  className="relative w-24 h-24 border rounded overflow-hidden bg-gray-100"
                >
                  <img
                    src={url}
                    alt={`Design Inspiration ${i + 1}`}
                    className="w-full h-full object-cover"
                  />
                  <button
                    type="button"
                    className="absolute top-0 right-0 bg-white/80 hover:bg-red-500 hover:text-white text-xs px-1 py-0.5 rounded-bl"
                    onClick={() =>
                      setDesignImages((prev) =>
                        prev.filter((_, idx) => idx !== i)
                      )
                    }
                    aria-label="Remove image"
                  >
                    
                  </button>
                </div>
              ))}
            </div>
          )}
        </div>
        <div className="bg-white rounded-2xl shadow-md border border-gray-100 p-6 space-y-4">
          <h2 className="font-sans text-xl font-light mb-2">Measurements</h2>

          {/* Required Measurements */}
          <label className="block font-medium">Required Measurements</label>
          <div className="grid grid-cols-1 sm:grid-cols-2 gap-4">
            <select
              name="size"
              onChange={handleChange}
              className="border p-2 rounded w-full"
            >
              <option value="">Size</option>
              <option>XXS</option>
              <option>XS</option>
              <option>S</option>
              <option>M</option>
              <option>L</option>
              <option>XL</option>
              <option>XXL</option>
              <option>Other</option>
            </select>
            <input
              name="customSize"
              placeholder="Other size (if any)"
              onChange={handleChange}
              className="border p-2 rounded w-full"
            />
            <input
              name="waist"
              placeholder="Waist"
              onChange={handleChange}
              className="border p-2 rounded w-full"
            />
            <input
              name="bust"
              placeholder="Bust"
              onChange={handleChange}
              className="border p-2 rounded w-full"
            />
            <input
              name="hips"
              placeholder="Hips"
              onChange={handleChange}
              className="border p-2 rounded w-full"
            />
            <input
              name="height"
              placeholder="Height"
              onChange={handleChange}
              className="border p-2 rounded w-full"
            />
          </div>

          {/* Optional Measurements */}
          <label className="block font-medium mt-6">
            Optional Measurements
          </label>
          <div className="grid grid-cols-1 sm:grid-cols-2 gap-4">
            <select
              name="braBand"
              onChange={handleChange}
              className="border p-2 rounded w-full"
            >
              <option value="">Bra Band Size</option>
              {["28", "30", "32", "34", "36", "38", "40", "42", "44"].map(
                (size) => (
                  <option key={size}>{size}</option>
                )
              )}
            </select>
            <select
              name="braCup"
              onChange={handleChange}
              className="border p-2 rounded w-full"
            >
              <option value="">Bra Cup Size</option>
              {["A", "B", "C", "D", "DD", "E", "F", "G"].map((cup) => (
                <option key={cup}>{cup}</option>
              ))}
            </select>
            {/* Additional optional fields */}
            <input
              name="underBust"
              placeholder="Under Bust"
              onChange={handleChange}
              className="border p-2 rounded w-full"
            />
            <input
              name="shoulderSpan"
              placeholder="Shoulder Span"
              onChange={handleChange}
              className="border p-2 rounded w-full"
            />
            <input
              name="inseam"
              placeholder="Inseam"
              onChange={handleChange}
              className="border p-2 rounded w-full"
            />
            <input
              name="armLength"
              placeholder="Arm Length"
              onChange={handleChange}
              className="border p-2 rounded w-full"
            />
            <input
              name="bicep"
              placeholder="Bicep"
              onChange={handleChange}
              className="border p-2 rounded w-full"
            />
            <input
              name="wrist"
              placeholder="Wrist"
              onChange={handleChange}
              className="border p-2 rounded w-full"
            />
            <input
              name="neckCircumference"
              placeholder="Neck Circumference"
              onChange={handleChange}
              className="border p-2 rounded w-full"
            />
            <input
              name="thigh"
              placeholder="Thigh"
              onChange={handleChange}
              className="border p-2 rounded w-full"
            />
            <input
              name="calf"
              placeholder="Calf"
              onChange={handleChange}
              className="border p-2 rounded w-full"
            />
            <input
              name="shoulderToWaist"
              placeholder="Shoulder to Waist"
              onChange={handleChange}
              className="border p-2 rounded w-full"
            />
          </div>
          <textarea
            name="otherMeasurements"
            placeholder="Any other measurements"
            onChange={handleChange}
            className="w-full border p-2 rounded mt-2"
          />
        </div>
        <div className="bg-white rounded-2xl shadow-md border border-gray-100 p-6 space-y-4">
          <h2 className="font-sans text-xl font-light mb-2">
            Features and Construction
          </h2>
          <h2 className="font-sans text-xl font-light mt-6 mb-2">Pockets</h2>
          <div className="space-y-2">
            {["No pockets", "Hidden/secret pockets"].map((option) => (
              <label key={option} className="flex items-center">
                <input
                  type="checkbox"
                  name={option}
                  onChange={handleChange}
                  className="mr-2"
                />
                {option}
              </label>
            ))}
            <input
              name="pocketOther"
              placeholder="Other (pockets)"
              onChange={handleChange}
              className="w-full border p-2 rounded mt-1"
            />
          </div>

          <h2 className="font-sans text-xl font-light mt-6 mb-2">Closures</h2>
          <div className="space-y-2">
            {[
              "Zipper (exposed)",
              "Zipper (hidden/invisible)",
              "Buttons (functional)",
              "Buttons (decorative)",
              "Hook & eye",
              "Lacing",
              "Snaps",
              "Velcro",
              "Tie closure",
            ].map((option) => (
              <label key={option} className="flex items-center">
                <input
                  type="checkbox"
                  name={option}
                  onChange={handleChange}
                  className="mr-2"
                />
                {option}
              </label>
            ))}
            <input
              name="closureOther"
              placeholder="Other (closure)"
              onChange={handleChange}
              className="w-full border p-2 rounded mt-1"
            />
          </div>

          <h2 className="font-sans text-xl font-light mt-6 mb-2">Lining</h2>
          <label className="flex items-center">
            <input
              type="checkbox"
              name="lining"
              onChange={handleChange}
              className="mr-2"
            />
            Include Lining
          </label>
          <input
            name="liningOther"
            placeholder="Other (lining)"
            onChange={handleChange}
            className="w-full border p-2 rounded mt-1"
          />

          <h2 className="font-sans text-xl font-light mt-6 mb-2">Fit</h2>
          <div className="space-y-2">
            {["tailored", "tight", "relaxed"].map((option) => (
              <label key={option} className="flex items-center">
                <input
                  type="checkbox"
                  name={option}
                  onChange={handleChange}
                  className="mr-2"
                />
                {option}
              </label>
            ))}
            <input
              name="fitOther"
              placeholder="Other (fit)"
              onChange={handleChange}
              className="w-full border p-2 rounded mt-1"
            />
          </div>

          <textarea
            name="additionalInfo"
            placeholder="Any additional instructions or comments"
            onChange={handleChange}
            className="w-full border p-2 rounded mt-6"
          />
          

        </div>
        <div className="bg-white rounded-2xl shadow-md border border-gray-100 p-6 space-y-4">
          <h2 className="font-sans text-xl font-light mb-2">
            Budget & Timeline
          </h2>
          <div className="grid grid-cols-1 sm:grid-cols-2 gap-4">
            <input
              name="budget"
              placeholder="Budget Range"
              onChange={handleChange}
              className="border p-2 rounded w-full"
            />
            <input
              name="deadline"
              placeholder="Ideal Deadline or Event Date"
              onChange={handleChange}
              className="border p-2 rounded w-full"
            />
            <div>
            <select
              name="rushOrder"
              onChange={handleChange}
              className="border p-2 rounded w-full"
            >
              <option value="">Rush Order?</option>
              <option>Yes</option>
              <option>No</option>
            </select>
            </div>
            <div className="space-y-2">
            {[
              "Fabric Swatch Approval",
              "Sketch Approval",
              "Progress updates (messages)",
              "Progress updates (photos)",
              "None (surprise me)",
            ].map((option) => (
              <label key={option} className="flex items-center">
                <input
                  type="checkbox"
                  name={option}
                  onChange={handleChange}
                  className="mr-2"
                />
                {option}
              </label>
            ))}
            <input
              name="followUpOther"
              placeholder="Other (follow-up)"
              onChange={handleChange}
              className="w-full border p-2 rounded mt-1"
            />
          </div>
          </div>
              
          <h2 className="font-sans text-xl font-light mt-6 mb-2 text-center">
            Customer Info
          </h2>
          <div className="grid grid-cols-1 sm:grid-cols-2 gap-4">
            <input
              name="name"
              placeholder="Name"
              onChange={handleChange}
              className="border p-2 rounded w-full"
            />
            <input
              name="phone"
              placeholder="Phone Number"
              onChange={handleChange}
              className="border p-2 rounded w-full"
            />
            <input
              name="email"
              placeholder="Email"
              onChange={handleChange}
              className="border p-2 rounded w-full"
            />
            <input
              name="preferredContact"
              placeholder="Preferred Contact Method"
              onChange={handleChange}
              className="border p-2 rounded w-full"
            />
          </div>
          {/* --- Submit Button --- */}
          <div className="pt-2 text-center">
            <button
              type="submit"
              className="bg-black text-white px-6 py-2 rounded hover:bg-gray-800 text-lg font-medium transition-all"
            >
              Submit
            </button>
          </div>
        </div>
        {/* --- End: Budget, Timeline & Final Details (Card 4) --- */}
      </form>
    </div>
  );
}

=== FILE: ./src/app/favicon.ico ===

=== FILE: ./src/app/globals.css ===

/**
 * /src/app/globals.css
 * This file contains global styles for the application.
 */

@import "tailwindcss";

@theme inline {
  --color-background: var(--background);
  --color-foreground: var(--foreground);
  --font-sans: var(--font-geist-sans);
  --font-mono: var(--font-geist-mono);
}

body {
  background: var(--background);
  color: var(--foreground);
  font-family: Arial, Helvetica, sans-serif;
}

=== FILE: ./src/app/layout.tsx ===

// === FILE: src/app/layout.tsx ===
// This file defines the root layout for the Next.js application, including global styles and session management

import type { Metadata } from "next";
import { Geist, Geist_Mono, Montserrat } from "next/font/google";
import "./globals.css";
import SessionWrapper from "@/components/SessionWrapper";
import Header from "@/components/header";
import { CartProvider } from "@/utils/CartContext";
import Footer from "@/components/footer";

const geistSans = Geist({
  variable: "--font-geist-sans",
  subsets: ["latin"],
});

const geistMono = Geist_Mono({
  variable: "--font-geist-mono",
  subsets: ["latin"],
});

const montserrat = Montserrat({
  variable: "--font-montserrat",
  subsets: ["latin"],
  weight: ["100", "200", "300", "400", "500", "600", "700", "800", "900"],
});

export const metadata: Metadata = {
  title: "Create Next App",
  description: "Generated by create next app",
};

export default function RootLayout({
  children,
}: Readonly<{
  children: React.ReactNode;
}>) {
  return (
    <html lang="en">
      <body
        className={`${geistSans.variable} ${geistMono.variable} ${montserrat.variable} antialiased min-h-screen flex flex-col bg-white`}
      >
        {/*<div className="fixed inset-0 -z-10">
           Background image 
          <img
            src="/SisBG.jpg"
            alt="Background"
            className="w-full h-full object-top"
            style={{ filter: "brightness(0.7)" }}
          />

          <div className="absolute inset-0 bg-gradient-to-b from-black/60 via-black/30 to-black/70 pointer-events-none" />
        </div>*/}
        <SessionWrapper>
          <CartProvider>
            <Header />
            <main className="flex-1">{children}</main>
            <Footer />
          </CartProvider>
        </SessionWrapper>
      </body>
    </html>
  );
}

=== FILE: ./src/app/legal/page.tsx ===

// === FILE: src/app/legal/page.tsx ===

export default function LegalPage() {
  return (
    <div className="max-w-2xl mx-auto px-6 py-16">
      <h1 className="text-3xl font-bold mb-6 text-center">Legal Notice & Policies</h1>

      <section className="mb-8">
        <h2 className="text-xl font-semibold mb-2">Copyright</h2>
        <p>
          &copy; {new Date().getFullYear()} Olipopper Studios. All rights reserved.  
          All site content, designs, and patterns are the property of Olipopper Studios and may not be reproduced without permission.
        </p>
      </section>

      <section className="mb-8">
        <h2 className="text-xl font-semibold mb-2">Terms of Service</h2>
        <p>
          By using this website, you agree not to resell, redistribute, or commercially reproduce any patterns or products
          purchased here. All items are for personal, non-commercial use unless otherwise stated.
        </p>
      </section>

      <section className="mb-8">
        <h2 className="text-xl font-semibold mb-2">Privacy Policy</h2>
        <p>
          We respect your privacy. Your personal information is used solely for order processing and site communication, and is never sold to third parties. For questions about your data, contact us at <a href="mailto:contact@olipopperstudios.com" className="text-blue-600 underline">contact@olipopperstudios.com</a>.
        </p>
      </section>

      <section>
        <h2 className="text-xl font-semibold mb-2">Contact</h2>
        <p>
          For legal inquiries or support, please email <a href="mailto:contact@olipopperstudios.com" className="text-blue-600 underline">contact@olipopperstudios.com</a>.
        </p>
      </section>
    </div>
  );
}

=== FILE: ./src/app/page.tsx ===

// === FILE: src/app/page.tsx ===
// Home page: shows 3 newest products, then about/info section.

"use client";

import { useEffect, useState } from "react";
import Link from "next/link";

// Product type (can import if you have a shared one)
interface Product {
  id: number;
  name: string;
  description?: string;
  price: number;
  images: { url: string; altText?: string }[];
}

export default function Home() {
  const [products, setProducts] = useState<Product[]>([]);

  // Fetch newest 3 products
  useEffect(() => {
    fetch("/api/products")
      .then((res) => res.json())
      .then((all) => {
        // Sort by createdAt descending if you want, but for MVP just grab first 3
        setProducts(all.slice(-3).reverse());
      })
      .catch(() => setProducts([]));
  }, []);

  return (
    <div className="w-full flex justify-center pt-32 min-h-screen bg-gray-50">
      <div className="w-[90vw] max-w-[1000px]">
        {/* Newest Products */}
        <h1 className="text-3xl font-light font-sans tracking-tight mt-10 mb-8 text-center text-gray-900">
          New Arrivals
        </h1>
        <div className="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-10 mb-12">
          {products.map((product) => (
            <Link
              key={product.id}
              href={`/products/${product.id}`}
              className="group bg-white rounded-2xl shadow-md border border-gray-100 p-5 flex flex-col h-full transition-all hover:shadow-xl hover:-translate-y-2 focus:ring-2 ring-black/10"
              style={{ textDecoration: "none" }}
            >
              <div className="aspect-[4/5] w-full mb-4 bg-gray-100 rounded-xl overflow-hidden flex items-center justify-center">
                {product.images?.[0]?.url ? (
                  <img
                    src={product.images[0].url}
                    alt={product.images[0].altText || product.name}
                    className="object-cover w-full h-full transition-transform duration-300 group-hover:scale-105"
                  />
                ) : (
                  <div className="w-full h-full flex items-center justify-center text-gray-400 text-lg">
                    No Image
                  </div>
                )}
              </div>
              <div className="flex-1 flex flex-col">
                <h2 className="font-sans font-light text-xl tracking-wide text-gray-900 mb-1 group-hover:underline">
                  {product.name}
                </h2>
                <p className="text-md font-light text-gray-700 mb-2">
                  ${(product.price / 100).toFixed(2)}
                </p>
              </div>
            </Link>
          ))}
        </div>

        {/* Boring About Section */}
        <div className="bg-white rounded-xl shadow-md border border-gray-100 p-8 text-center mx-auto max-w-2xl mb-120">
          <h2 className="text-xl font-sans font-light mb-2 text-gray-800">Welcome to Olipopper Studios</h2>
          <p className="text-gray-600 mb-3">
            Every piece in our shop is thoughtfully designed and handmade by Olivia. Explore our new arrivals, browse categories, or request your own custom order. 
          </p>
          <p className="text-gray-600">
            Questions? Want something unique? <Link href="/custom-order" className="text-blue-700 underline">Request a custom garment</Link> or <Link href="/contact" className="text-blue-700 underline">contact us</Link> for more info.
          </p>
        </div>
      </div>
    </div>
  );
}

=== FILE: ./src/app/products/page.tsx ===

// === FILE: src/app/products/page.tsx ===
// This file displays a list of all products in a grid layout

"use client";

import { useCart } from "@/utils/CartContext";
import { useEffect, useState } from "react";
import Link from "next/link";
import AddToCartButton from "@/components/addToCartButton";

// Product type for context
interface Product {
  id: number;
  name: string;
  description?: string;
  price: number;
  images: { url: string; altText?: string }[];
  isPattern: boolean;
  isActive: boolean;
  tags: string[];
}

export default function ProductsPage() {
  const { addToCart } = useCart();
  const [products, setProducts] = useState<Product[]>([]);

  useEffect(() => {
    fetch("/api/products")
      .then((res) => res.json())
      .then(setProducts)
      .catch(() => console.error("Failed to fetch products"));
  }, []);

  return (
    // Added: Faint gray bg, nav spacing, wide max width
    <div className="w-full flex justify-center bg-[#f9f7f8] pt-32 min-h-screen">
      <div className="w-[90vw] max-w-[1800px]">
        {/* Added: Modern heading */}
        <h1 className="text-3xl font-light font-sans tracking-tight mb-10 text-center text-gray-900">
          All Products
        </h1>

        {/* Added: Grid layout with lots of space */}
        <div className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-10">
          {products.map((product) => (
            // Changed: Elegant, floating card style
            <Link
              key={product.id}
              href={`/products/${product.id}`}
              className="group bg-white rounded-2xl shadow-md border border-gray-100 p-5 flex flex-col h-full transition-all hover:shadow-xl hover:-translate-y-2 focus:ring-2 ring-black/10"
              style={{ textDecoration: "none" }}
            >
              {/* Product Image */}
              <div className="aspect-[4/5] w-full mb-4 bg-gray-100 rounded-xl overflow-hidden flex items-center justify-center">
                {product.images?.[0]?.url ? (
                  <img
                    src={product.images[0].url}
                    alt={product.images[0].altText || product.name}
                    className="object-cover w-full h-full transition-transform duration-300 group-hover:scale-105"
                  />
                ) : (
                  <div className="w-full h-full flex items-center justify-center text-gray-400 text-lg">
                    No Image
                  </div>
                )}
              </div>
              <div className="flex-1 flex flex-col">
                <h2 className="font-sans font-light text-xl tracking-wide text-gray-900 mb-1 group-hover:underline">
                  {product.name}
                </h2>
                <p className="text-md font-light text-gray-700 mb-2">
                  ${(product.price / 100).toFixed(2)}
                </p>
                <p className="text-sm text-gray-600 mb-4 line-clamp-3">
                  {product.description}
                </p>
                {/* Optionally, could put AddToCartButton here, but for a true "archive," just the link is good */}
              </div>
            </Link>
          ))}
        </div>
      </div>
    </div>
  );
}

=== FILE: ./src/app/products/search/[tag]/page.tsx ===

// === FILE: src/app/products/search/[tag]/page.tsx ===
// This file renders a filtered product archive by tag (e.g., /products/search/dresses)
import { notFound } from "next/navigation";
export const dynamic = 'force-dynamic';

// Product interface (as before)
interface Product {
  id: number;
  name: string;
  description?: string;
  price: number;
  images: { url: string; altText?: string }[];
  isPattern: boolean;
  isActive: boolean;
  tags: string[];
}


export default async function ProductTagPage(props: { params: Promise<{ tag: string }> }) {
  const { tag } = await props.params;

  const res = await fetch(
    `${process.env.NEXT_PUBLIC_BASE_URL || ""}/api/products?tag=${encodeURIComponent(tag)}`,
    { cache: "no-store" }
  );
  if (!res.ok) return notFound();
  const products = await res.json();

  return (
    <div className="w-full flex justify-center bg-[#f9f7f8] pt-32 min-h-screen">
      <div className="w-[90vw] max-w-[1800px]">

        <h1 className="text-3xl font-light font-sans tracking-tight mb-10 text-center text-gray-900">
          {`Products tagged: ${tag.charAt(0).toUpperCase() + tag.slice(1)}`}
        </h1>

        <div className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-10">
          {products.map((product: Product) => (
            <a
              key={product.id}
              href={`/products/${product.id}`}
              className="group bg-white rounded-2xl shadow-md border border-gray-100 p-5 flex flex-col h-full transition-all hover:shadow-xl hover:-translate-y-2 focus:ring-2 ring-black/10"
              style={{ textDecoration: "none" }}
            >

              <div className="aspect-[4/5] w-full mb-4 bg-gray-100 rounded-xl overflow-hidden flex items-center justify-center">
                {product.images?.[0]?.url ? (
                  <img
                    src={product.images[0].url}
                    alt={product.images[0].altText || product.name}
                    className="object-cover w-full h-full transition-transform duration-300 group-hover:scale-105"
                  />
                ) : (
                  <div className="w-full h-full flex items-center justify-center text-gray-400 text-lg">
                    No Image
                  </div>
                )}
              </div>
              <div className="flex-1 flex flex-col">
                <h2 className="font-sans font-light text-xl tracking-wide text-gray-900 mb-1 group-hover:underline">
                  {product.name}
                </h2>
                <p className="text-md font-light text-gray-700 mb-2">
                  ${(product.price / 100).toFixed(2)}
                </p>
                <p className="text-sm text-gray-600 mb-4 line-clamp-3">
                  {product.description}
                </p>
              </div>
            </a>
          ))}
        </div>
      </div>
    </div>
  );
}
=== FILE: ./src/app/products/[id]/page.tsx ===

// === FILE: src/app/products/[id]/page.tsx ===
// This file displays a single product page with details and an "Add to Cart" button

import { notFound } from "next/navigation";
import ProductPurchaseSection from "@/components/ProductPurchaseSection";
import SizeGuideRender from "@/components/sizeGuideRender";


interface Product {
  id: number;
  name: string;
  description?: string;
  price: number;
  images: { url: string; altText?: string }[];
  isPattern: boolean;
  isActive: boolean;
  tags: string[];
  sizes?: string[];
}


export default async function ProductSinglePage(props: {
  params: Promise<{ id: string }>;
}) {
  const { params } = props;
  const { id } = await params;

  const res = await fetch(
    `${process.env.NEXT_PUBLIC_BASE_URL || ""}/api/products/${id}`,
    { cache: "no-store" }
  );

  if (!res.ok) return notFound();
  const product = await res.json();
  if (!product) return notFound();

  const flagsRes = await fetch(
    `${process.env.NEXT_PUBLIC_BASE_URL || ""}/api/public/site-flags`,
    { cache: 'no-store' }
  );
  console.log("NEXT_PUBLIC_BASE_URL:", process.env.NEXT_PUBLIC_BASE_URL);

  const { purchasingPaused } = await flagsRes.json();

  console.log("product.sizeGuide:", product.sizeGuide);


  return (
    <div className="w-full flex justify-center bg-[#f9f7f8] pt-32">
      <div className="w-[90vw] max-w-[1800px] flex flex-col md:flex-row gap-12 py-12 md:py-0 px-2 md:px-0">

        <div className="flex-1 flex flex-col gap-8">
          <div className="bg-white rounded-2xl shadow-md border border-gray-100 p-4">
            {product.images && product.images.length > 0 ? (
              product.images.map(
                (img: { url: string; altText?: string }, i: number) => (
                  <img
                    key={i}
                    src={img.url}
                    alt={img.altText || product.name}
                    className="w-full rounded-2xl object-cover max-h-[80vh] shadow-md border mb-4"
                    style={{ background: "#f8f8f8" }}
                  />
                )
              )
            ) : (
              <div className="w-full h-96 bg-gray-200 flex items-center justify-center text-gray-500 rounded-lg">
                No Image
              </div>
            )}
          </div>
        </div>


        <div className="w-full md:w-[32vw] max-w-sm md:pl-2 md:pr-4">
          <div className="md:sticky md:top-32 flex flex-col gap-5">
            <div className="bg-white rounded-2xl shadow-md border border-gray-100 p-6 flex flex-col gap-5">
              <h1 className="font-sans font-light text-3xl tracking-wide mb-1 text-gray-900">
                {product.name}
              </h1>
              <p className="text-2xl font-sans font-light mb-3 text-gray-700">
                ${(product.price / 100).toFixed(2)}
              </p>
              <div className="...">



                <div className="my-4">
                  {product.sizeGuide ? (
                    <SizeGuideRender
                      sizeGuideName={product.sizeGuide.name}
                      tableData={product.sizeGuide.tableData}
                    />
                  ) : null}
                </div>
              </div>
              <p className="mb-2 text-gray-800 font-sans font-light text-base leading-relaxed">
                {product.description}
              </p>
              {product.tags.length > 0 && (
                <div className="mb-2 text-gray-500 font-sans text-sm tracking-wide">
                  <span className="font-semibold text-gray-700">Tags:</span>{" "}
                  {product.tags.join(", ")}
                </div>
              )}
              <ProductPurchaseSection
              product={product}
              purchasingPaused={purchasingPaused}
            />

            {purchasingPaused && (
              <div className="text-sm text-yellow-900 bg-yellow-50 border border-yellow-200 rounded-md p-2">
                Purchasing is temporarily paused. Please check back soon.
              </div>
            )}
            </div>
          </div>
        </div>
      </div>
    </div>
  );
}

=== FILE: ./src/app/user/account/page.tsx ===

// === FILE: src/app/user/account/page.tsx ===

"use client";

import { useSession } from "next-auth/react";
import { useEffect, useState } from "react";
import { signOut } from "next-auth/react";
import ChangePasswordForm from "@/components/ChangePasswordForm";
import ChangeEmailForm from "@/components/ChangeEmailForm";

const IN_PROGRESS_STATUSES = ["paid", "in_progress", "in_transit"];
const HISTORY_STATUSES = ["delivered", "cancelled"];

export default function UserAccountPage() {
  const { data: session, status } = useSession();
  const [orders, setOrders] = useState<any[]>([]);
  const [loadingOrders, setLoadingOrders] = useState(true);
  const [deleting, setDeleting] = useState(false);
  const [deleteError, setDeleteError] = useState("");

  useEffect(() => {
    if (status === "authenticated") {
      setLoadingOrders(true);
      fetch("/api/user/orders")
        .then((res) => res.json())
        .then((data) => setOrders(Array.isArray(data) ? data : []))
        .finally(() => setLoadingOrders(false));
    }
  }, [status]);

  if (status === "loading") return <p>Loading</p>;
  if (!session) return <p>Please log in to view your account.</p>;

  // Split orders into "in progress" and "history"
  const inProgress = orders.filter((o) =>
    IN_PROGRESS_STATUSES.includes(o.status)
  );
  const history = orders.filter((o) => HISTORY_STATUSES.includes(o.status));

  async function handleDeleteAccount() {
    if (
      !window.confirm(
        "Are you sure you want to delete your account? This cannot be undone."
      )
    )
      return;
    setDeleting(true);
    setDeleteError("");
    const res = await fetch("/api/user", { method: "DELETE" });
    if (res.ok) {
      // Account deleted  sign them out
      await signOut({ callbackUrl: "/" }); // Redirects to homepage after logout
    } else {
      const data = await res.json();
      setDeleteError(data.error || "Failed to delete account.");
      setDeleting(false);
    }
  }

  function OrderList({ orders }: { orders: any[] }) {
    if (!orders.length)
      return <p className="text-gray-500">No orders found.</p>;
    return (
      <div className="space-y-4">
        {orders.map((order) => (
          <div key={order.id} className="border rounded p-4 bg-gray-50">
            <div className="mb-1 text-gray-700">
              <span className="font-semibold">Order #</span> {order.id}
              {"  "}
              <span className="font-semibold">Status:</span> {order.status}
              {"  "}
              <span className="font-semibold">Date:</span>{" "}
              {order.createdAt
                ? new Date(order.createdAt).toLocaleDateString()
                : "N/A"}
            </div>
            <div className="text-gray-600 text-sm mb-1">
              <span className="font-semibold">Total: </span>$
              {(order.totalPrice / 100).toFixed(2)}
            </div>
            <div>
              <span className="font-semibold">Items: </span>
              {order.orderItems?.map((oi: any) =>
                oi.product ? (
                  <span key={oi.id} className="mr-2">
                    {oi.product.name} {oi.quantity}
                  </span>
                ) : null
              )}
            </div>
          </div>
        ))}
      </div>
    );
  }

  return (
    <div className="max-w-xl mx-auto mt-20 p-6 bg-white rounded shadow">
      <h1 className="text-2xl font-bold mb-4">Account Details</h1>
      <div className="mb-2">
        <span className="font-semibold">Name: </span>
        {session.user.name || <span className="text-gray-500">N/A</span>}
      </div>
      <div className="mb-2">
        <span className="font-semibold">Email: </span>
        {session.user.email}
      </div>

      <hr className="my-8" />

      <h2 className="text-lg font-semibold mb-2">In Progress</h2>
      {loadingOrders ? (
        <p>Loading orders</p>
      ) : (
        <OrderList orders={inProgress} />
      )}

      <hr className="my-8" />

      <h2 className="text-lg font-semibold mb-2">Order History</h2>
      {loadingOrders ? <p>Loading orders</p> : <OrderList orders={history} />}
      <button
        className="bg-gray-300 text-gray-900 px-4 py-2 rounded mt-8 m-2 hover:bg-gray-400"
        onClick={() => signOut({ callbackUrl: "/" })}
      >
        Logout
      </button>
      <div className="grid gap-8">
        <ChangePasswordForm />
        <ChangeEmailForm />
      </div>
      <button
        className="bg-red-600 text-white px-4 py-2 rounded mt-8 hover:bg-red-700 disabled:opacity-50"
        disabled={deleting}
        onClick={handleDeleteAccount}
      >
        {deleting ? "Deleting" : "Delete Account"}
      </button>
      {deleteError && <p className="text-red-600 mt-2">{deleteError}</p>}
    </div>
  );
}

=== FILE: ./src/app/user/confirm-email-change/page.tsx ===

// src/app/user/confirm-email-change/page.tsx
"use client";
import { Suspense, useEffect, useState } from "react";
import { useSearchParams } from "next/navigation";

export default function ConfirmEmailChangePage() {
  return (
    <Suspense fallback={
      <div className="max-w-md mx-auto mt-20 p-6 border rounded shadow">
        <h1 className="text-2xl font-bold mb-4 text-center">Email change</h1>
        <p className="text-sm">Confirming</p>
      </div>
    }>
      <ConfirmInner />
    </Suspense>
  );
}

function ConfirmInner() {
  const params = useSearchParams();              // now inside Suspense
  const token = params.get("token") || "";
  const [msg, setMsg] = useState("Confirming");

  useEffect(() => {
    const go = async () => {
      if (!token) { setMsg("Invalid link"); return; }
      const res = await fetch("/api/auth/change-email/confirm", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ token }),
      });
      if (res.ok) {
        setMsg("Email updated. Please sign in with your new email.");
        setTimeout(() => { window.location.href = "/user/login"; }, 1200);
      } else {
        const data = await res.json().catch(() => ({}));
        setMsg(data.error || "Invalid or expired link");
      }
    };
    go();
  }, [token]);

  return (
    <div className="max-w-md mx-auto mt-20 p-6 border rounded shadow">
      <h1 className="text-2xl font-bold mb-4 text-center">Email change</h1>
      <p className="text-sm">{msg}</p>
    </div>
  );
}

=== FILE: ./src/app/user/forgot-password/page.tsx ===

"use client";
import { useState } from "react";

export default function ForgotPasswordPage() {
  const [email, setEmail] = useState("");
  const [sent, setSent] = useState(false);
  const [loading, setLoading] = useState(false);

  const submit = async (e: React.FormEvent) => {
    e.preventDefault();
    setLoading(true);
    await fetch("/api/auth/forgot-password", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ email }),
    });
    setSent(true);
    setLoading(false);
  };

  return (
    <div className="max-w-md mx-auto mt-20 p-6 border rounded shadow">
      <h1 className="text-2xl font-bold mb-4 text-center">Forgot password</h1>
      {sent ? (
        <p className="text-sm">If that email exists, we sent instructions.</p>
      ) : (
        <form onSubmit={submit} className="flex flex-col gap-4">
          <input
            type="email"
            placeholder="you@example.com"
            className="border px-3 py-2 rounded"
            value={email}
            onChange={e => setEmail(e.target.value)}
            required
          />
          <button
            type="submit"
            disabled={loading}
            className="bg-black text-white rounded px-4 py-2 hover:bg-gray-800 disabled:opacity-50"
          >
            {loading ? "Sending" : "Send reset link"}
          </button>
        </form>
      )}
    </div>
  );
}

=== FILE: ./src/app/user/login/page.tsx ===

// === FILE: src/app/user/login/page.tsx ===
// This file handles user login functionality using NextAuth

"use client";

import { useState } from "react";
import { useRouter } from "next/navigation";
import { signIn } from "next-auth/react";

export default function LoginPage() {
  const router = useRouter();

  // Track form input and UI state
  const [email, setEmail] = useState("");
  const [password, setPassword] = useState("");
  const [loading, setLoading] = useState(false);
  const [error, setError] = useState("");

  // Handle form submission
  const handleSubmit = async (e: React.FormEvent) => {
    e.preventDefault();
    setLoading(true);
    setError("");

    // Call NextAuth signIn with "credentials" provider
    const res = await signIn("credentials", {
      redirect: false,
      email: email.toLowerCase(),
      password,
    });

    if (res?.error) {
      // Show error from NextAuth response
      setError("Invalid email or password.");
      setLoading(false);
    } else {
      // Redirect to home or admin dashboard
      router.push("/");
    }
  };

  return (
    <div className="max-w-md mx-auto mt-20 p-6 border rounded shadow">
      <h1 className="text-2xl font-bold mb-4 text-center">Log In</h1>

      {/* Show any login errors */}
      {error && <p className="text-red-600 mb-2">{error}</p>}

      {/* Login form */}
      <form onSubmit={handleSubmit} className="flex flex-col gap-4">
        <input
          type="email"
          placeholder="Email"
          value={email}
          required
          onChange={(e) => setEmail(e.target.value)}
          className="border px-3 py-2 rounded"
        />
        <input
          type="password"
          placeholder="Password"
          value={password}
          required
          onChange={(e) => setPassword(e.target.value)}
          className="border px-3 py-2 rounded"
        />
        <button
          type="submit"
          disabled={loading}
          className="bg-black text-white rounded px-4 py-2 hover:bg-gray-800 disabled:opacity-50"
        >
          {loading ? "Logging in..." : "Login"}
        </button>
        <p className="text-sm mt-3">
          <a href="/user/forgot-password" className="underline text-blue-600">
            Forgot your password?
          </a>
        </p>
      </form>
    </div>
  );
}

=== FILE: ./src/app/user/register/page.tsx ===

// === FILE: src/app/user/register/page.tsx ===
// This file handles user registration functionality

"use client";

import React, { useState } from "react";
import { useRouter } from "next/navigation";
import { signIn } from "next-auth/react";

export default function RegisterPage() {
  const router = useRouter();

  // Local state for form inputs and status
  const [email, setEmail] = useState("");
  const [name, setName] = useState("");
  const [password, setPassword] = useState("");
  const [loading, setLoading] = useState(false);
  const [error, setError] = useState("");
  const [success, setSuccess] = useState(false);

  //form submission handler
  const handleSubmit = async (e: React.FormEvent) => {
    e.preventDefault();
    setLoading(true);
    setError("");
    setSuccess(false);

    const res = await fetch("/api/auth/register", {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
      },
      body: JSON.stringify({ email: email.toLowerCase(), name, password }),
    });

    const data = await res.json();
    if (!res.ok) {
      setError(data.error || "Something went wrong");
      setLoading(false);
    } else {
      // Auto-login with credentials after registration!
      const loginRes = await signIn("credentials", {
        redirect: false,
        email: email.toLowerCase(),
        password,
      });

      if (loginRes?.error) {
        setSuccess(true);
        setLoading(false);
        // Show registration success, but login failed
      } else {
        router.push("/user/account"); // or wherever you want to land
      }
    }
  };

  return (
    <div className="max-w-md mx-auto mt-20 p-6 border rounded shadow">
      <h1 className="text-2xl font-bold mb-4 text-center">Create Account</h1>

      {/* Show error or success messages */}
      {error && <p className="text-red-600 mb-2">{error}</p>}
      {success && (
        <p className="text-green-600 mb-2">Account created! Redirecting</p>
      )}

      {/* Registration form */}
      <form onSubmit={handleSubmit} className="flex flex-col gap-4">
        <input
          type="email"
          placeholder="Email"
          value={email}
          required
          onChange={(e) => setEmail(e.target.value)}
          className="border px-3 py-2 rounded"
        />
        <input
          type="text"
          placeholder="Name (optional)"
          value={name}
          onChange={(e) => setName(e.target.value)}
          className="border px-3 py-2 rounded"
        />
        <input
          type="password"
          placeholder="Password"
          value={password}
          required
          onChange={(e) => setPassword(e.target.value)}
          className="border px-3 py-2 rounded"
        />

        {/* Submit button */}
        <button
          type="submit"
          disabled={loading}
          className="bg-black text-white rounded px-4 py-2 hover:bg-gray-800 disabled:opacity-50"
        >
          {loading ? "Creating Account..." : "Register"}
        </button>
      </form>
    </div>
  );
}

=== FILE: ./src/app/user/reset-password/page.tsx ===

// src/app/user/reset-password/page.tsx
"use client";
import { Suspense, useState } from "react";
import { useSearchParams, useRouter } from "next/navigation";

export default function ResetPasswordPage() {
  return (
    <Suspense
      fallback={
        <div className="max-w-md mx-auto mt-20 p-6 border rounded shadow">
          <h1 className="text-2xl font-bold mb-4 text-center">Set a new password</h1>
          <p className="text-sm">Loading</p>
        </div>
      }
    >
      <ResetInner />
    </Suspense>
  );
}

function ResetInner() {
  const params = useSearchParams(); // now inside Suspense
  const router = useRouter();
  const token = params.get("token") || "";
  const email = params.get("email") || "";

  const [pwd, setPwd] = useState("");
  const [confirm, setConfirm] = useState("");
  const [loading, setLoading] = useState(false);
  const [msg, setMsg] = useState("");

  const submit = async (e: React.FormEvent) => {
    e.preventDefault();
    if (pwd !== confirm) { setMsg("Passwords do not match"); return; }
    setLoading(true);
    const res = await fetch("/api/auth/reset-password", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ email, token, newPassword: pwd }),
    });
    setLoading(false);
    if (res.ok) {
      setMsg("Password updated. You can log in now.");
      setTimeout(() => router.push("/user/login"), 1000);
    } else {
      const data = await res.json().catch(() => ({}));
      setMsg(data.error || "Invalid or expired link");
    }
  };

  return (
    <div className="max-w-md mx-auto mt-20 p-6 border rounded shadow">
      <h1 className="text-2xl font-bold mb-4 text-center">Set a new password</h1>
      {!token || !email ? (
        <p className="text-sm text-red-600">Invalid reset link.</p>
      ) : (
        <form onSubmit={submit} className="flex flex-col gap-4">
          <input
            type="password"
            placeholder="New password (min 8 chars)"
            className="border px-3 py-2 rounded"
            value={pwd}
            onChange={e => setPwd(e.target.value)}
            minLength={8}
            required
          />
          <input
            type="password"
            placeholder="Confirm new password"
            className="border px-3 py-2 rounded"
            value={confirm}
            onChange={e => setConfirm(e.target.value)}
            minLength={8}
            required
          />
          <button
            type="submit"
            disabled={loading}
            className="bg-black text-white rounded px-4 py-2 hover:bg-gray-800 disabled:opacity-50"
          >
            {loading ? "Saving" : "Reset password"}
          </button>
          {msg && <p className="text-sm">{msg}</p>}
        </form>
      )}
    </div>
  );
}

// If build still tries to prerender and complains, add this line below "use client":
// export const dynamic = "force-dynamic";

=== FILE: ./src/components/addToCartButton.tsx ===

// === FILE: src/components/addToCartButton.tsx ===

'use client';

import { useCart } from "@/utils/CartContext";
import { useState } from "react";

export default function AddToCartButton({
  product,
  size,
  disabled,
}: {
  product: any;
  size?: string;
  disabled?: boolean;
}) {
  const { addToCart } = useCart();
  const [adding, setAdding] = useState(false);

  const handleAdd = () => {
    setAdding(true);
    addToCart({
      productId: product.id,
      name: product.name,
      price: product.price,
      quantity: 1,
      image: product.images?.[0]?.url || "",
      ...(size && { size }),
    });
    console.log("Added to cart:", {
      productId: product.id,
      name: product.name,
      price: product.price,
      quantity: 1,
      image: product.images?.[0]?.url || "",
      ...(size && { size }),
    });
    setAdding(false);
  };

  return (
    <button
      onClick={handleAdd}
      disabled={!!disabled || adding}
      className={`mt-2 bg-black text-white px-4 py-2 rounded hover:bg-gray-800 disabled:opacity-60 transition`}
    >
      {adding ? "Adding..." : "Add to Cart"}
    </button>
  );
}

=== FILE: ./src/components/ChangeEmailForm.tsx ===

"use client";

import { useState } from "react";

export default function ChangeEmailForm() {
  const [currentPassword, setPwd] = useState("");
  const [newEmail, setNewEmail] = useState("");
  const [loading, setLoading] = useState(false);
  const [msg, setMsg] = useState<string | null>(null);

  const submit = async (e: React.FormEvent) => {
    e.preventDefault();
    setMsg(null);
    setLoading(true);
    try {
      const res = await fetch("/api/auth/change-email/initiate", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ currentPassword, newEmail }),
      });
      if (!res.ok) {
        const data = await res.json().catch(() => ({}));
        throw new Error(data.error || "Failed to start email change");
      }
      setMsg("Check your new email for a confirmation link.");
      setPwd("");
    } catch (err: any) {
      setMsg(err.message || "Something went wrong");
    } finally {
      setLoading(false);
    }
  };

  return (
    <div className="border rounded-xl shadow p-5">
      <h2 className="text-lg font-semibold mb-3">Change email</h2>
      <form onSubmit={submit} className="flex flex-col gap-3">
        <input
          type="email"
          className="border rounded px-3 py-2"
          placeholder="New email"
          value={newEmail}
          onChange={(e) => setNewEmail(e.target.value)}
          required
          autoComplete="email"
        />
        <input
          type="password"
          className="border rounded px-3 py-2"
          placeholder="Current password (for verification)"
          value={currentPassword}
          onChange={(e) => setPwd(e.target.value)}
          required
          autoComplete="current-password"
        />
        <div className="flex items-center gap-2">
          <button
            type="submit"
            disabled={loading}
            className="bg-black text-white rounded px-4 py-2 disabled:opacity-50 hover:bg-gray-800"
          >
            {loading ? "Sending" : "Send confirmation link"}
          </button>
          {msg && <p className="text-sm">{msg}</p>}
        </div>
      </form>
    </div>
  );
}

=== FILE: ./src/components/ChangePasswordForm.tsx ===

"use client";

import { useState } from "react";

export default function ChangePasswordForm() {
  const [currentPassword, setCurrent] = useState("");
  const [newPassword, setNext] = useState("");
  const [confirm, setConfirm] = useState("");
  const [loading, setLoading] = useState(false);
  const [msg, setMsg] = useState<string | null>(null);

  const submit = async (e: React.FormEvent) => {
    e.preventDefault();
    setMsg(null);

    if (newPassword !== confirm) {
      setMsg("New passwords do not match");
      return;
    }
    if (newPassword.length < 8) {
      setMsg("New password must be at least 8 characters");
      return;
    }

    setLoading(true);
    try {
      const res = await fetch("/api/auth/change-password", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ currentPassword, newPassword }),
      });
      if (!res.ok) {
        const data = await res.json().catch(() => ({}));
        throw new Error(data.error || "Failed to change password");
      }
      setMsg("Password updated. You will need to sign in again.");
      setCurrent("");
      setNext("");
      setConfirm("");
      // optional: force re-login after a short delay
      setTimeout(() => { window.location.href = "/user/login"; }, 1200);
    } catch (err: any) {
      setMsg(err.message || "Something went wrong");
    } finally {
      setLoading(false);
    }
  };

  return (
    <div className="border rounded-xl shadow p-5">
      <h2 className="text-lg font-semibold mb-3">Change password</h2>
      <form onSubmit={submit} className="flex flex-col gap-3">
        <input
          type="password"
          className="border rounded px-3 py-2"
          placeholder="Current password"
          value={currentPassword}
          onChange={(e) => setCurrent(e.target.value)}
          required
          autoComplete="current-password"
        />
        <input
          type="password"
          className="border rounded px-3 py-2"
          placeholder="New password (min 8 chars)"
          value={newPassword}
          onChange={(e) => setNext(e.target.value)}
          required
          autoComplete="new-password"
          minLength={8}
        />
        <input
          type="password"
          className="border rounded px-3 py-2"
          placeholder="Confirm new password"
          value={confirm}
          onChange={(e) => setConfirm(e.target.value)}
          required
          autoComplete="new-password"
          minLength={8}
        />
        <div className="flex items-center gap-2">
          <button
            type="submit"
            disabled={loading}
            className="bg-black text-white rounded px-4 py-2 disabled:opacity-50 hover:bg-gray-800"
          >
            {loading ? "Saving..." : "Update password"}
          </button>
          {msg && <p className="text-sm">{msg}</p>}
        </div>
      </form>
    </div>
  );
}

=== FILE: ./src/components/footer.tsx ===

// === FILE: src/components/Footer.tsx ===

import Link from "next/link";

export default function Footer() {
  return (
      <footer className="bg-gray-950 text-gray-200 py-10">
        <div className="max-w-7xl mx-auto px-6 flex flex-col md:flex-row justify-between gap-10 md:gap-0 items-start">
          {/* Site Directory */}
          <div>
            <h3 className="font-bold text-lg mb-3 tracking-wide text-white">
              Site Directory
            </h3>
            <ul className="space-y-2">
              <li>
                <Link href="/" className="hover:underline">
                  Home
                </Link>
              </li>
              <li>
                <Link href="/products" className="hover:underline">
                  Shop
                </Link>
              </li>
              <li>
                <Link href="/custom-order" className="hover:underline">
                  Custom Order
                </Link>
              </li>
              <li>
                <Link href="/contact" className="hover:underline">
                  Contact
                </Link>
              </li>
              <li>
                <Link href="/legal" className="hover:underline">
                  Legal
                </Link>
              </li>
              <li>
                <Link href="/user/account" className="hover:underline">
                  My Account
                </Link>
              </li>
            </ul>
          </div>

          {/* Info */}
          <div>
            <h3 className="font-bold text-lg mb-3 tracking-wide text-white">
              About Olipopper Studios
            </h3>
            <p className="text-gray-400 text-sm max-w-xs">
              Unique handmade clothing, patterns, and custom projects from
              Olipopper Studios. Built for creative people, by creative people.
            </p>
          </div>

          {/* Copyright */}
          <div className="mt-10 md:mt-0 text-xs text-gray-500">
            &copy; {new Date().getFullYear()} Olipopper Studios. All rights
            reserved.
          </div>
        </div>
      </footer>
  );
}

=== FILE: ./src/components/header.tsx ===

// src/components/Header.tsx
import Nav from "./Nav";
import { getPurchasingPaused } from "@/lib/siteSettings";

export default async function Header() {
    console.log("NEXT_PUBLIC_BASE_URL:", process.env.NEXT_PUBLIC_BASE_URL);

  const res = await fetch(`${process.env.NEXT_PUBLIC_BASE_URL}/api/public/site-flags`, {
    cache: "no-store",
  });
  const { purchasingPaused } = await res.json();
  return (
    <header className="border-b border-gray-200">
      {purchasingPaused && (
        <div className="bg-yellow-100 text-yellow-900 text-center py-2 text-sm">
          Purchasing is temporarily paused while we do maintenance. Thanks for your patience.
        </div>
      )}
      <Nav />
    </header>
  );
}

=== FILE: ./src/components/MediaLibraryPicker.tsx ===

// === FILE: src/components/MediaLibraryPicker.tsx ===
// This file defines a media library picker component that allows users to select images from their uploaded media

'use client';

import { useEffect, useState } from 'react';

export default function MediaLibraryPicker({
  onSelect,
}: {
  onSelect: (url: string) => void;
}) {
  const [images, setImages] = useState<string[]>([]);
  const [loading, setLoading] = useState(true);

  useEffect(() => {
    fetch('/api/media-library')
      .then(res => res.json())
      .then(data => {
        setImages(data.map((img: any) => img.url));
      })
      .finally(() => setLoading(false));
  }, []);

  if (loading) return <p className="text-sm text-gray-500">Loading media library</p>;

  if (images.length === 0) return <p className="text-sm text-gray-500">No uploaded images yet.</p>;

  return (
    <div className="grid grid-cols-3 sm:grid-cols-4 gap-2 mt-2">
      {images.map((url, i) => (
        <button
          key={i}
          onClick={() => onSelect(url)}
          type="button"
          className="border border-gray-300 rounded hover:border-black"
        >
          <img src={url} alt={`media-${i}`} className="w-full h-24 object-cover rounded" />
        </button>
      ))}
    </div>
  );
}

=== FILE: ./src/components/Nav.tsx ===

// === FILE: src/components/Nav.tsx ===
// This file contains the navigation bar component with sticky, glassy design and responsive behavior

"use client";

import Link from "next/link";
import { useSession, signOut } from "next-auth/react";
import { useCart } from "@/utils/CartContext";
import { useEffect, useRef, useState } from "react";

export default function Nav() {
  const { data: session, status } = useSession();
  const { cart } = useCart();
  const itemCount = cart.reduce((sum, item) => sum + item.quantity, 0);

  // --- Sticky, Hide-on-Scroll Logic ---
  const [showNav, setShowNav] = useState(true);
  const lastScroll = useRef(0);
  const [showMobileMenu, setShowMobileMenu] = useState(false);
  const retractTimer = useRef<NodeJS.Timeout | null>(null);

  useEffect(() => {
    let ticking = false;
    const handleScroll = () => {
      if (!ticking) {
        window.requestAnimationFrame(() => {
          const current = window.scrollY;
          if (current <= 10) {
            setShowNav(true);
          } else if (current > lastScroll.current) {
            setShowNav(false);
          } else {
            setShowNav(true);
          }
          lastScroll.current = current;
          ticking = false;
        });
        ticking = true;
      }
    };
    window.addEventListener("scroll", handleScroll, { passive: true });
    return () => window.removeEventListener("scroll", handleScroll);
  }, []);

  // --- Style: sticky, glassy, minimalist nav ---
  return (
    <nav
      className={`
        fixed top-0 left-0 w-full z-50 transition-transform duration-300
        ${showNav ? "translate-y-0" : "-translate-y-full"}
        bg-white/60 backdrop-blur-xl border-b border-black/10
        shadow-sm px-0 py-0
      `}
      style={{
        background: "rgba(255,255,255,0.70)",
        backdropFilter: "blur(12px)",
      }}
    >
      {/* --- Top Row: Brand (center), Cart/Auth (right), Hamburger (left on mobile) --- */}
      <div className="flex items-center justify-between w-full px-4 py-2 md:py-3">
        {/* Left: Hamburger on mobile, empty div on desktop */}
        <div className="flex-1 flex items-center">
          {/* Hamburger: visible on mobile only */}
          <button
            className="md:hidden text-3xl text-black focus:outline-none"
            onClick={() => setShowMobileMenu((prev) => !prev)}
            aria-label={showMobileMenu ? "Close menu" : "Open menu"}
          >
            {showMobileMenu ? "" : ""}
          </button>
          {/* Empty block on desktop to keep layout symmetrical */}
          <div className="hidden md:block" />
        </div>

        {/* Centered Brand */}
        <div className="flex-1 flex justify-center items-center">
          <Link
            href="/"
            className="font-sans font-light text-3xl md:text-4xl tracking-tight hover:opacity-80 transition text-black"
            style={{ letterSpacing: "0.02em" }}
          >
            Olipopper Studios
          </Link>
        </div>

        {/* Cart and Auth */}
        <div className="flex-1 flex justify-end items-center gap-6 text-black">
          <Link
            href="/cart"
            className="relative hover:opacity-80 transition"
            aria-label="Cart"
          >
            <span role="img" aria-label="cart" className="text-xl">
              
            </span>
            {itemCount > 0 && (
              <span className="absolute -top-2 -right-2 bg-red-600 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center">
                {itemCount}
              </span>
            )}
          </Link>
          {status === "authenticated" ? (
            <>
              <span className="mr-2 text-sm truncate max-w-[100px] hidden md:inline">
                Hello, {session.user.name || session.user.email}
              </span>
              <a
                href="/user/account"
                className="text-blue-600 hover:underline hover:opacity-80 transition"
              >
                Account
              </a>
              <button
                onClick={() => signOut()}
                className="text-blue-600 hover:underline hover:opacity-80 transition text-sm mr-2"
              >
                Logout
              </button>
            </>
          ) : (
            <>
              <Link
                href="/user/login"
                className="text-blue-600 hover:underline hover:opacity-80 transition text-sm mr-4"
              >
                Login
              </Link>
              <Link
                href="/user/register"
                className="text-blue-600 hover:underline hover:opacity-80 transition text-sm"
              >
                Register
              </Link>
            </>
          )}
        </div>
      </div>

      {/* --- Bottom Row: Product Categories + Admin --- */}
      {/* Shown as normal on desktop, hidden on mobile unless open */}
      <div className="w-full border-t border-black/10 bg-transparent">
        {/* Desktop nav: visible md+, hidden on mobile */}
        <div className="hidden md:flex flex-wrap justify-center items-center gap-6 md:gap-8 px-4 py-2 text-base md:text-lg font-sans font-light text-black whitespace-nowrap">
          <Link
            href="/products"
            className="hover:underline hover:opacity-80 transition"
          >
            All
          </Link>
          <Link
            href="/products/search/dress"
            className="hover:underline hover:opacity-80 transition"
          >
            Dresses
          </Link>
          <Link
            href="/products/search/top"
            className="hover:underline hover:opacity-80 transition"
          >
            Tops
          </Link>
          <Link
            href="/products/search/bottom"
            className="hover:underline hover:opacity-80 transition"
          >
            Bottoms
          </Link>
          <Link
            href="/products/search/set"
            className="hover:underline hover:opacity-80 transition"
          >
            Sets
          </Link>
          <Link
            href="/products/search/outerwear"
            className="hover:underline hover:opacity-80 transition"
          >
            Outerwear
          </Link>
          <Link
            href="/products/search/accessories"
            className="hover:underline hover:opacity-80 transition"
          >
            Accessories
          </Link>
          <Link
            href="/products/search/pattern"
            className="hover:underline hover:opacity-80 transition"
          >
            Patterns DIY
          </Link>
          <Link
            href="/custom-order"
            className="hover:underline hover:opacity-80 transition"
          >
            Custom Order
          </Link>
          {session?.user?.role === "admin" && (
            <div className="flex gap-4 ml-4 text-red-600 font-semibold">
              <Link href="/admin" className="hover:underline">
                Admin
              </Link>
              <Link href="/admin/orders" className="hover:underline">
                Orders
              </Link>
              <Link href="/admin/size-guide" className="hover:underline">
                Sizing Guides
              </Link>
            </div>
          )}
        </div>
        {/* Mobile nav: visible only on mobile when menu is open */}
        {showMobileMenu && (
          <div className="md:hidden bg-white/90 backdrop-blur-xl px-6 py-4 flex flex-col gap-4 shadow-md border-b border-black/10 animate-fadeIn text-gray-800">
            <Link
              href="/products"
              className="py-2 border-b border-gray-100"
              onClick={() => setShowMobileMenu(false)}
            >
              All
            </Link>
            <Link
              href="/products/search/dress"
              className="py-2 border-b border-gray-100"
              onClick={() => setShowMobileMenu(false)}
            >
              Dresses
            </Link>
            <Link
              href="/products/search/top"
              className="py-2 border-b border-gray-100"
              onClick={() => setShowMobileMenu(false)}
            >
              Tops
            </Link>
            <Link
              href="/products/search/bottom"
              className="py-2 border-b border-gray-100"
              onClick={() => setShowMobileMenu(false)}
            >
              Bottoms
            </Link>
            <Link
              href="/products/search/set"
              className="py-2 border-b border-gray-100"
              onClick={() => setShowMobileMenu(false)}
            >
              Sets
            </Link>
            <Link
              href="/products/search/outerwear"
              className="py-2 border-b border-gray-100"
              onClick={() => setShowMobileMenu(false)}
            >
              Outerwear
            </Link>
            <Link
              href="/products/search/accessories"
              className="py-2 border-b border-gray-100"
              onClick={() => setShowMobileMenu(false)}
            >
              Accessories
            </Link>
            <Link
              href="/products/search/pattern"
              className="py-2 border-b border-gray-100"
              onClick={() => setShowMobileMenu(false)}
            >
              Patterns DIY
            </Link>
            <Link
              href="/custom-order"
              className="py-2 border-b border-gray-100"
              onClick={() => setShowMobileMenu(false)}
            >
              Custom Order
            </Link>
            {session?.user?.role === "admin" && (
              <div className="flex flex-col gap-2 text-red-600 font-semibold mt-2">
                <Link
                  href="/admin"
                  className="hover:underline"
                  onClick={() => setShowMobileMenu(false)}
                >
                  Admin
                </Link>
                <Link
                  href="/admin/orders"
                  className="hover:underline"
                  onClick={() => setShowMobileMenu(false)}
                >
                  Orders
                </Link>
              </div>
            )}
          </div>
        )}
      </div>
    </nav>
  );
}

=== FILE: ./src/components/ProductPurchaseSection.tsx ===

// === FILE: src/components/ProductPurchaseSection.tsx ===
"use client";

import { useState } from "react";
import AddToCartButton from "@/components/addToCartButton";

// Add `purchasingPaused` as an optional prop
export default function ProductAddToCartSection({
  product,
  purchasingPaused = false,
}: {
  product: any;
  purchasingPaused?: boolean;
}) {
  const [selectedSize, setSelectedSize] = useState("");

  // sizes only when not a pattern
  const hasSizes =
    Array.isArray(product.sizes) &&
    product.sizes.length > 0 &&
    !product.isPattern;

  // single place to decide if the action should be disabled
  const disabled = purchasingPaused || (hasSizes && !selectedSize);

  return (
    <>
      {/* Size picker only if needed */}
      {hasSizes && (
        <div className="mb-2">
          <label className="block font-medium mb-1">Select Size</label>
          <select
            className="border rounded w-full p-2"
            value={selectedSize}
            onChange={(e) => setSelectedSize(e.target.value)}
            required
            disabled={purchasingPaused}
          >
            <option value="">Choose a size...</option>
            {product.sizes.map((size: string) => (
              <option key={size} value={size}>
                {size}
              </option>
            ))}
          </select>
        </div>
      )}


      <AddToCartButton
        product={product}
        size={hasSizes ? selectedSize : undefined}
        disabled={disabled}
      />
    </>
  );
}

=== FILE: ./src/components/SessionDebug.tsx ===

// === FILE: src/components/SessionDebug.tsx ===
// This file defines a component to debug and display the current user session in a Next.js application

'use client';

import { useSession } from 'next-auth/react';

export default function SessionDebug() {
  const { data: session, status } = useSession();

  if (status === 'loading') return <p className="text-gray-500">Loading session</p>;
  if (!session) return <p className="text-red-500">Not logged in</p>;

  return (
    <div className="text-green-600">
      Logged in as: <strong>{session.user.name || session.user.email}</strong>
      <br />
      ID: <code>{session.user.id}</code>
      <br />
      Role: <code>{session.user.role}</code>
    </div>
  );
}

=== FILE: ./src/components/SessionWrapper.tsx ===

// === FILE: src/components/SessionWrapper.tsx ===
// This file defines a wrapper component for Next.js that provides session management using next-auth.
'use client';

import { SessionProvider } from 'next-auth/react';
import { ReactNode } from 'react';

export default function SessionWrapper({ children }: { children: ReactNode }) {
  return <SessionProvider>{children}</SessionProvider>;
}

=== FILE: ./src/components/SizeGuideModal.tsx ===

// === FILE: src/components/SizeGuideModal.tsx ===
// This component renders a modal for displaying size guides

'use client';

import { useEffect, useRef } from "react";

export default function SizeGuideModal({
  open,
  onClose,
  title = "Size Guide",
  tableData,
  subtitle,
}: {
  open: boolean;
  onClose: () => void;
  title?: string;
  subtitle?: string;
  tableData: string[][]; // expects [["Size","S","M"], ["Bust", ...], ...]
}) {
  const modalRef = useRef<HTMLDivElement>(null);

  // Close on ESC key
  useEffect(() => {
    if (!open) return;
    function onKeyDown(e: KeyboardEvent) {
      if (e.key === "Escape") onClose();
    }
    window.addEventListener("keydown", onKeyDown);
    return () => window.removeEventListener("keydown", onKeyDown);
  }, [open, onClose]);

  // Close when clicking outside modal
  function handleOverlayClick(e: React.MouseEvent) {
    if (e.target === modalRef.current) onClose();
  }

  if (!open) return null;

  return (
    <div
      ref={modalRef}
      className="fixed inset-0 z-50 flex items-center justify-center bg-black/40"
      onClick={handleOverlayClick}
      aria-modal="true"
      role="dialog"
      tabIndex={-1}
    >
      <div className="bg-white rounded-2xl shadow-2xl max-w-2xl w-full p-6 relative animate-fadeIn">
        {/* Close Button */}
        <button
          onClick={onClose}
          className="absolute top-3 right-4 text-2xl text-gray-800 hover:text-black font-bold focus:outline-none"
          aria-label="Close"
        >
          
        </button>

        {/* Title */}
        <h2 className="text-xl text-gray-800 font-bold mb-2 text-center">{title}</h2>
        {subtitle && (
          <p className="text-gray-800 mb-4 text-center">{subtitle}</p>
        )}

        {/* Responsive Table */}
        <div className="overflow-x-auto">
          <table className="w-full border border-gray-300 text-base bg-white rounded">
            <tbody>
              {tableData && tableData.length > 0 ? (
                tableData.map((row, i) => (
                  <tr key={i}>
                    {row.map((cell, j) => (
                      <td
                        key={j}
                        className={`border px-3 py-2 text-gray-800 ${
                          i === 0 ? "font-semibold text-gray-800 bg-gray-50" : ""
                        }`}
                      >
                        {cell}
                      </td>
                    ))}
                  </tr>
                ))
              ) : (
                <tr>
                  <td className="text-gray-800 italic px-4 py-3">
                    No size guide data.
                  </td>
                </tr>
              )}
            </tbody>
          </table>
        </div>
      </div>
    </div>
  );
}

=== FILE: ./src/components/sizeGuideRender.tsx ===

// === FILE: src/components/sizeGuideRender.tsx ===
// This component renders a button to open a size guide modal

'use client';

import { useState } from "react";
import SizeGuideModal from "./SizeGuideModal";

export default function ProductSizeGuideButton({
  sizeGuideName,
  tableData,
}: {
  sizeGuideName: string;
  tableData: string[][];
}) {
  const [open, setOpen] = useState(false);

  return (
    <>
      <button
        className="bg-gray-100 border border-gray-800 rounded px-4 py-2 text-black hover:bg-gray-200 transition w-fit font-medium"
        type="button"
        onClick={() => setOpen(true)}
      >
        Size Guide 
      </button>
      <SizeGuideModal
        open={open}
        onClose={() => setOpen(false)}
        title={sizeGuideName}
        tableData={tableData}
      />
    </>
  );
}

=== FILE: ./src/components/UploadButton.tsx ===

// === FILE: src/components/UploadButton.tsx ===
// This file defines a button component that allows users to upload files using Uploadthing's dropzone

"use client";

import { UploadDropzone } from "@/utils/uploadthing";
import { useState } from "react";

export default function UploadButton({
  onUploadComplete,
}: {
  onUploadComplete: (urls: string[]) => void;
}) {
  const [uploadedUrls, setUploadedUrls] = useState<string[]>([]);

  return (
    <div className="my-4">
      <UploadDropzone
        endpoint="productImage"
        onClientUploadComplete={(res) => {
          const urls = res.map((r) => r.url);
          setUploadedUrls(urls);
          onUploadComplete(urls);
        }}
        onUploadError={(err) => {
          alert(`Upload failed: ${err.message}`);
        }}
        appearance={{
          container:
            "border border-dashed border-gray-400 p-4 rounded-md w-full max-w-md mx-auto",
          uploadIcon: "w-10 h-10 text-gray-500 mx-auto",
          label: "text-center text-sm text-gray-600 mt-2",
          button:
            "mt-4 bg-black text-white px-4 py-2 rounded hover:bg-gray-800 cursor-pointer",
        }}
      />

      {uploadedUrls.length > 0 && (
        <ul className="mt-4 text-sm text-gray-700 space-y-1">
          {uploadedUrls.map((url, i) => (
            <li key={i}>
               Uploaded:{" "}
              <a
                href={url}
                target="_blank"
                rel="noreferrer"
                className="underline text-blue-600"
              >
                {url}
              </a>
            </li>
          ))}
        </ul>
      )}
    </div>
  );
}

=== FILE: ./src/lib/auth.ts ===

// === FILE: src/lib/auth.ts ===
// This file defines the authentication configuration for NextAuth.js using Prisma and CredentialsProvider.

import { NextAuthOptions } from "next-auth";
import CredentialsProvider from "next-auth/providers/credentials";
import { PrismaAdapter } from "@next-auth/prisma-adapter";
import { prisma } from "@/lib/prisma";
import bcrypt from "bcryptjs";

export const authOptions: NextAuthOptions = {
  adapter: PrismaAdapter(prisma),
  providers: [
    CredentialsProvider({
      name: "Credentials",
      credentials: {
        email: { label: "Email", type: "email" },
        password: { label: "Password", type: "password" },
      },
      async authorize(credentials) {
        const user = await prisma.user.findUnique({
          where: { email: credentials?.email },
        });

        if (user && credentials?.password) {
          const isValid = await bcrypt.compare(credentials.password, user.password);
          if (isValid) return user;
        }

        return null;
      },
    }),
  ],
  session: {
    strategy: "jwt",
  },
  callbacks: {
    async jwt({ token, user }) {
      if (user) {
        token.sub = user.id;
        token.role = user.role;
      }
      return token;
    },
    async session({ session, token }) {
      if (session.user) {
        if (token.sub) {
          session.user.id = token.sub;
        }
        if (token.role) {
          session.user.role = token.role as string;
        }
      }
      return session;
    },
  },
  secret: process.env.NEXTAUTH_SECRET,
};

=== FILE: ./src/lib/prisma.ts ===

// === FILE: src/lib/prisma.ts ===
// This file initializes the Prisma client for database access in a Next.js application.

import { PrismaClient } from '@prisma/client';

const globalForPrisma = globalThis as unknown as {
  prisma: PrismaClient | undefined;
};

export const prisma =
  globalForPrisma.prisma ?? new PrismaClient();

if (process.env.NODE_ENV !== 'production') {
  globalForPrisma.prisma = prisma;
}
=== FILE: ./src/lib/siteSettings.ts ===

// src/lib/siteSettings.ts
import { prisma } from "@/lib/prisma";

export async function getPurchasingPaused(): Promise<boolean> {
  const s = await prisma.siteSettings.findUnique({
    where: { id: 1 },
    select: { purchasingPaused: true },
  });
  return !!s?.purchasingPaused;
}

export async function setPurchasingPaused(val: boolean) {
  return prisma.siteSettings.update({
    where: { id: 1 },
    data: { purchasingPaused: val },
  });
}

=== FILE: ./src/middleware.ts ===

// === FILE: src/middleware.ts ===
// This file defines middleware for Next.js that checks if a user is an admin before allowing access
// and now also enforces that users must be logged in to access /checkout and /api/checkout.

import { getToken } from "next-auth/jwt";
import { NextResponse } from "next/server";
import type { NextRequest } from "next/server";

export async function middleware(req: NextRequest) {
  // Extract the session token from cookies.
  const token = await getToken({ req, secret: process.env.NEXTAUTH_SECRET });

  // ...existing logic above this...

  // --- route flags -----------------------------------------------------------
  // check for the path to see if it starts with /admin
  const pathname = req.nextUrl.pathname;
  const isAdminRoute = pathname.startsWith("/admin");

  // added: protect checkout UI + API
  const isCheckoutRoute =
    pathname.startsWith("/checkout") || pathname === "/api/checkout";

  // --- admin guard -----------------------------------------------------------
  if (isAdminRoute) {
    if (!token || !token?.role || token.role !== "admin") {
      // If the user is not an admin, redirect to the home page
      return NextResponse.redirect(new URL("/", req.url));
    }
  }

  // --- checkout guard --------------------------------------------------------
  // Require login for any checkout access (UI and API)
  if (isCheckoutRoute) {
    if (!token) {
      // added: redirect unauthenticated users to your login page
      // note: you have a custom login at /user/login
      // we preserve the intended destination using ?callbackUrl=
      const loginUrl = new URL("/user/login", req.url);
      loginUrl.searchParams.set("callbackUrl", req.nextUrl.href);
      return NextResponse.redirect(loginUrl);
    }
  }

  // default pass-through
  return NextResponse.next();
}

// Tell Next.js which routes should run through this middleware
// ...under matcher config...
export const config = {
  // added: protect /checkout and the /api/checkout endpoint in addition to /admin/*
  matcher: ["/admin/:path*", "/checkout/:path*", "/api/checkout"],
};

=== FILE: ./src/utils/CartContext.tsx ===

// === FILE: src/utils/CartContext.tsx ===
// This file defines a context for managing the shopping cart in a Next.js application.

"use client";

import {
  createContext,
  useContext,
  useEffect,
  useState,
  ReactNode,
} from "react";

export interface CartItem {
  productId: number;
  name: string;
  price: number; // in cents for convenience
  quantity: number;
  image?: string;
  size?: string;
}

interface CartContextType {
  cart: CartItem[];
  addToCart: (item: CartItem) => void;
  removeFromCart: (productId: number, size?: string) => void;
  clearCart: () => void;
  updateQuantity: (productId: number, quantity: number, size?: string) => void;
  getTotal: () => number;
}

const CartContext = createContext<CartContextType | undefined>(undefined);

const CART_KEY = "olipopper_cart";

export const CartProvider = ({ children }: { children: ReactNode }) => {
  const [cart, setCart] = useState<CartItem[]>([]);

  // Load cart from localStorage on first render
  useEffect(() => {
    const stored = localStorage.getItem(CART_KEY);
    if (stored) {
      try {
        setCart(JSON.parse(stored));
      } catch {
        localStorage.removeItem(CART_KEY);
      }
    }
  }, []);

  // Sync cart to localStorage whenever it changes
  useEffect(() => {
    localStorage.setItem(CART_KEY, JSON.stringify(cart));
  }, [cart]);

  const addToCart = (item: CartItem) => {
    setCart((prev) => {
      const existing = prev.find(
        (p) => p.productId === item.productId && p.size === item.size
      );
      if (existing) {
        return prev.map((p) =>
          p.productId === item.productId && p.size === item.size
            ? { ...p, quantity: p.quantity + item.quantity }
            : p
        );
      }
      return [...prev, item];
    });
  };

  const removeFromCart = (productId: number, size?: string) => {
    setCart((prev) =>
      prev.filter(
        (p) => !(p.productId === productId && (size ? p.size === size : true))
      )
    );
  };

  const clearCart = () => {
    setCart([]);
  };

  const updateQuantity = (
    productId: number,
    quantity: number,
    size?: string
  ) => {
    if (quantity <= 0) {
      removeFromCart(productId, size);
    } else {
      setCart((prev) =>
        prev.map((p) =>
          p.productId === productId && p.size === size ? { ...p, quantity } : p
        )
      );
    }
  };

  const getTotal = () => {
    return cart.reduce((sum, item) => sum + item.price * item.quantity, 0);
  };

  return (
    <CartContext.Provider
      value={{
        cart,
        addToCart,
        removeFromCart,
        clearCart,
        updateQuantity,
        getTotal,
      }}
    >
      {children}
    </CartContext.Provider>
  );
};

// Hook for consuming cart context
export const useCart = () => {
  const context = useContext(CartContext);
  if (!context) throw new Error("useCart must be used within a CartProvider");
  return context;
};

=== FILE: ./src/utils/uploadthing.tsx ===

// === FILE: src/utils/uploadthing.tsx ===
// This file defines a utility for generating an upload dropzone using Uploadthing in a Next.js application.

import { generateUploadDropzone } from "@uploadthing/react";
import { createUploadthing, type FileRouter } from "uploadthing/server";
import type { OurFileRouter } from "@/app/api/uploadthing/core";
import { getServerSession } from "next-auth"; // Import getServerSession from next-auth
import { prisma } from "@/lib/prisma"; // Import prisma client

const f = createUploadthing();

export const UploadDropzone = generateUploadDropzone<OurFileRouter>();

export const ourFileRouter = {
  patternPdf: f({
    pdf: { maxFileSize: "16MB", maxFileCount: 1 },
  })
    .middleware(async () => {
      const session = await getServerSession();
      if (!session?.user) throw new Error("Unauthorized");
      return { userId: session.user.id };
    })
    .onUploadComplete(async ({ file }) => {
      // Optionally save PDF to a media library
      await prisma.mediaLibrary.upsert({
        where: { url: file.ufsUrl },
        update: {},
        create: { url: file.ufsUrl },
      });
      return { url: file.ufsUrl };
    }),
  // ...rest
} satisfies FileRouter;
=== FILE: ./tailwind.config.js ===

// === FILE: tailwind.config.js ===
/** @type {import('tailwindcss').Config} */
module.exports = {
  content: [
    "./src/**/*.{js,ts,jsx,tsx}", // include all your src files for JIT mode
  ],
  theme: {
    extend: {
      fontFamily: {
        // Add your custom variable font
        sans: ['var(--font-montserrat)', 'sans-serif'],
      },
    },
  },
  plugins: [],
};

=== FILE: ./tsconfig.json ===

{
  "compilerOptions": {
    "target": "ES2017",
    "lib": ["dom", "dom.iterable", "esnext"],
    "allowJs": true,
    "skipLibCheck": true,
    "strict": true,
    "noEmit": true,
    "esModuleInterop": true,
    "module": "esnext",
    "moduleResolution": "bundler",
    "resolveJsonModule": true,
    "isolatedModules": true,
    "jsx": "preserve",
    "incremental": true,
    "typeRoots": ["./types", "./node_modules/@types"],
    "plugins": [
      {
        "name": "next"
      }
    ],
    "paths": {
      "@/*": ["./src/*"]
    }
  },
  "include": ["next-env.d.ts", "**/*.ts", "**/*.tsx", ".next/types/**/*.ts"],
  "exclude": ["node_modules"]
}

=== FILE: ./types/next-auth.d.ts ===

// === FILE: types/next-auth.d.ts ===
// This file extends the NextAuth types to include custom user and session properties.

import NextAuth from "next-auth";

declare module "next-auth" {
  interface Session {
    user: {
      id: string;
      role: string;
      name?: string | null;
      email?: string | null;
      image?: string | null;
    };
  }

  interface User {
    role: string;
  }
}
